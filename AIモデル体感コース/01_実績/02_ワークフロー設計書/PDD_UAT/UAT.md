# ユーザー受入テスト仕様書（UAT: User Acceptance Test）

## 1. 概要

| 項目 | 内容 |
|------|------|
| プロセス名 | 経費登録自動化プロセス |
| テスト環境 | 本番環境（テストデータ使用） |

## 2. テスト実行手順

### 2.1 事前準備
1. Python 3.10.11仮想環境（.venv）のアクティベート
2. テストデータ（data.xlsx）の準備
3. Edgeブラウザの起動確認
4. インターネット接続の確認

### 2.2 テスト実行
1. PowerShellを管理者権限で起動
2. プロジェクトディレクトリに移動
3. 以下コマンドを実行：
   ```
   .\.venv\Scripts\python.exe .\資料\経費登録.py
   ```

## 3. テストケース

| # | カテゴリ | 確認観点/期待結果 | 実行結果 |
|---|----------|-------------------|----------|
| **正常系テストケース** | | | |
| 1 | 正常系 | data.xlsxファイルが存在しない場合、URLから自動ダウンロードされること | ◯/△/× |
| 2 | | data.xlsxファイルが存在する場合、「ファイルが存在します」メッセージが表示されること | ◯/△/× |
| 3 | | Excelファイル（Sheet1）からヘッダー付きデータが正しく読み取られること | ◯/△/× |
| 4 | | WebDriverが正常に初期化され、Edgeブラウザが起動すること | ◯/△/× |
| 5 | | 経費登録サイト（https://www.expense-demo.com/）に正常にアクセスできること | ◯/△/× |
| 6 | | 「経費を登録する」メニューが正常にクリックされ、画面遷移すること | ◯/△/× |
| 7 | | 各行データについて「明細を登録する」ボタンが正常にクリックされること | ◯/△/× |
| 8 | | フォーム入力（タイトル、種別、金額、備考）が正確に実行されること | ◯/△/× |
| 9 | | 「登録する」ボタンクリック後、登録処理が正常に完了すること | ◯/△/× |
| 10 | | 登録完了画面から6桁の登録コードが正確に取得されること | ◯/△/× |
| 11 | | 取得したコードがExcelの「番号」列に正しく書き込まれること | ◯/△/× |
| 12 | | 「戻る」ボタンが正常にクリックされ、一覧画面に戻ること | ◯/△/× |
| 13 | | 全行処理完了後、処理結果の要約が正確に表示されること | ◯/△/× |
| 14 | | 処理完了通知で総行数、成功件数、失敗件数が正しく表示されること | ◯/△/× |
| 15 | | 処理完了通知で所要時間が表示されること | ◯/△/× |
| 16 | | ユーザーがOKボタンをクリック後、ブラウザが正常に終了すること | ◯/△/× |
| 17 | | 処理ログ（expense_automation.log）が適切に出力されること | ◯/△/× |
| **異常系テストケース** | | | |
| 18 | 異常系 | インターネット接続なしでdata.xlsxダウンロードが失敗した場合、適切なエラーメッセージが表示されること | ◯/△/× |
| 19 | | data.xlsxファイルが破損している場合、適切なエラーメッセージが表示され処理が停止すること | ◯/△/× |
| 20 | | Excelの「番号」列が存在しない場合、エラーログが出力されるが処理は継続すること | ◯/△/× |
| 21 | | WebDriver初期化に失敗した場合、適切なエラーメッセージが表示され処理が停止すること | ◯/△/× |
| 22 | | 経費登録サイトへのアクセスに失敗した場合、適切なエラーメッセージが表示されること | ◯/△/× |
| 23 | | 「経費を登録する」メニューが見つからない場合、適切なエラーメッセージが表示されること | ◯/△/× |
| 24 | | フォーム要素（タイトル、種別、金額、備考）が見つからない場合、エラーログが出力されるが次行に継続すること | ◯/△/× |
| 25 | | 種別のセレクトボックスで存在しない選択肢を指定した場合、エラーログが出力されるが処理は継続すること | ◯/△/× |
| 26 | | 登録ボタンクリック後にエラーが発生した場合、自動生成コード（AUTO_YYYYMMDD_HHMMSS）が使用されること | ◯/△/× |
| 27 | | 登録コードを取得できない場合、自動生成コードが使用され処理が継続すること | ◯/△/× |
| 28 | | Excelファイルが他のアプリケーションで開かれている場合、書き込みエラーログが出力されること | ◯/△/× |
| 29 | | 処理中にブラウザが予期せず終了した場合、適切なエラーハンドリングが行われること | ◯/△/× |
| 30 | | 処理対象とする行が0件の場合、適切なメッセージが表示され何もせず終了すること | ◯/△/× |

## 4. テストデータ

### 4.1 正常系テストデータ
| タイトル | 種別 | 金額 | 備考 | 番号（期待値） |
|----------|------|------|------|----------------|
| 交際費 | その他 | 5030 | 先月分 | 6桁数字 |
| 宿泊費 | 立替 | 7590 | ホテル代 | 6桁数字 |
| 交際費 | 仮払 | 10980 | 今月分 | 6桁数字 |

### 4.2 異常系テストデータ
| タイトル | 種別 | 金額 | 備考 | 期待動作 |
|----------|------|------|------|----------|
| テスト経費 | 存在しない種別 | 1000 | 異常テスト | エラーログ出力、AUTO_コード生成 |
| 空タイトル | | 2000 | 空タイトルテスト | エラーログ出力、処理継続 |
| 特殊文字経費 | 立替 | abc | 文字列金額 | エラーログ出力、処理継続 |

## 5. 合格基準

### 5.1 正常系
- 全ての正常系テストケース（1-17）で「◯」判定
- 処理成功率100%（エラーなく全行処理完了）
- Excelファイルの「番号」列に正しい登録コードが設定されている

### 5.2 異常系
- 全ての異常系テストケース（18-30）で期待されるエラーハンドリングが実行される
- システムダウンや予期しない停止が発生しない
- エラー発生時も適切なログ出力と処理継続が行われる

## 6. テスト実行記録

### 6.1 実行環境
| 項目 | 内容 |
|------|------|
| 実行日時 | YYYY年MM月DD日 HH:MM |
| 実行者 | （実行者名） |
| OS | Windows |
| ブラウザ | Microsoft Edge |
| Python | 3.10.11 |

### 6.2 実行結果サマリ
| カテゴリ | 実行件数 | 成功件数 | 失敗件数 | 成功率 |
|----------|----------|----------|----------|--------|
| 正常系 | 17 | - | - | -% |
| 異常系 | 13 | - | - | -% |
| **合計** | **30** | **-** | **-** | **-%** |

### 6.3 不具合・改善事項
| # | 内容 | 重要度 | 対応状況 |
|---|------|--------|----------|
| 1 | （発見された問題点） | 高/中/低 | 対応済/対応中/未対応 |
| 2 | （改善提案） | 高/中/低 | 対応済/対応中/未対応 |

## 7. 承認

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| テスト実行者 | | | |
| 業務責任者 | | | |
| システム責任者 | | | |

## 8. 備考

- テスト実行時のスクリーンショットや動画記録を推奨
- エラーが発生した場合は、ログファイル（expense_automation.log）の該当箇所を添付
- 本番環境での実行時は、テストデータを使用し本番データに影響を与えないこと
