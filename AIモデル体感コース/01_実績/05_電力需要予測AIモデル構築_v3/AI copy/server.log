[2025-10-21 10:06:53] Received /run-data payload: {'years': ['2022', '2023', '2024']}
[2025-10-21 10:06:53] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-21 10:06:53] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:07:04] Script finished: data\data.py returncode=0
[2025-10-21 10:07:04] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-21 10:07:04] STDERR:
2025-10-21 10:07:03,285 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-21 10:07:03,285 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-21 10:07:03,285 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-21 10:07:03,387 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-21 10:07:03,387 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-21 10:07:03,499 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-21 10:07:03,585 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-21 10:07:03,825 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-21 10:07:03,827 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-21 10:07:36] Received /run-train payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:07:36] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-21 10:07:36] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-21 10:07:36] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:07:38] Script finished: data\data.py returncode=0
[2025-10-21 10:07:38] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-21 10:07:38] STDERR:
2025-10-21 10:07:37,690 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-21 10:07:37,690 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-21 10:07:37,690 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-21 10:07:37,706 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-21 10:07:37,706 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-21 10:07:37,738 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-21 10:07:37,790 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-21 10:07:37,943 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-21 10:07:37,943 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-21 10:07:38] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_train.py
[2025-10-21 10:07:38] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:07:44] Script finished: train\LightGBM\LightGBM_train.py returncode=0
[2025-10-21 10:07:44] STDOUT:
=== LightGBM統一最適化設定適用完了 ===
AI_TARGET_YEARS=2022,2023,2024
=== LightGBM学習開始 ===
=== LightGBM学習統合処理 開始 ===
=== LightGBM電力需要予測モデル学習開始 ===
=== 学習データ読み込み 開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
メモリ最適化: float32データ型使用、メモリ使用量約50%削減
=== 学習データ読み込み 完了 (実行時間: 0.12秒) ===
=== データ標準化処理 開始 ===
データの標準化を実行中...
データの標準化が完了しました（float32最適化済み）
=== データ標準化処理 完了 (実行時間: 0.00秒) ===
学習率を 0.1 に設定しました
=== LightGBMモデル構築 開始 ===
LightGBMモデルを構築中...
LightGBMモデル構築完了 - パラメータ: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'num_leaves': 31, 'min_child_samples': 20, 'subsample': 1.0, 'colsample_bytree': 1.0, 'random_state': 42, 'verbose': -1}
=== LightGBMモデル構築 完了 (実行時間: 0.00秒) ===
=== LightGBMモデル学習 開始 ===
LightGBMモデルの学習を開始します...
LightGBMモデルの学習が完了しました
=== LightGBMモデル学習 完了 (実行時間: 0.08秒) ===
=== モデル・スケーラー保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
LightGBMモデルを train/LightGBM/LightGBM_model.sav に保存しました
スケーラーを train/LightGBM/LightGBM_model_scaler.pkl に保存しました
=== モデル・スケーラー保存 完了 (実行時間: 0.05秒) ===
=== モデル性能評価 開始 ===
=== モデル性能評価開始 ===
モデル性能評価を実行中...
テストスコア: 0.9193
テスト損失: 27429.516, テストMAE: 107.717
RMSE: 165.619 kW
R2スコア: 0.9193
MAE: 107.717 kW
=== モデル性能評価完了 ===
=== モデル性能評価 完了 (実行時間: 0.00秒) ===
=== 予測結果CSV保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
予測結果を train/LightGBM/LightGBM_Ypred.csv に保存しました（2631行）
=== 予測結果CSV保存 完了 (実行時間: 0.05秒) ===
=== 予測結果可視化 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
全期間グラフを train/LightGBM/LightGBM_Ypred.png に保存しました（16:9統一フォーマット）
1週間グラフを train/LightGBM/LightGBM_Ypred_7d.png に保存しました（16:9統一フォーマット）
=== 予測結果可視化 完了 (実行時間: 3.01秒) ===
=== LightGBM電力需要予測モデル学習完了 ===
=== LightGBM学習統合処理 完了 (実行時間: 3.57秒) ===
=== LightGBM学習完了 (実行時間: 3.58秒) ===
最終結果 - RMSE: 165.619 kW, R2スコア: 0.9193, MAE: 107.717 kW

[2025-10-21 10:07:57] Received /run-train payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:07:57] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-21 10:07:57] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-21 10:07:57] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:07:59] Script finished: data\data.py returncode=0
[2025-10-21 10:07:59] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-21 10:07:59] STDERR:
2025-10-21 10:07:58,678 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-21 10:07:58,678 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-21 10:07:58,678 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-21 10:07:58,694 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-21 10:07:58,694 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-21 10:07:58,726 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-21 10:07:58,788 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-21 10:07:58,965 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-21 10:07:58,966 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-21 10:07:59] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Pycaret\Pycaret_train.py
[2025-10-21 10:07:59] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:08:23] Script finished: train\Pycaret\Pycaret_train.py returncode=0
[2025-10-21 10:08:23] STDOUT:
PyCaret: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
PyCaret電力需要予測AIモデル学習システム
統一リファクタリング仕様 - PyCaretConfig対応版
============================================================
PyCaret PyCaret電力需要予測モデル学習 を開始します...
PyCaret データ読み込み を開始します...
学習データを読み込み中...
設定: 読み込んだ特徴量列を config.feature_columns に反映しました (4 列)
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
PyCaret データ読み込み が正常に完了しました
PyCaret PyCaret実験環境セットアップ を開始します...
PyCaretパラメータ {'silent': True} でエラー: setup() got an unexpected keyword argument 'silent'
PyCaretセットアップ成功: {'data':        MONTH  WEEK  HOUR       TEMP      KW
0        1.0   5.0   1.0   0.700000  3062.0
1        1.0   5.0   2.0   0.500000  2929.0
2        1.0   5.0   3.0   0.500000  2828.0
3        1.0   5.0   4.0   0.300000  2786.0
4        1.0   5.0   5.0  -0.200000  2828.0
...      ...   ...   ...        ...     ...
23666    9.0   4.0   3.0  27.400000  2827.0
23667    9.0   4.0   4.0  27.299999  2825.0
23668    9.0   4.0   5.0  26.900000  2908.0
23669    9.0   4.0   6.0  26.799999  3169.0
23670    9.0   4.0   7.0  28.100000  3716.0

[23671 rows x 5 columns], 'target': 'KW', 'session_id': 123, 'verbose': False}
PyCaret PyCaret実験環境セットアップ が正常に完了しました
PyCaret PyCaretモデル作成・学習 を開始します...
PyCaretモデル（lightgbm）を作成・学習中...
           MAE         MSE      RMSE      R2   RMSLE    MAPE
Fold                                                        
0     125.2144  31794.6683  178.3106  0.9405  0.0522  0.0382
1     120.9207  31976.6358  178.8201  0.9391  0.0540  0.0376
2     121.1220  31135.9836  176.4539  0.9391  0.0522  0.0372
3     125.2550  33426.7820  182.8299  0.9372  0.0543  0.0382
4     122.9873  32776.9684  181.0441  0.9338  0.0539  0.0379
5     130.9828  37629.9639  193.9844  0.9291  0.0572  0.0401
6     124.2342  35663.3741  188.8475  0.9321  0.0553  0.0384
7     125.3091  34730.6987  186.3617  0.9314  0.0548  0.0383
8     128.1099  35799.8223  189.2084  0.9314  0.0553  0.0391
9     121.5504  31386.3046  177.1618  0.9404  0.0530  0.0377
Mean  124.5686  33632.1202  183.3023  0.9354  0.0542  0.0383
Std     3.0336   2101.8860    5.6924  0.0041  0.0015  0.0008
メモリ最適化を実行しました
PyCaret PyCaretモデル作成・学習 が正常に完了しました
PyCaret PyCaretモデル保存 を開始します...
Transformation Pipeline and Model Successfully Saved
PyCaretモデルを train/Pycaret/Pycaret_model.pkl に保存しました
PyCaret PyCaretモデル保存 が正常に完了しました
PyCaret PyCaretモデル予測 を開始します...
予測が完了しました。予測値の形状: (2631,)
メモリ最適化を実行しました
PyCaret PyCaretモデル予測 が正常に完了しました
PyCaret モデル性能評価 を開始します...
PyCaretテストスコア: 0.919
最終結果 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
PyCaret モデル性能評価 が正常に完了しました
PyCaret 予測結果CSV保存 を開始します...
予測結果を train/Pycaret/Pycaret_Ypred.csv に保存しました
PyCaret 予測結果CSV保存 が正常に完了しました
PyCaret 予測結果グラフ作成 を開始します...
全期間グラフを train/Pycaret/Pycaret_Ypred.png に保存しました
1週間グラフを train/Pycaret/Pycaret_Ypred_7d.png に保存しました
メモリ最適化を実行しました
PyCaret 予測結果グラフ作成 が正常に完了しました
PyCaret PyCaret電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] PyCaret学習完了 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
============================================================

[2025-10-21 10:08:23] STDERR:

Processing:   0%|          | 0/4 [00:00<?, ?it/s]
Processing:  75%|███████▌  | 3/4 [00:06<00:02,  2.07s/it]
Processing: 100%|██████████| 4/4 [00:06<00:00,  1.44s/it]
                                                         

[2025-10-21 10:08:35] Received /run-train payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:08:35] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-21 10:08:35] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-21 10:08:35] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:08:37] Script finished: data\data.py returncode=0
[2025-10-21 10:08:37] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-21 10:08:37] STDERR:
2025-10-21 10:08:36,961 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-21 10:08:36,961 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-21 10:08:36,961 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-21 10:08:36,981 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-21 10:08:36,981 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-21 10:08:37,008 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-21 10:08:37,071 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-21 10:08:37,213 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-21 10:08:37,213 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-21 10:08:37] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\RandomForest\RandomForest_train.py
[2025-10-21 10:08:37] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:08:41] Script finished: train\RandomForest\RandomForest_train.py returncode=0
[2025-10-21 10:08:41] STDOUT:
RandomForest: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest電力需要予測AIモデル学習システム
統一リファクタリング仕様 - RandomForestConfig対応版
============================================================
RandomForest RandomForest電力需要予測モデル学習 を開始します...
RandomForest データ読み込み を開始します...
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
RandomForest データ読み込み が正常に完了しました
RandomForest データ標準化 を開始します...
メモリ最適化を実行しました
RandomForest データ標準化 が正常に完了しました
RandomForest RandomForestモデル作成 を開始します...
Random Forestモデルパラメータ: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'n_jobs': -1, 'random_state': 42}
RandomForest RandomForestモデル作成 が正常に完了しました
RandomForest RandomForestモデル学習 を開始します...
メモリ最適化を実行しました
RandomForest RandomForestモデル学習 が正常に完了しました
RandomForest モデル・スケーラー保存 を開始します...
Random Forestモデルを train/RandomForest/RandomForest_model.sav に保存しました
スケーラーを train/RandomForest/RandomForest_model_scaler.pkl に保存しました
RandomForest モデル・スケーラー保存 が正常に完了しました
RandomForest モデル性能評価 を開始します...
テストスコア: 0.908
最終結果 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
メモリ最適化を実行しました
RandomForest モデル性能評価 が正常に完了しました
RandomForest 予測結果CSV保存 を開始します...
予測結果を train/RandomForest/RandomForest_Ypred.csv に保存しました
RandomForest 予測結果CSV保存 が正常に完了しました
RandomForest 予測結果グラフ作成 を開始します...
全期間グラフを train/RandomForest/RandomForest_Ypred.png に保存しました
1週間グラフを train/RandomForest/RandomForest_Ypred_7d.png に保存しました
メモリ最適化を実行しました
RandomForest 予測結果グラフ作成 が正常に完了しました
RandomForest RandomForest電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] RandomForest学習完了 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
============================================================

[2025-10-21 10:08:56] Received /run-train payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:08:56] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-21 10:08:56] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-21 10:08:56] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:08:58] Script finished: data\data.py returncode=0
[2025-10-21 10:08:58] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-21 10:08:58] STDERR:
2025-10-21 10:08:57,790 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-21 10:08:57,790 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-21 10:08:57,790 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-21 10:08:57,821 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-21 10:08:57,821 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-21 10:08:57,838 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-21 10:08:57,900 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-21 10:08:58,070 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-21 10:08:58,070 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-21 10:08:58] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_train.py
[2025-10-21 10:08:58] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:11:19] Script finished: train\Keras\Keras_train.py returncode=0
[2025-10-21 10:11:19] STDOUT:
Keras: 統一パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
=== Keras学習開始 ===
環境変数指定による学習年: 2022,2023,2024
Keras電力需要予測モデルの学習を開始します...
=== 学習・テストデータ読み込み開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
=== 学習・テストデータ読み込み完了 ===
=== データ標準化開始 ===
データの標準化を実行中...
標準化完了: 特徴量数=4, 目的変数正規化適用
=== データ標準化完了 ===
=== Kerasモデル構築開始 ===
Kerasモデルを構築中... (入力次元: 4)
改善版v3アーキテクチャ: 128→128→64→32→1
過学習対策v3: Dropout=0.1, L2正則化=0.001, Batch=64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 hidden1 (Dense)             (None, 128)               640       
                                                                 
 dropout1 (Dropout)          (None, 128)               0         
                                                                 
 hidden2 (Dense)             (None, 128)               16512     
                                                                 
 dropout2 (Dropout)          (None, 128)               0         
                                                                 
 hidden3 (Dense)             (None, 64)                8256      
                                                                 
 hidden4 (Dense)             (None, 32)                2080      
                                                                 
 output (Dense)              (None, 1)                 33        
                                                                 
=================================================================
Total params: 27521 (107.50 KB)
Trainable params: 27521 (107.50 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Kerasモデル構築完了 (学習率: 0.001, Batch: 64)
=== Kerasモデル構築完了 ===
=== モデル学習開始 ===
モデル学習開始 (epochs: 500, batch_size: 64, patience: 20)
Epoch 1/500

  1/296 [..............................] - ETA: 9:59 - loss: 1.1270 - mean_absolute_error: 0.7487
 15/296 [>.............................] - ETA: 1s - loss: 0.8731 - mean_absolute_error: 0.6489  
 27/296 [=>............................] - ETA: 1s - loss: 0.7677 - mean_absolute_error: 0.5858
 47/296 [===>..........................] - ETA: 0s - loss: 0.6480 - mean_absolute_error: 0.5113
 61/296 [=====>........................] - ETA: 0s - loss: 0.5947 - mean_absolute_error: 0.4777
 76/296 [======>.......................] - ETA: 0s - loss: 0.5564 - mean_absolute_error: 0.4533
 88/296 [=======>......................] - ETA: 0s - loss: 0.5350 - mean_absolute_error: 0.4403
107/296 [=========>....................] - ETA: 0s - loss: 0.5045 - mean_absolute_error: 0.4202
130/296 [============>.................] - ETA: 0s - loss: 0.4789 - mean_absolute_error: 0.4040
148/296 [==============>...............] - ETA: 0s - loss: 0.4615 - mean_absolute_error: 0.3939
165/296 [===============>..............] - ETA: 0s - loss: 0.4489 - mean_absolute_error: 0.3857
178/296 [=================>............] - ETA: 0s - loss: 0.4396 - mean_absolute_error: 0.3801
193/296 [==================>...........] - ETA: 0s - loss: 0.4318 - mean_absolute_error: 0.3759
205/296 [===================>..........] - ETA: 0s - loss: 0.4249 - mean_absolute_error: 0.3719
226/296 [=====================>........] - ETA: 0s - loss: 0.4152 - mean_absolute_error: 0.3668
239/296 [=======================>......] - ETA: 0s - loss: 0.4089 - mean_absolute_error: 0.3628
249/296 [========================>.....] - ETA: 0s - loss: 0.4040 - mean_absolute_error: 0.3598
259/296 [=========================>....] - ETA: 0s - loss: 0.3998 - mean_absolute_error: 0.3574
271/296 [==========================>...] - ETA: 0s - loss: 0.3957 - mean_absolute_error: 0.3554
282/296 [===========================>..] - ETA: 0s - loss: 0.3916 - mean_absolute_error: 0.3531
296/296 [==============================] - 4s 6ms/step - loss: 0.3862 - mean_absolute_error: 0.3500 - val_loss: 0.2451 - val_mean_absolute_error: 0.2589
Epoch 2/500

  1/296 [..............................] - ETA: 0s - loss: 0.3809 - mean_absolute_error: 0.3472
 17/296 [>.............................] - ETA: 0s - loss: 0.2776 - mean_absolute_error: 0.2884
 33/296 [==>...........................] - ETA: 0s - loss: 0.2766 - mean_absolute_error: 0.2906
 43/296 [===>..........................] - ETA: 1s - loss: 0.2739 - mean_absolute_error: 0.2885
 56/296 [====>.........................] - ETA: 0s - loss: 0.2732 - mean_absolute_error: 0.2871
 69/296 [=====>........................] - ETA: 0s - loss: 0.2713 - mean_absolute_error: 0.2880
 88/296 [=======>......................] - ETA: 0s - loss: 0.2709 - mean_absolute_error: 0.2873
105/296 [=========>....................] - ETA: 0s - loss: 0.2715 - mean_absolute_error: 0.2896
118/296 [==========>...................] - ETA: 0s - loss: 0.2697 - mean_absolute_error: 0.2895
146/296 [=============>................] - ETA: 0s - loss: 0.2667 - mean_absolute_error: 0.2883
178/296 [=================>............] - ETA: 0s - loss: 0.2625 - mean_absolute_error: 0.2863
203/296 [===================>..........] - ETA: 0s - loss: 0.2581 - mean_absolute_error: 0.2837
234/296 [======================>.......] - ETA: 0s - loss: 0.2550 - mean_absolute_error: 0.2826
256/296 [========================>.....] - ETA: 0s - loss: 0.2518 - mean_absolute_error: 0.2803
275/296 [==========================>...] - ETA: 0s - loss: 0.2499 - mean_absolute_error: 0.2793
293/296 [============================>.] - ETA: 0s - loss: 0.2485 - mean_absolute_error: 0.2786
296/296 [==============================] - 1s 3ms/step - loss: 0.2479 - mean_absolute_error: 0.2783 - val_loss: 0.2020 - val_mean_absolute_error: 0.2486
Epoch 3/500

  1/296 [..............................] - ETA: 0s - loss: 0.2156 - mean_absolute_error: 0.2615
 35/296 [==>...........................] - ETA: 0s - loss: 0.2243 - mean_absolute_error: 0.2688
 61/296 [=====>........................] - ETA: 0s - loss: 0.2144 - mean_absolute_error: 0.2613
 93/296 [========>.....................] - ETA: 0s - loss: 0.2102 - mean_absolute_error: 0.2583
118/296 [==========>...................] - ETA: 0s - loss: 0.2092 - mean_absolute_error: 0.2574
145/296 [=============>................] - ETA: 0s - loss: 0.2072 - mean_absolute_error: 0.2565
171/296 [================>.............] - ETA: 0s - loss: 0.2058 - mean_absolute_error: 0.2565
190/296 [==================>...........] - ETA: 0s - loss: 0.2060 - mean_absolute_error: 0.2565
211/296 [====================>.........] - ETA: 0s - loss: 0.2056 - mean_absolute_error: 0.2565
229/296 [======================>.......] - ETA: 0s - loss: 0.2042 - mean_absolute_error: 0.2559
249/296 [========================>.....] - ETA: 0s - loss: 0.2032 - mean_absolute_error: 0.2554
269/296 [==========================>...] - ETA: 0s - loss: 0.2021 - mean_absolute_error: 0.2549
289/296 [============================>.] - ETA: 0s - loss: 0.2001 - mean_absolute_error: 0.2536
296/296 [==============================] - 1s 3ms/step - loss: 0.1997 - mean_absolute_error: 0.2536 - val_loss: 0.1524 - val_mean_absolute_error: 0.2145
Epoch 4/500

  1/296 [..............................] - ETA: 0s - loss: 0.1362 - mean_absolute_error: 0.1924
 31/296 [==>...........................] - ETA: 0s - loss: 0.1720 - mean_absolute_error: 0.2383
 61/296 [=====>........................] - ETA: 0s - loss: 0.1740 - mean_absolute_error: 0.2405
 91/296 [========>.....................] - ETA: 0s - loss: 0.1748 - mean_absolute_error: 0.2420
115/296 [==========>...................] - ETA: 0s - loss: 0.1746 - mean_absolute_error: 0.2417
146/296 [=============>................] - ETA: 0s - loss: 0.1746 - mean_absolute_error: 0.2427
170/296 [================>.............] - ETA: 0s - loss: 0.1755 - mean_absolute_error: 0.2445
189/296 [==================>...........] - ETA: 0s - loss: 0.1742 - mean_absolute_error: 0.2436
206/296 [===================>..........] - ETA: 0s - loss: 0.1735 - mean_absolute_error: 0.2439
226/296 [=====================>........] - ETA: 0s - loss: 0.1724 - mean_absolute_error: 0.2433
245/296 [=======================>......] - ETA: 0s - loss: 0.1723 - mean_absolute_error: 0.2435
265/296 [=========================>....] - ETA: 0s - loss: 0.1714 - mean_absolute_error: 0.2434
289/296 [============================>.] - ETA: 0s - loss: 0.1706 - mean_absolute_error: 0.2426
296/296 [==============================] - 1s 3ms/step - loss: 0.1705 - mean_absolute_error: 0.2426 - val_loss: 0.1227 - val_mean_absolute_error: 0.1895
Epoch 5/500

  1/296 [..............................] - ETA: 0s - loss: 0.1512 - mean_absolute_error: 0.2194
 24/296 [=>............................] - ETA: 0s - loss: 0.1586 - mean_absolute_error: 0.2358
 52/296 [====>.........................] - ETA: 0s - loss: 0.1548 - mean_absolute_error: 0.2367
 80/296 [=======>......................] - ETA: 0s - loss: 0.1545 - mean_absolute_error: 0.2346
107/296 [=========>....................] - ETA: 0s - loss: 0.1550 - mean_absolute_error: 0.2341
135/296 [============>.................] - ETA: 0s - loss: 0.1562 - mean_absolute_error: 0.2358
161/296 [===============>..............] - ETA: 0s - loss: 0.1546 - mean_absolute_error: 0.2344
185/296 [=================>............] - ETA: 0s - loss: 0.1550 - mean_absolute_error: 0.2347
206/296 [===================>..........] - ETA: 0s - loss: 0.1544 - mean_absolute_error: 0.2344
231/296 [======================>.......] - ETA: 0s - loss: 0.1532 - mean_absolute_error: 0.2342
259/296 [=========================>....] - ETA: 0s - loss: 0.1537 - mean_absolute_error: 0.2357
284/296 [===========================>..] - ETA: 0s - loss: 0.1536 - mean_absolute_error: 0.2359
296/296 [==============================] - 1s 2ms/step - loss: 0.1539 - mean_absolute_error: 0.2363 - val_loss: 0.1207 - val_mean_absolute_error: 0.2063
Epoch 6/500

  1/296 [..............................] - ETA: 0s - loss: 0.2236 - mean_absolute_error: 0.2837
 22/296 [=>............................] - ETA: 0s - loss: 0.1439 - mean_absolute_error: 0.2300
 42/296 [===>..........................] - ETA: 0s - loss: 0.1453 - mean_absolute_error: 0.2297
 64/296 [=====>........................] - ETA: 0s - loss: 0.1445 - mean_absolute_error: 0.2301
 84/296 [=======>......................] - ETA: 0s - loss: 0.1457 - mean_absolute_error: 0.2310
104/296 [=========>....................] - ETA: 0s - loss: 0.1458 - mean_absolute_error: 0.2315
125/296 [===========>..................] - ETA: 0s - loss: 0.1457 - mean_absolute_error: 0.2321
143/296 [=============>................] - ETA: 0s - loss: 0.1450 - mean_absolute_error: 0.2319
161/296 [===============>..............] - ETA: 0s - loss: 0.1438 - mean_absolute_error: 0.2311
179/296 [=================>............] - ETA: 0s - loss: 0.1438 - mean_absolute_error: 0.2310
196/296 [==================>...........] - ETA: 0s - loss: 0.1430 - mean_absolute_error: 0.2305
218/296 [=====================>........] - ETA: 0s - loss: 0.1425 - mean_absolute_error: 0.2303
241/296 [=======================>......] - ETA: 0s - loss: 0.1416 - mean_absolute_error: 0.2294
264/296 [=========================>....] - ETA: 0s - loss: 0.1410 - mean_absolute_error: 0.2293
294/296 [============================>.] - ETA: 0s - loss: 0.1409 - mean_absolute_error: 0.2290
296/296 [==============================] - 1s 3ms/step - loss: 0.1410 - mean_absolute_error: 0.2289 - val_loss: 0.1052 - val_mean_absolute_error: 0.1904
Epoch 7/500

  1/296 [..............................] - ETA: 1s - loss: 0.1501 - mean_absolute_error: 0.2212
 27/296 [=>............................] - ETA: 0s - loss: 0.1303 - mean_absolute_error: 0.2220
 54/296 [====>.........................] - ETA: 0s - loss: 0.1366 - mean_absolute_error: 0.2258
 81/296 [=======>......................] - ETA: 0s - loss: 0.1362 - mean_absolute_error: 0.2260
109/296 [==========>...................] - ETA: 0s - loss: 0.1343 - mean_absolute_error: 0.2253
136/296 [============>.................] - ETA: 0s - loss: 0.1344 - mean_absolute_error: 0.2267
164/296 [===============>..............] - ETA: 0s - loss: 0.1335 - mean_absolute_error: 0.2256
189/296 [==================>...........] - ETA: 0s - loss: 0.1332 - mean_absolute_error: 0.2253
215/296 [====================>.........] - ETA: 0s - loss: 0.1321 - mean_absolute_error: 0.2243
242/296 [=======================>......] - ETA: 0s - loss: 0.1311 - mean_absolute_error: 0.2234
267/296 [==========================>...] - ETA: 0s - loss: 0.1299 - mean_absolute_error: 0.2224
294/296 [============================>.] - ETA: 0s - loss: 0.1299 - mean_absolute_error: 0.2222
296/296 [==============================] - 1s 2ms/step - loss: 0.1298 - mean_absolute_error: 0.2222 - val_loss: 0.1015 - val_mean_absolute_error: 0.1959
Epoch 8/500

  1/296 [..............................] - ETA: 0s - loss: 0.1327 - mean_absolute_error: 0.2202
 29/296 [=>............................] - ETA: 0s - loss: 0.1305 - mean_absolute_error: 0.2256
 54/296 [====>.........................] - ETA: 0s - loss: 0.1314 - mean_absolute_error: 0.2291
 82/296 [=======>......................] - ETA: 0s - loss: 0.1300 - mean_absolute_error: 0.2274
109/296 [==========>...................] - ETA: 0s - loss: 0.1299 - mean_absolute_error: 0.2270
136/296 [============>.................] - ETA: 0s - loss: 0.1269 - mean_absolute_error: 0.2231
166/296 [===============>..............] - ETA: 0s - loss: 0.1267 - mean_absolute_error: 0.2224
198/296 [===================>..........] - ETA: 0s - loss: 0.1255 - mean_absolute_error: 0.2210
224/296 [=====================>........] - ETA: 0s - loss: 0.1247 - mean_absolute_error: 0.2201
250/296 [========================>.....] - ETA: 0s - loss: 0.1249 - mean_absolute_error: 0.2206
268/296 [==========================>...] - ETA: 0s - loss: 0.1245 - mean_absolute_error: 0.2206
288/296 [============================>.] - ETA: 0s - loss: 0.1246 - mean_absolute_error: 0.2209
296/296 [==============================] - 1s 3ms/step - loss: 0.1244 - mean_absolute_error: 0.2210 - val_loss: 0.0935 - val_mean_absolute_error: 0.1848
Epoch 9/500

  1/296 [..............................] - ETA: 0s - loss: 0.1427 - mean_absolute_error: 0.2397
 25/296 [=>............................] - ETA: 0s - loss: 0.1171 - mean_absolute_error: 0.2170
 39/296 [==>...........................] - ETA: 0s - loss: 0.1190 - mean_absolute_error: 0.2167
 55/296 [====>.........................] - ETA: 0s - loss: 0.1186 - mean_absolute_error: 0.2170
 76/296 [======>.......................] - ETA: 0s - loss: 0.1162 - mean_absolute_error: 0.2148
 97/296 [========>.....................] - ETA: 0s - loss: 0.1200 - mean_absolute_error: 0.2179
119/296 [===========>..................] - ETA: 0s - loss: 0.1228 - mean_absolute_error: 0.2206
141/296 [=============>................] - ETA: 0s - loss: 0.1224 - mean_absolute_error: 0.2204
166/296 [===============>..............] - ETA: 0s - loss: 0.1206 - mean_absolute_error: 0.2191
193/296 [==================>...........] - ETA: 0s - loss: 0.1197 - mean_absolute_error: 0.2183
220/296 [=====================>........] - ETA: 0s - loss: 0.1200 - mean_absolute_error: 0.2186
249/296 [========================>.....] - ETA: 0s - loss: 0.1211 - mean_absolute_error: 0.2201
278/296 [===========================>..] - ETA: 0s - loss: 0.1203 - mean_absolute_error: 0.2193
296/296 [==============================] - 1s 3ms/step - loss: 0.1199 - mean_absolute_error: 0.2188 - val_loss: 0.0911 - val_mean_absolute_error: 0.1875
Epoch 10/500

  1/296 [..............................] - ETA: 0s - loss: 0.1171 - mean_absolute_error: 0.2260
 23/296 [=>............................] - ETA: 0s - loss: 0.1031 - mean_absolute_error: 0.2071
 50/296 [====>.........................] - ETA: 0s - loss: 0.1099 - mean_absolute_error: 0.2096
 81/296 [=======>......................] - ETA: 0s - loss: 0.1113 - mean_absolute_error: 0.2141
103/296 [=========>....................] - ETA: 0s - loss: 0.1148 - mean_absolute_error: 0.2172
128/296 [===========>..................] - ETA: 0s - loss: 0.1163 - mean_absolute_error: 0.2185
154/296 [==============>...............] - ETA: 0s - loss: 0.1160 - mean_absolute_error: 0.2178
178/296 [=================>............] - ETA: 0s - loss: 0.1156 - mean_absolute_error: 0.2177
205/296 [===================>..........] - ETA: 0s - loss: 0.1162 - mean_absolute_error: 0.2187
230/296 [======================>.......] - ETA: 0s - loss: 0.1164 - mean_absolute_error: 0.2185
260/296 [=========================>....] - ETA: 0s - loss: 0.1171 - mean_absolute_error: 0.2191
283/296 [===========================>..] - ETA: 0s - loss: 0.1175 - mean_absolute_error: 0.2194
296/296 [==============================] - 1s 2ms/step - loss: 0.1179 - mean_absolute_error: 0.2199 - val_loss: 0.0959 - val_mean_absolute_error: 0.2005
Epoch 11/500

  1/296 [..............................] - ETA: 0s - loss: 0.1651 - mean_absolute_error: 0.2421
 28/296 [=>............................] - ETA: 0s - loss: 0.1107 - mean_absolute_error: 0.2169
 53/296 [====>.........................] - ETA: 0s - loss: 0.1141 - mean_absolute_error: 0.2185
 80/296 [=======>......................] - ETA: 0s - loss: 0.1156 - mean_absolute_error: 0.2202
108/296 [=========>....................] - ETA: 0s - loss: 0.1141 - mean_absolute_error: 0.2182
136/296 [============>.................] - ETA: 0s - loss: 0.1130 - mean_absolute_error: 0.2170
157/296 [==============>...............] - ETA: 0s - loss: 0.1135 - mean_absolute_error: 0.2168
178/296 [=================>............] - ETA: 0s - loss: 0.1130 - mean_absolute_error: 0.2160
198/296 [===================>..........] - ETA: 0s - loss: 0.1124 - mean_absolute_error: 0.2152
217/296 [====================>.........] - ETA: 0s - loss: 0.1125 - mean_absolute_error: 0.2150
237/296 [=======================>......] - ETA: 0s - loss: 0.1116 - mean_absolute_error: 0.2144
256/296 [========================>.....] - ETA: 0s - loss: 0.1115 - mean_absolute_error: 0.2141
276/296 [==========================>...] - ETA: 0s - loss: 0.1126 - mean_absolute_error: 0.2150
295/296 [============================>.] - ETA: 0s - loss: 0.1126 - mean_absolute_error: 0.2152
296/296 [==============================] - 1s 3ms/step - loss: 0.1126 - mean_absolute_error: 0.2152 - val_loss: 0.0861 - val_mean_absolute_error: 0.1848
Epoch 12/500

  1/296 [..............................] - ETA: 0s - loss: 0.0844 - mean_absolute_error: 0.1790
 26/296 [=>............................] - ETA: 0s - loss: 0.1137 - mean_absolute_error: 0.2130
 55/296 [====>.........................] - ETA: 0s - loss: 0.1099 - mean_absolute_error: 0.2104
 83/296 [=======>......................] - ETA: 0s - loss: 0.1071 - mean_absolute_error: 0.2096
111/296 [==========>...................] - ETA: 0s - loss: 0.1065 - mean_absolute_error: 0.2105
146/296 [=============>................] - ETA: 0s - loss: 0.1068 - mean_absolute_error: 0.2114
171/296 [================>.............] - ETA: 0s - loss: 0.1079 - mean_absolute_error: 0.2121
197/296 [==================>...........] - ETA: 0s - loss: 0.1084 - mean_absolute_error: 0.2126
222/296 [=====================>........] - ETA: 0s - loss: 0.1093 - mean_absolute_error: 0.2134
249/296 [========================>.....] - ETA: 0s - loss: 0.1099 - mean_absolute_error: 0.2137
276/296 [==========================>...] - ETA: 0s - loss: 0.1111 - mean_absolute_error: 0.2153
296/296 [==============================] - 1s 2ms/step - loss: 0.1109 - mean_absolute_error: 0.2150 - val_loss: 0.0886 - val_mean_absolute_error: 0.1921
Epoch 13/500

  1/296 [..............................] - ETA: 0s - loss: 0.1040 - mean_absolute_error: 0.1999
 31/296 [==>...........................] - ETA: 0s - loss: 0.1193 - mean_absolute_error: 0.2221
 63/296 [=====>........................] - ETA: 0s - loss: 0.1100 - mean_absolute_error: 0.2146
 89/296 [========>.....................] - ETA: 0s - loss: 0.1106 
[2025-10-21 10:11:19] STDERR:
2025-10-21 10:09:00.882760: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-10-21 10:09:15.009342: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.


[2025-10-21 10:11:40] Running tomorrow data.py and temp.py
[2025-10-21 10:11:40] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-21 10:11:40] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:11:41] Script finished: tomorrow\data.py returncode=0
[2025-10-21 10:11:41] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-21 00:00:00
開始日付: 2025-10-14 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.59秒) ===

[2025-10-21 10:11:41] STDERR:
2025-10-21 10:11:41,150 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-21 10:11:41,150 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-21 10:11:41,151 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-21 10:11:41,151 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-21 10:11:41,151 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-21 10:11:41,170 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,008行)
2025-10-21 10:11:41,170 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-21 10:11:41,170 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-21 10:11:41,414 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-21 10:11:41,452 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-21 10:11:41,452 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-21 10:11:41,452 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-21 10:11:41,452 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-21 10:11:41,475 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,032行)
2025-10-21 10:11:41,476 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-21 10:11:41,476 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-21 10:11:41,661 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-21 10:11:41,677 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-21 10:11:41,677 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-21 10:11:41,709 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-21 10:11:41,709 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-21 10:11:41,709 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-21 10:11:41,725 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-21 10:11:41,741 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.59秒)

[2025-10-21 10:11:41] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-21 10:11:41] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:11:43] Script finished: tomorrow\temp.py returncode=0
[2025-10-21 10:11:43] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.255秒
メモリ使用量変化: +4.4MB (開始: 59.9MB → 終了: 64.2MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-21 10:11:43] STDERR:
2025-10-21 10:11:42,641 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-21 10:11:42,641 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-21 10:11:42,641 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-21 10:11:42,641 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-21 10:11:43,880 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.239秒)
2025-10-21 10:11:43,895 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-21 10:11:43,895 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-21 10:11:43,895 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-21 10:11:43,895 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.000秒)
2025-10-21 10:11:43,895 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.255秒)

[2025-10-21 10:12:02] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:12:02] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-21 10:12:02] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:12:05] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-21 10:12:05] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.079秒
メモリ使用量: 115.8MB → 118.1MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.032秒
メモリ使用量: 118.1MB → 118.2MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.323秒
メモリ使用量: 118.2MB → 302.6MB (差分: +184.5MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.958
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.095秒
メモリ使用量: 302.6MB → 303.2MB (差分: +0.6MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.048秒
メモリ使用量: 303.2MB → 303.3MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 82.498 kW, R2スコア: 0.9577, MAE: 63.328 kW
実行完了: 精度指標計算
実行時間: 0.042秒
メモリ使用量: 303.3MB → 303.3MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.642秒
メモリ使用量: 303.3MB → 320.9MB (差分: +17.6MB)
ガベージコレクション: 4101個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.308秒
メモリ使用量: 115.8MB → 142.5MB (差分: +26.7MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 82.50 kW, R2スコア: 0.958
総実行時間: 1.308秒
============================================================

[2025-10-21 10:12:18] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:12:18] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-21 10:12:18] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:12:23] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-21 10:12:23] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.058秒
メモリ使用量: 200.0MB → 200.5MB (差分: +0.4MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.107秒
メモリ使用量: 200.5MB → 202.6MB (差分: +2.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.150秒
メモリ使用量: 202.6MB → 203.0MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.061秒
メモリ使用量: 203.0MB → 203.1MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 77.542 kW, R2スコア: 0.9627, MAE: 62.308 kW
実行完了: 精度指標計算
実行時間: 0.056秒
メモリ使用量: 203.1MB → 203.1MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.602秒
メモリ使用量: 203.1MB → 218.0MB (差分: +14.9MB)
ガベージコレクション: 4047個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.118秒
メモリ使用量: 200.0MB → 218.0MB (差分: +18.0MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 77.54 kW, R2スコア: 0.963
総実行時間: 1.118秒
============================================================

[2025-10-21 10:12:48] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:12:48] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-21 10:12:48] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:12:51] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-21 10:12:51] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.048秒
メモリ使用量: 115.8MB → 118.1MB (差分: +2.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.031秒
メモリ使用量: 118.1MB → 118.2MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.064秒
メモリ使用量: 118.2MB → 120.4MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9613
最終結果 - RMSE: 78.913 kW, R2: 0.9613, MAE: 62.159 kW
実行完了: 予測実行
実行時間: 0.031秒
メモリ使用量: 120.4MB → 120.6MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.047秒
メモリ使用量: 120.6MB → 120.8MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.665秒
メモリ使用量: 120.8MB → 138.3MB (差分: +17.6MB)
ガベージコレクション: 4220個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 0.916秒
メモリ使用量: 115.8MB → 138.4MB (差分: +22.6MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 78.91 kW, スコア: 0.97
総実行時間: 0.916秒
============================================================

[2025-10-21 10:13:02] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-21 10:13:02] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-21 10:13:02] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:13:14] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-21 10:13:14] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.6MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.11 GB
[データ読み込み開始] メモリ使用量: 12.11 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.11 GB
学習データの読み込みが完了しました (実行時間: 0.032秒)
[OK] load_training_data 実行時間: 0.111秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.11 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.11 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.015秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.105秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.11 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.11 GB
モデル読み込み完了 (実行時間: 0.454秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.11 GB
[予測処理開始] メモリ使用量: 12.11 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.11 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3589kW
[予測処理完了] メモリ使用量: 12.09 GB
予測処理完了 (実行時間: 0.710秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.726秒
[予測完了] メモリ使用量: 12.09 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 827.230 kW, R2スコア: -2.7816, MAE: 754.615 kW
[CSV保存開始] メモリ使用量: 12.09 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.09 GB
明日の予測結果の保存が完了しました (実行時間: 0.016秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.143秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.11 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.7816
[OK] tomorrow 実行時間: 3.541秒
メモリ使用量変化: +58.5MB (開始: 300.6MB → 終了: 359.1MB)
=== 処理完了 ===
(簡略表示) RMSE: 827.230 kW, R2スコア: -2.7816
実行時間: 3.541秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-21 10:13:14] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-21 10:14:32] Received /run-optimize-years payload: {'model': 'LightGBM'}
[2025-10-21 10:14:32] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_optimize_years.py
[2025-10-21 10:14:32] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 10:15:31] Script finished: train\LightGBM\LightGBM_optimize_years.py returncode=0
[2025-10-21 10:15:31] STDOUT:
電力需要予測AIモデル - LightGBM学習年組み合わせ最適化
================================================================================
データフォルダ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data
電力ファイル検索: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\juyo-*.csv
電力ファイル数: 10
気温ファイル数: 9
警告: 最新データ年2024、現在年2025まで不足
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
現在年: 2025
================================================================================
LightGBMモデル - 学習年組み合わせ最適化
================================================================================
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
検証組み合わせ数: 7

学習年組み合わせ検証を実行中...
[ 1/ 7] 2016,2017→2018: 成功 (RMSE: 152.6)
[ 2/ 7] 2017,2018→2019: 成功 (RMSE: 165.8)
[ 3/ 7] 2018,2019→2020: 成功 (RMSE: 195.4)
[ 4/ 7] 2019,2020→2021: 成功 (RMSE: 167.1)
[ 5/ 7] 2020,2021→2022: 成功 (RMSE: 171.4)
[ 6/ 7] 2021,2022→2023: 成功 (RMSE: 165.7)
[ 7/ 7] 2022,2023→2024: 成功 (RMSE: 165.6)
結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\2025-10-21_LightGBM_optimize_years.txt に保存しました

================================================================================
LightGBMモデル - 学習年組み合わせ最適化結果
================================================================================

総実行回数: 7
成功回数: 7

【上位5組み合わせ（RMSE基準）】

1位: 学習年 2016,2017 → テスト年 2018
   RMSE: 152.582 kW
   R²: 0.9120
   MAE: 100.423 kW
   実行時間: 15.7秒

2位: 学習年 2022,2023 → テスト年 2024
   RMSE: 165.619 kW
   R²: 0.9193
   MAE: 107.717 kW
   実行時間: 6.4秒

3位: 学習年 2021,2022 → テスト年 2023
   RMSE: 165.688 kW
   R²: 0.9166
   MAE: 126.659 kW
   実行時間: 6.6秒

4位: 学習年 2017,2018 → テスト年 2019
   RMSE: 165.760 kW
   R²: 0.9056
   MAE: 104.582 kW
   実行時間: 7.0秒

5位: 学習年 2019,2020 → テスト年 2021
   RMSE: 167.059 kW
   R²: 0.9069
   MAE: 109.749 kW
   実行時間: 6.4秒

【統計情報】
RMSE - 平均: 169.073, 標準偏差: 11.999
RMSE - 最小: 152.582, 最大: 195.377
R² - 平均: 0.9056, 標準偏差: 0.0123

【最優秀組み合わせ】
学習年: 2016,2017
テスト年: 2018
RMSE: 152.582 kW, R²: 0.9120, MAE: 100.423 kW

結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\2025-10-21_LightGBM_optimize_years.txt に保存しました
================================================================================
LightGBMモデル学習年組み合わせ最適化が完了しました
================================================================================

[2025-10-21 10:15:43] Received /run-optimize-years payload: {'model': 'Keras'}
[2025-10-21 10:15:43] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_optimize_years.py
[2025-10-21 10:15:43] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 11:32:34] Received /run-optimize-years payload: {'model': 'Keras'}
[2025-10-21 11:32:34] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_optimize_years.py
[2025-10-21 11:32:34] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 11:44:04] Script finished: train\Keras\Keras_optimize_years.py returncode=0
[2025-10-21 11:44:04] STDOUT:
電力需要予測AIモデル - Keras学習年組み合わせ最適化
================================================================================
データフォルダ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data
電力ファイル検索: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\juyo-*.csv
電力ファイル数: 10
気温ファイル数: 9
警告: 最新データ年2024、現在年2025まで不足
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
現在年: 2025
================================================================================
Kerasモデル - 学習年組み合わせ最適化
================================================================================
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
検証組み合わせ数: 7

学習年組み合わせ検証を実行中...
[ 1/ 7] 2016,2017→2018: 成功 (RMSE: 159.6)
[ 2/ 7] 2017,2018→2019: 成功 (RMSE: 162.6)
[ 3/ 7] 2018,2019→2020: 成功 (RMSE: 197.5)
[ 4/ 7] 2019,2020→2021: 成功 (RMSE: 187.0)
[ 5/ 7] 2020,2021→2022: 成功 (RMSE: 193.3)
[ 6/ 7] 2021,2022→2023: 成功 (RMSE: 162.1)
[ 7/ 7] 2022,2023→2024: 成功 (RMSE: 168.0)
結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\2025-10-21_Keras_optimize_years.txt に保存しました

================================================================================
Kerasモデル - 学習年組み合わせ最適化結果
================================================================================

総実行回数: 7
成功回数: 7

【上位5組み合わせ（RMSE基準）】

1位: 学習年 2016,2017 → テスト年 2018
   RMSE: 159.555 kW
   R²: 0.9038
   MAE: 109.687 kW
   実行時間: 82.2秒

2位: 学習年 2021,2022 → テスト年 2023
   RMSE: 162.137 kW
   R²: 0.9202
   MAE: 119.831 kW
   実行時間: 57.8秒

3位: 学習年 2017,2018 → テスト年 2019
   RMSE: 162.579 kW
   R²: 0.9092
   MAE: 105.880 kW
   実行時間: 144.3秒

4位: 学習年 2022,2023 → テスト年 2024
   RMSE: 167.960 kW
   R²: 0.9170
   MAE: 108.730 kW
   実行時間: 148.3秒

5位: 学習年 2019,2020 → テスト年 2021
   RMSE: 187.040 kW
   R²: 0.8833
   MAE: 125.162 kW
   実行時間: 72.0秒

【統計情報】
RMSE - 平均: 175.733, 標準偏差: 15.085
RMSE - 最小: 159.555, 最大: 197.547
R² - 平均: 0.8975, 標準偏差: 0.0183

【最優秀組み合わせ】
学習年: 2016,2017
テスト年: 2018
RMSE: 159.555 kW, R²: 0.9038, MAE: 109.687 kW

結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\2025-10-21_Keras_optimize_years.txt に保存しました
================================================================================
Kerasモデル学習年組み合わせ最適化が完了しました
================================================================================

[2025-10-21 11:44:30] Received /run-optimize-years payload: {'model': 'LightGBM'}
[2025-10-21 11:44:30] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_optimize_years.py
[2025-10-21 11:44:30] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 11:45:16] Script finished: train\LightGBM\LightGBM_optimize_years.py returncode=0
[2025-10-21 11:45:16] STDOUT:
電力需要予測AIモデル - LightGBM学習年組み合わせ最適化
================================================================================
データフォルダ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data
電力ファイル検索: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\juyo-*.csv
電力ファイル数: 10
気温ファイル数: 9
警告: 最新データ年2024、現在年2025まで不足
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
現在年: 2025
================================================================================
LightGBMモデル - 学習年組み合わせ最適化
================================================================================
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
検証組み合わせ数: 7

学習年組み合わせ検証を実行中...
[ 1/ 7] 2016,2017→2018: 成功 (RMSE: 152.6)
[ 2/ 7] 2017,2018→2019: 成功 (RMSE: 165.8)
[ 3/ 7] 2018,2019→2020: 成功 (RMSE: 195.4)
[ 4/ 7] 2019,2020→2021: 成功 (RMSE: 167.1)
[ 5/ 7] 2020,2021→2022: 成功 (RMSE: 171.4)
[ 6/ 7] 2021,2022→2023: 成功 (RMSE: 165.7)
[ 7/ 7] 2022,2023→2024: 成功 (RMSE: 165.6)
結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\2025-10-21_LightGBM_optimize_years.txt に保存しました

================================================================================
LightGBMモデル - 学習年組み合わせ最適化結果
================================================================================

総実行回数: 7
成功回数: 7

【上位5組み合わせ（RMSE基準）】

1位: 学習年 2016,2017 → テスト年 2018
   RMSE: 152.582 kW
   R²: 0.9120
   MAE: 100.423 kW
   実行時間: 6.6秒

2位: 学習年 2022,2023 → テスト年 2024
   RMSE: 165.619 kW
   R²: 0.9193
   MAE: 107.717 kW
   実行時間: 6.4秒

3位: 学習年 2021,2022 → テスト年 2023
   RMSE: 165.688 kW
   R²: 0.9166
   MAE: 126.659 kW
   実行時間: 6.2秒

4位: 学習年 2017,2018 → テスト年 2019
   RMSE: 165.760 kW
   R²: 0.9056
   MAE: 104.582 kW
   実行時間: 6.4秒

5位: 学習年 2019,2020 → テスト年 2021
   RMSE: 167.059 kW
   R²: 0.9069
   MAE: 109.749 kW
   実行時間: 6.5秒

【統計情報】
RMSE - 平均: 169.073, 標準偏差: 11.999
RMSE - 最小: 152.582, 最大: 195.377
R² - 平均: 0.9056, 標準偏差: 0.0123

【最優秀組み合わせ】
学習年: 2016,2017
テスト年: 2018
RMSE: 152.582 kW, R²: 0.9120, MAE: 100.423 kW

結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\2025-10-21_LightGBM_optimize_years.txt に保存しました
================================================================================
LightGBMモデル学習年組み合わせ最適化が完了しました
================================================================================

[2025-10-21 11:46:10] Received /run-optimize-years payload: {'model': 'PyCaret'}
[2025-10-21 11:46:10] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Pycaret\Pycaret_optimize_years.py
[2025-10-21 11:46:10] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 11:48:27] Script finished: train\Pycaret\Pycaret_optimize_years.py returncode=0
[2025-10-21 11:48:27] STDOUT:
電力需要予測AIモデル - Pycaret学習年組み合わせ最適化
================================================================================
データフォルダ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data
電力ファイル検索: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\juyo-*.csv
電力ファイル数: 10
気温ファイル数: 9
警告: 最新データ年2024、現在年2025まで不足
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
現在年: 2025
================================================================================
Pycaretモデル - 学習年組み合わせ最適化
================================================================================
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
検証組み合わせ数: 7

学習年組み合わせ検証を実行中...
[ 1/ 7] 2016,2017→2018: 成功 (RMSE: 157.4)
[ 2/ 7] 2017,2018→2019: 成功 (RMSE: 168.7)
[ 3/ 7] 2018,2019→2020: 成功 (RMSE: 195.7)
[ 4/ 7] 2019,2020→2021: 成功 (RMSE: 167.1)
[ 5/ 7] 2020,2021→2022: 成功 (RMSE: 170.7)
[ 6/ 7] 2021,2022→2023: 成功 (RMSE: 165.2)
[ 7/ 7] 2022,2023→2024: 成功 (RMSE: 166.0)
結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Pycaret\2025-10-21_Pycaret_optimize_years.txt に保存しました

================================================================================
Pycaretモデル - 学習年組み合わせ最適化結果
================================================================================

総実行回数: 7
成功回数: 7

【上位5組み合わせ（RMSE基準）】

1位: 学習年 2016,2017 → テスト年 2018
   RMSE: 157.387 kW
   R²: 0.9064
   MAE: 104.213 kW
   実行時間: 27.8秒

2位: 学習年 2021,2022 → テスト年 2023
   RMSE: 165.224 kW
   R²: 0.9171
   MAE: 125.844 kW
   実行時間: 17.3秒

3位: 学習年 2022,2023 → テスト年 2024
   RMSE: 165.970 kW
   R²: 0.9190
   MAE: 108.722 kW
   実行時間: 18.5秒

4位: 学習年 2019,2020 → テスト年 2021
   RMSE: 167.120 kW
   R²: 0.9068
   MAE: 108.727 kW
   実行時間: 17.9秒

5位: 学習年 2017,2018 → テスト年 2019
   RMSE: 168.739 kW
   R²: 0.9022
   MAE: 107.472 kW
   実行時間: 17.2秒

【統計情報】
RMSE - 平均: 170.122, 標準偏差: 11.141
RMSE - 最小: 157.387, 最大: 195.698
R² - 平均: 0.9044, 標準偏差: 0.0122

【最優秀組み合わせ】
学習年: 2016,2017
テスト年: 2018
RMSE: 157.387 kW, R²: 0.9064, MAE: 104.213 kW

結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Pycaret\2025-10-21_Pycaret_optimize_years.txt に保存しました
================================================================================
Pycaretモデル学習年組み合わせ最適化が完了しました
================================================================================

[2025-10-21 11:48:51] Received /run-optimize-years payload: {'model': 'RandomForest'}
[2025-10-21 11:48:51] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\RandomForest\RandomForest_optimize_years.py
[2025-10-21 11:48:51] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-21 11:49:34] Script finished: train\RandomForest\RandomForest_optimize_years.py returncode=0
[2025-10-21 11:49:34] STDOUT:
電力需要予測AIモデル - RandomForest学習年組み合わせ最適化
================================================================================
データフォルダ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data
電力ファイル検索: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\juyo-*.csv
電力ファイル数: 10
気温ファイル数: 9
警告: 最新データ年2024、現在年2025まで不足
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
現在年: 2025
================================================================================
RandomForestモデル - 学習年組み合わせ最適化
================================================================================
利用可能年: 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024
検証組み合わせ数: 7

学習年組み合わせ検証を実行中...
[ 1/ 7] 2016,2017→2018: 成功 (RMSE: 171.3)
[ 2/ 7] 2017,2018→2019: 成功 (RMSE: 177.6)
[ 3/ 7] 2018,2019→2020: 成功 (RMSE: 211.5)
[ 4/ 7] 2019,2020→2021: 成功 (RMSE: 171.3)
[ 5/ 7] 2020,2021→2022: 成功 (RMSE: 184.3)
[ 6/ 7] 2021,2022→2023: 成功 (RMSE: 177.6)
[ 7/ 7] 2022,2023→2024: 成功 (RMSE: 176.4)
結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\RandomForest\2025-10-21_RandomForest_optimize_years.txt に保存しました

================================================================================
RandomForestモデル - 学習年組み合わせ最適化結果
================================================================================

総実行回数: 7
成功回数: 7

【上位5組み合わせ（RMSE基準）】

1位: 学習年 2016,2017 → テスト年 2018
   RMSE: 171.262 kW
   R²: 0.8892
   MAE: 112.026 kW
   実行時間: 5.8秒

2位: 学習年 2019,2020 → テスト年 2021
   RMSE: 171.327 kW
   R²: 0.9021
   MAE: 111.046 kW
   実行時間: 6.3秒

3位: 学習年 2022,2023 → テスト年 2024
   RMSE: 176.404 kW
   R²: 0.9085
   MAE: 116.328 kW
   実行時間: 6.4秒

4位: 学習年 2017,2018 → テスト年 2019
   RMSE: 177.557 kW
   R²: 0.8917
   MAE: 112.825 kW
   実行時間: 6.3秒

5位: 学習年 2021,2022 → テスト年 2023
   RMSE: 177.600 kW
   R²: 0.9042
   MAE: 135.099 kW
   実行時間: 6.0秒

【統計情報】
RMSE - 平均: 181.431, 標準偏差: 12.960
RMSE - 最小: 171.262, 最大: 211.545
R² - 平均: 0.8912, 標準偏差: 0.0156

【最優秀組み合わせ】
学習年: 2016,2017
テスト年: 2018
RMSE: 171.262 kW, R²: 0.8892, MAE: 112.026 kW

結果を c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\RandomForest\2025-10-21_RandomForest_optimize_years.txt に保存しました
================================================================================
RandomForestモデル学習年組み合わせ最適化が完了しました
================================================================================

[2025-10-22 07:44:33] Running tomorrow data.py and temp.py
[2025-10-22 07:44:33] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-22 07:44:33] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-22 07:44:37] Script finished: tomorrow\data.py returncode=0
[2025-10-22 07:44:37] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-22 00:00:00
開始日付: 2025-10-15 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.66秒) ===

[2025-10-22 07:44:37] STDERR:
2025-10-22 07:44:36,783 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-22 07:44:36,783 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-22 07:44:36,783 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-22 07:44:36,783 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-22 07:44:36,783 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-22 07:44:36,831 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,032行)
2025-10-22 07:44:36,831 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-22 07:44:36,831 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-22 07:44:37,126 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-22 07:44:37,155 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-22 07:44:37,155 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-22 07:44:37,155 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-22 07:44:37,155 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-22 07:44:37,169 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,056行)
2025-10-22 07:44:37,169 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-22 07:44:37,169 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-22 07:44:37,360 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-22 07:44:37,376 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-22 07:44:37,391 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-22 07:44:37,407 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-22 07:44:37,423 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-22 07:44:37,423 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-22 07:44:37,426 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-22 07:44:37,440 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.66秒)

[2025-10-22 07:44:37] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-22 07:44:37] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-22 07:44:39] Script finished: tomorrow\temp.py returncode=0
[2025-10-22 07:44:39] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.408秒
メモリ使用量変化: +4.4MB (開始: 59.9MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-22 07:44:39] STDERR:
2025-10-22 07:44:38,353 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-22 07:44:38,353 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-22 07:44:38,353 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-22 07:44:38,353 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-22 07:44:39,729 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.377秒)
2025-10-22 07:44:39,745 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-22 07:44:39,745 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-22 07:44:39,761 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-22 07:44:39,761 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.016秒)
2025-10-22 07:44:39,761 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.408秒)

[2025-10-22 07:44:56] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-22 07:44:56] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-22 07:44:56] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-22 07:45:09] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-22 07:45:09] STDOUT:
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.127秒
メモリ使用量: 115.9MB → 117.6MB (差分: +1.7MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.032秒
メモリ使用量: 117.6MB → 118.3MB (差分: +0.7MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 1.516秒
メモリ使用量: 118.3MB → 306.0MB (差分: +187.8MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.938
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.139秒
メモリ使用量: 306.0MB → 306.7MB (差分: +0.6MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.035秒
メモリ使用量: 306.7MB → 306.8MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 98.120 kW, R2スコア: 0.9381, MAE: 72.299 kW
実行完了: 精度指標計算
実行時間: 0.031秒
メモリ使用量: 306.8MB → 306.8MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 1.940秒
メモリ使用量: 306.8MB → 324.1MB (差分: +17.4MB)
ガベージコレクション: 4325個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 3.869秒
メモリ使用量: 115.9MB → 142.3MB (差分: +26.4MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 98.12 kW, R2スコア: 0.938
総実行時間: 3.869秒
============================================================

[2025-10-22 07:45:19] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-22 07:45:19] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-22 07:45:19] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-22 07:45:33] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-22 07:45:33] STDOUT:
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.078秒
メモリ使用量: 200.2MB → 200.8MB (差分: +0.6MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.204秒
メモリ使用量: 200.8MB → 202.8MB (差分: +1.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.221秒
メモリ使用量: 202.8MB → 203.2MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.086秒
メモリ使用量: 203.2MB → 203.3MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 92.067 kW, R2スコア: 0.9455, MAE: 69.631 kW
実行完了: 精度指標計算
実行時間: 0.072秒
メモリ使用量: 203.3MB → 203.3MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.904秒
メモリ使用量: 203.3MB → 218.0MB (差分: +14.7MB)
ガベージコレクション: 4047個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.942秒
メモリ使用量: 200.2MB → 218.0MB (差分: +17.8MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 92.07 kW, R2スコア: 0.945
総実行時間: 1.942秒
============================================================

[2025-10-22 07:45:51] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-22 07:45:51] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-22 07:45:51] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-22 07:45:53] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-22 07:45:53] STDOUT:
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.031秒
メモリ使用量: 115.5MB → 117.8MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.043秒
メモリ使用量: 117.8MB → 117.8MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.085秒
メモリ使用量: 117.8MB → 120.2MB (差分: +2.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9443
最終結果 - RMSE: 93.073 kW, R2: 0.9443, MAE: 69.174 kW
実行完了: 予測実行
実行時間: 0.032秒
メモリ使用量: 120.2MB → 120.4MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.031秒
メモリ使用量: 120.4MB → 120.5MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.646秒
メモリ使用量: 120.5MB → 140.6MB (差分: +20.0MB)
ガベージコレクション: 4220個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 0.888秒
メモリ使用量: 115.5MB → 138.4MB (差分: +22.9MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 93.07 kW, スコア: 0.97
総実行時間: 0.888秒
============================================================

[2025-10-22 07:46:06] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-22 07:46:06] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-22 07:46:06] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-22 07:46:28] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-22 07:46:28] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 301.2MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 11.17 GB
[データ読み込み開始] メモリ使用量: 11.17 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 11.17 GB
学習データの読み込みが完了しました (実行時間: 0.063秒)
[OK] load_training_data 実行時間: 0.174秒
[テスト・明日データ読み込み開始] メモリ使用量: 11.17 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 11.17 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.110秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 11.17 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 11.19 GB
モデル読み込み完了 (実行時間: 0.496秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 11.19 GB
[予測処理開始] メモリ使用量: 11.19 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 11.19 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3831kW
[予測処理完了] メモリ使用量: 11.43 GB
予測処理完了 (実行時間: 1.386秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 1.417秒
[予測完了] メモリ使用量: 11.43 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.023秒)
最終結果 - RMSE: 784.705 kW, R2スコア: -2.4028, MAE: 749.876 kW
[CSV保存開始] メモリ使用量: 11.43 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 11.43 GB
明日の予測結果の保存が完了しました (実行時間: 0.018秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.200秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 11.35 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.4028
[OK] tomorrow 実行時間: 4.423秒
メモリ使用量変化: +58.5MB (開始: 301.2MB → 終了: 359.7MB)
=== 処理完了 ===
(簡略表示) RMSE: 784.705 kW, R2スコア: -2.4028
実行時間: 4.423秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-22 07:46:28] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-23 07:19:08] Running tomorrow data.py and temp.py
[2025-10-23 07:19:08] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-23 07:19:08] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:19:12] Script finished: tomorrow\data.py returncode=0
[2025-10-23 07:19:12] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-23 00:00:00
開始日付: 2025-10-16 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.67秒) ===

[2025-10-23 07:19:12] STDERR:
2025-10-23 07:19:11,984 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-23 07:19:11,984 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-23 07:19:11,984 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 07:19:11,984 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 07:19:11,984 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 07:19:12,016 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,056行)
2025-10-23 07:19:12,016 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 07:19:12,016 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 07:19:12,266 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 07:19:12,312 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 07:19:12,312 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 07:19:12,312 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 07:19:12,312 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 07:19:12,333 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-23 07:19:12,333 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 07:19:12,333 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 07:19:12,547 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 07:19:12,579 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 07:19:12,579 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-23 07:19:12,629 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-23 07:19:12,629 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-23 07:19:12,629 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-23 07:19:12,642 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-23 07:19:12,657 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.67秒)

[2025-10-23 07:19:12] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-23 07:19:12] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:19:14] Script finished: tomorrow\temp.py returncode=0
[2025-10-23 07:19:14] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.236秒
メモリ使用量変化: +4.5MB (開始: 59.8MB → 終了: 64.2MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-23 07:19:14] STDERR:
2025-10-23 07:19:13,652 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.8MB
2025-10-23 07:19:13,652 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-23 07:19:13,652 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-23 07:19:13,652 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-23 07:19:14,842 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.190秒)
2025-10-23 07:19:14,863 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-23 07:19:14,863 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-23 07:19:14,883 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-23 07:19:14,887 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.024秒)
2025-10-23 07:19:14,887 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.236秒)

[2025-10-23 07:19:57] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-23 07:19:57] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-23 07:19:57] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:20:26] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-23 07:20:26] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 301.7MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 11.89 GB
[データ読み込み開始] メモリ使用量: 11.89 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 11.89 GB
学習データの読み込みが完了しました (実行時間: 0.073秒)
[OK] load_training_data 実行時間: 0.168秒
[テスト・明日データ読み込み開始] メモリ使用量: 11.89 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 11.89 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.032秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.128秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 11.89 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 11.90 GB
モデル読み込み完了 (実行時間: 0.395秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 11.90 GB
[予測処理開始] メモリ使用量: 11.90 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 11.90 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 11.91 GB
予測処理完了 (実行時間: 0.775秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.775秒
[予測完了] メモリ使用量: 11.91 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 791.918 kW, R2スコア: -2.4657, MAE: 740.641 kW
[CSV保存開始] メモリ使用量: 11.91 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 11.91 GB
明日の予測結果の保存が完了しました (実行時間: 0.000秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.094秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 11.98 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.4657
[OK] tomorrow 実行時間: 3.679秒
メモリ使用量変化: +59.2MB (開始: 301.7MB → 終了: 360.9MB)
=== 処理完了 ===
(簡略表示) RMSE: 791.918 kW, R2スコア: -2.4657
実行時間: 3.679秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-23 07:20:26] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-23 07:20:35] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-23 07:20:35] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-23 07:20:35] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:20:38] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-23 07:20:38] STDOUT:
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.047秒
メモリ使用量: 115.7MB → 118.8MB (差分: +3.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.032秒
メモリ使用量: 118.8MB → 118.8MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.193秒
メモリ使用量: 118.8MB → 120.6MB (差分: +1.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9343
最終結果 - RMSE: 104.377 kW, R2: 0.9343, MAE: 77.914 kW
実行完了: 予測実行
実行時間: 0.035秒
メモリ使用量: 120.6MB → 120.8MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.042秒
メモリ使用量: 120.8MB → 121.0MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.674秒
メモリ使用量: 121.0MB → 140.2MB (差分: +19.2MB)
ガベージコレクション: 4220個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 1.073秒
メモリ使用量: 115.7MB → 140.2MB (差分: +24.4MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 104.38 kW, スコア: 0.96
総実行時間: 1.073秒
============================================================

[2025-10-23 07:20:52] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-23 07:20:52] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-23 07:20:52] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:21:05] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-23 07:21:05] STDOUT:
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.080秒
メモリ使用量: 200.0MB → 200.4MB (差分: +0.4MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.110秒
メモリ使用量: 200.4MB → 202.7MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.189秒
メモリ使用量: 202.7MB → 203.2MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.048秒
メモリ使用量: 203.2MB → 203.3MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 107.078 kW, R2スコア: 0.9309, MAE: 79.988 kW
実行完了: 精度指標計算
実行時間: 0.079秒
メモリ使用量: 203.3MB → 203.3MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.716秒
メモリ使用量: 203.3MB → 219.9MB (差分: +16.6MB)
ガベージコレクション: 4047個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.526秒
メモリ使用量: 200.0MB → 219.9MB (差分: +19.9MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 107.08 kW, R2スコア: 0.931
総実行時間: 1.526秒
============================================================

[2025-10-23 07:21:14] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-23 07:21:14] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-23 07:21:14] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:21:17] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-23 07:21:17] STDOUT:
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.032秒
メモリ使用量: 115.8MB → 118.7MB (差分: +2.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.031秒
メモリ使用量: 118.7MB → 118.7MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.420秒
メモリ使用量: 118.7MB → 302.5MB (差分: +183.8MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.943
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.069秒
メモリ使用量: 302.5MB → 303.2MB (差分: +0.7MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.031秒
メモリ使用量: 303.2MB → 303.3MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 97.597 kW, R2スコア: 0.9426, MAE: 73.964 kW
実行完了: 精度指標計算
実行時間: 0.028秒
メモリ使用量: 303.3MB → 303.3MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.762秒
メモリ使用量: 303.3MB → 322.8MB (差分: +19.5MB)
ガベージコレクション: 4101個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.414秒
メモリ使用量: 115.8MB → 144.2MB (差分: +28.4MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 97.60 kW, R2スコア: 0.943
総実行時間: 1.414秒
============================================================

[2025-10-23 07:44:19] Received /run-data payload: {'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-23 07:44:19] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 07:44:19] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:44:29] Script finished: data\data.py returncode=0
[2025-10-23 07:44:29] STDOUT:
対象年に制限を適用します: ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']
電力データファイル: 9件
気温データファイル: 9件
共通年: 9年分 (2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024)
電力データ読み込み中: data\juyo-2016.csv
電力データ読み込み中: data\juyo-2017.csv
電力データ読み込み中: data\juyo-2018.csv
電力データ読み込み中: data\juyo-2019.csv
電力データ読み込み中: data\juyo-2020.csv
電力データ読み込み中: data\juyo-2021.csv
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 76728行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2016.csv
気温データ読み込み中: data\temperature-2017.csv
気温データ読み込み中: data\temperature-2018.csv
気温データ読み込み中: data\temperature-2019.csv
気温データ読み込み中: data\temperature-2020.csv
気温データ読み込み中: data\temperature-2021.csv
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 78912行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 76723行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (76723, 4)
ターゲットデータ作成完了: (76723, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 69050行, テストデータ: 7673行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 07:44:29] STDERR:
2025-10-23 07:44:28,235 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 07:44:28,235 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 07:44:28,235 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 07:44:28,525 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 07:44:28,525 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 07:44:28,826 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 07:44:28,990 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 07:44:29,491 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 07:44:29,491 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 07:44:34] Received /run-train payload: {'model': 'LightGBM', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-23 07:44:34] Running data pipeline before training with AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
[2025-10-23 07:44:34] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 07:44:34] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:44:36] Script finished: data\data.py returncode=0
[2025-10-23 07:44:36] STDOUT:
対象年に制限を適用します: ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']
電力データファイル: 9件
気温データファイル: 9件
共通年: 9年分 (2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024)
電力データ読み込み中: data\juyo-2016.csv
電力データ読み込み中: data\juyo-2017.csv
電力データ読み込み中: data\juyo-2018.csv
電力データ読み込み中: data\juyo-2019.csv
電力データ読み込み中: data\juyo-2020.csv
電力データ読み込み中: data\juyo-2021.csv
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 76728行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2016.csv
気温データ読み込み中: data\temperature-2017.csv
気温データ読み込み中: data\temperature-2018.csv
気温データ読み込み中: data\temperature-2019.csv
気温データ読み込み中: data\temperature-2020.csv
気温データ読み込み中: data\temperature-2021.csv
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 78912行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 76723行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (76723, 4)
ターゲットデータ作成完了: (76723, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 69050行, テストデータ: 7673行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 07:44:36] STDERR:
2025-10-23 07:44:36,121 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 07:44:36,122 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 07:44:36,122 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 07:44:36,179 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 07:44:36,179 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 07:44:36,255 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 07:44:36,391 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 07:44:36,855 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 07:44:36,855 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 07:44:36] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_train.py
[2025-10-23 07:44:36] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:44:43] Script finished: train\LightGBM\LightGBM_train.py returncode=0
[2025-10-23 07:44:43] STDOUT:
=== LightGBM統一最適化設定適用完了 ===
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
=== LightGBM学習開始 ===
=== LightGBM学習統合処理 開始 ===
=== LightGBM電力需要予測モデル学習開始 ===
=== 学習データ読み込み 開始 ===
学習データを読み込み中...
学習データ形状: X_train=(69050, 4), y_train=(69050,)
テストデータ形状: X_test=(7673, 4), y_test=(7673,)
メモリ最適化: float32データ型使用、メモリ使用量約50%削減
=== 学習データ読み込み 完了 (実行時間: 0.08秒) ===
=== データ標準化処理 開始 ===
データの標準化を実行中...
データの標準化が完了しました（float32最適化済み）
=== データ標準化処理 完了 (実行時間: 0.02秒) ===
学習率を 0.1 に設定しました
=== LightGBMモデル構築 開始 ===
LightGBMモデルを構築中...
LightGBMモデル構築完了 - パラメータ: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'num_leaves': 31, 'min_child_samples': 20, 'subsample': 1.0, 'colsample_bytree': 1.0, 'random_state': 42, 'verbose': -1}
=== LightGBMモデル構築 完了 (実行時間: 0.00秒) ===
=== LightGBMモデル学習 開始 ===
LightGBMモデルの学習を開始します...
LightGBMモデルの学習が完了しました
=== LightGBMモデル学習 完了 (実行時間: 0.17秒) ===
=== モデル・スケーラー保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
LightGBMモデルを train/LightGBM/LightGBM_model.sav に保存しました
スケーラーを train/LightGBM/LightGBM_model_scaler.pkl に保存しました
=== モデル・スケーラー保存 完了 (実行時間: 0.04秒) ===
=== モデル性能評価 開始 ===
=== モデル性能評価開始 ===
モデル性能評価を実行中...
テストスコア: 0.9339
テスト損失: 34091.145, テストMAE: 136.749
RMSE: 184.638 kW
R2スコア: 0.9339
MAE: 136.749 kW
=== モデル性能評価完了 ===
=== モデル性能評価 完了 (実行時間: 0.02秒) ===
=== 予測結果CSV保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
予測結果を train/LightGBM/LightGBM_Ypred.csv に保存しました（7673行）
=== 予測結果CSV保存 完了 (実行時間: 0.05秒) ===
=== 予測結果可視化 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
全期間グラフを train/LightGBM/LightGBM_Ypred.png に保存しました（16:9統一フォーマット）
1週間グラフを train/LightGBM/LightGBM_Ypred_7d.png に保存しました（16:9統一フォーマット）
=== 予測結果可視化 完了 (実行時間: 3.00秒) ===
=== LightGBM電力需要予測モデル学習完了 ===
=== LightGBM学習統合処理 完了 (実行時間: 3.60秒) ===
=== LightGBM学習完了 (実行時間: 3.63秒) ===
最終結果 - RMSE: 184.638 kW, R2スコア: 0.9339, MAE: 136.749 kW

[2025-10-23 07:47:02] Received /run-data payload: {'years': ['2024']}
[2025-10-23 07:47:02] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 07:47:02] Child env subset: {'AI_TARGET_YEARS': '2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:47:03] Script finished: data\data.py returncode=0
[2025-10-23 07:47:03] STDOUT:
対象年に制限を適用します: ['2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2024']
電力データファイル: 1件
気温データファイル: 1件
共通年: 1年分 (2024)
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 8784行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 8784行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 8782行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (8782, 4)
ターゲットデータ作成完了: (8782, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 7903行, テストデータ: 879行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 07:47:03] STDERR:
2025-10-23 07:47:03,602 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 07:47:03,602 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 07:47:03,602 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 07:47:03,602 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 07:47:03,602 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 07:47:03,617 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 07:47:03,633 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 07:47:03,698 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 07:47:03,698 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 07:47:06] Received /run-train payload: {'model': 'Keras', 'years': ['2024']}
[2025-10-23 07:47:06] Running data pipeline before training with AI_TARGET_YEARS=2024
[2025-10-23 07:47:06] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 07:47:06] Child env subset: {'AI_TARGET_YEARS': '2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:47:08] Script finished: data\data.py returncode=0
[2025-10-23 07:47:08] STDOUT:
対象年に制限を適用します: ['2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2024']
電力データファイル: 1件
気温データファイル: 1件
共通年: 1年分 (2024)
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 8784行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 8784行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 8782行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (8782, 4)
ターゲットデータ作成完了: (8782, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 7903行, テストデータ: 879行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 07:47:08] STDERR:
2025-10-23 07:47:08,006 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 07:47:08,006 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 07:47:08,006 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 07:47:08,006 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 07:47:08,006 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 07:47:08,029 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 07:47:08,039 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 07:47:08,111 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 07:47:08,111 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 07:47:08] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_train.py
[2025-10-23 07:47:08] Child env subset: {'AI_TARGET_YEARS': '2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:47:43] Script finished: train\Keras\Keras_train.py returncode=0
[2025-10-23 07:47:43] STDOUT:
Keras: 統一パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2024
=== Keras学習開始 ===
環境変数指定による学習年: 2024
Keras電力需要予測モデルの学習を開始します...
=== 学習・テストデータ読み込み開始 ===
学習データを読み込み中...
学習データ形状: X_train=(7903, 4), y_train=(7903,)
テストデータ形状: X_test=(879, 4), y_test=(879,)
=== 学習・テストデータ読み込み完了 ===
=== データ標準化開始 ===
データの標準化を実行中...
標準化完了: 特徴量数=4, 目的変数正規化適用
=== データ標準化完了 ===
=== Kerasモデル構築開始 ===
Kerasモデルを構築中... (入力次元: 4)
改善版v3アーキテクチャ: 128→128→64→32→1
過学習対策v3: Dropout=0.1, L2正則化=0.001, Batch=64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 hidden1 (Dense)             (None, 128)               640       
                                                                 
 dropout1 (Dropout)          (None, 128)               0         
                                                                 
 hidden2 (Dense)             (None, 128)               16512     
                                                                 
 dropout2 (Dropout)          (None, 128)               0         
                                                                 
 hidden3 (Dense)             (None, 64)                8256      
                                                                 
 hidden4 (Dense)             (None, 32)                2080      
                                                                 
 output (Dense)              (None, 1)                 33        
                                                                 
=================================================================
Total params: 27521 (107.50 KB)
Trainable params: 27521 (107.50 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Kerasモデル構築完了 (学習率: 0.001, Batch: 64)
=== Kerasモデル構築完了 ===
=== モデル学習開始 ===
モデル学習開始 (epochs: 500, batch_size: 64, patience: 20)
Epoch 1/500

 1/99 [..............................] - ETA: 2:33 - loss: 1.3872 - mean_absolute_error: 0.8767
25/99 [======>.......................] - ETA: 0s - loss: 0.7989 - mean_absolute_error: 0.6003  
49/99 [=============>................] - ETA: 0s - loss: 0.6104 - mean_absolute_error: 0.4772
74/99 [=====================>........] - ETA: 0s - loss: 0.5339 - mean_absolute_error: 0.4315
98/99 [============================>.] - ETA: 0s - loss: 0.4897 - mean_absolute_error: 0.4048
99/99 [==============================] - 2s 5ms/step - loss: 0.4887 - mean_absolute_error: 0.4040 - val_loss: 0.4136 - val_mean_absolute_error: 0.3981
Epoch 2/500

 1/99 [..............................] - ETA: 1s - loss: 0.3019 - mean_absolute_error: 0.2969
22/99 [=====>........................] - ETA: 0s - loss: 0.3462 - mean_absolute_error: 0.3219
43/99 [============>.................] - ETA: 0s - loss: 0.3395 - mean_absolute_error: 0.3182
67/99 [===================>..........] - ETA: 0s - loss: 0.3356 - mean_absolute_error: 0.3192
90/99 [==========================>...] - ETA: 0s - loss: 0.3301 - mean_absolute_error: 0.3159
99/99 [==============================] - 0s 3ms/step - loss: 0.3292 - mean_absolute_error: 0.3167 - val_loss: 0.3037 - val_mean_absolute_error: 0.3039
Epoch 3/500

 1/99 [..............................] - ETA: 1s - loss: 0.3447 - mean_absolute_error: 0.3278
26/99 [======>.......................] - ETA: 0s - loss: 0.2974 - mean_absolute_error: 0.2988
47/99 [=============>................] - ETA: 0s - loss: 0.2916 - mean_absolute_error: 0.2983
71/99 [====================>.........] - ETA: 0s - loss: 0.2906 - mean_absolute_error: 0.2989
99/99 [==============================] - ETA: 0s - loss: 0.2856 - mean_absolute_error: 0.2960
99/99 [==============================] - 0s 3ms/step - loss: 0.2856 - mean_absolute_error: 0.2960 - val_loss: 0.2809 - val_mean_absolute_error: 0.2981
Epoch 4/500

 1/99 [..............................] - ETA: 0s - loss: 0.2988 - mean_absolute_error: 0.3384
23/99 [=====>........................] - ETA: 0s - loss: 0.2712 - mean_absolute_error: 0.2928
44/99 [============>.................] - ETA: 0s - loss: 0.2684 - mean_absolute_error: 0.2920
68/99 [===================>..........] - ETA: 0s - loss: 0.2656 - mean_absolute_error: 0.2909
87/99 [=========================>....] - ETA: 0s - loss: 0.2600 - mean_absolute_error: 0.2868
99/99 [==============================] - 0s 3ms/step - loss: 0.2581 - mean_absolute_error: 0.2857 - val_loss: 0.3073 - val_mean_absolute_error: 0.3678
Epoch 5/500

 1/99 [..............................] - ETA: 0s - loss: 0.2236 - mean_absolute_error: 0.2720
23/99 [=====>........................] - ETA: 0s - loss: 0.2382 - mean_absolute_error: 0.2789
45/99 [============>.................] - ETA: 0s - loss: 0.2345 - mean_absolute_error: 0.2720
70/99 [====================>.........] - ETA: 0s - loss: 0.2371 - mean_absolute_error: 0.2748
99/99 [==============================] - 0s 3ms/step - loss: 0.2308 - mean_absolute_error: 0.2704 - val_loss: 0.2631 - val_mean_absolute_error: 0.3241
Epoch 6/500

 1/99 [..............................] - ETA: 0s - loss: 0.1950 - mean_absolute_error: 0.2463
19/99 [====>.........................] - ETA: 0s - loss: 0.2186 - mean_absolute_error: 0.2636
43/99 [============>.................] - ETA: 0s - loss: 0.2143 - mean_absolute_error: 0.2614
68/99 [===================>..........] - ETA: 0s - loss: 0.2128 - mean_absolute_error: 0.2597
94/99 [===========================>..] - ETA: 0s - loss: 0.2107 - mean_absolute_error: 0.2593
99/99 [==============================] - 0s 3ms/step - loss: 0.2111 - mean_absolute_error: 0.2598 - val_loss: 0.2617 - val_mean_absolute_error: 0.3332
Epoch 7/500

 1/99 [..............................] - ETA: 0s - loss: 0.2037 - mean_absolute_error: 0.2386
24/99 [======>.......................] - ETA: 0s - loss: 0.2030 - mean_absolute_error: 0.2585
44/99 [============>.................] - ETA: 0s - loss: 0.2010 - mean_absolute_error: 0.2550
69/99 [===================>..........] - ETA: 0s - loss: 0.1957 - mean_absolute_error: 0.2495
94/99 [===========================>..] - ETA: 0s - loss: 0.1922 - mean_absolute_error: 0.2464
99/99 [==============================] - 0s 3ms/step - loss: 0.1918 - mean_absolute_error: 0.2467 - val_loss: 0.2491 - val_mean_absolute_error: 0.3289
Epoch 8/500

 1/99 [..............................] - ETA: 0s - loss: 0.2159 - mean_absolute_error: 0.2648
17/99 [====>.........................] - ETA: 0s - loss: 0.1889 - mean_absolute_error: 0.2456
33/99 [=========>....................] - ETA: 0s - loss: 0.1828 - mean_absolute_error: 0.2422
56/99 [===============>..............] - ETA: 0s - loss: 0.1840 - mean_absolute_error: 0.2448
76/99 [======================>.......] - ETA: 0s - loss: 0.1864 - mean_absolute_error: 0.2484
99/99 [==============================] - 0s 4ms/step - loss: 0.1823 - mean_absolute_error: 0.2440 - val_loss: 0.2574 - val_mean_absolute_error: 0.3304
Epoch 9/500

 1/99 [..............................] - ETA: 1s - loss: 0.1404 - mean_absolute_error: 0.2088
26/99 [======>.......................] - ETA: 0s - loss: 0.1704 - mean_absolute_error: 0.2356
54/99 [===============>..............] - ETA: 0s - loss: 0.1698 - mean_absolute_error: 0.2360
83/99 [========================>.....] - ETA: 0s - loss: 0.1714 - mean_absolute_error: 0.2372
99/99 [==============================] - 0s 3ms/step - loss: 0.1715 - mean_absolute_error: 0.2382 - val_loss: 0.3122 - val_mean_absolute_error: 0.4234
Epoch 10/500

 1/99 [..............................] - ETA: 0s - loss: 0.2033 - mean_absolute_error: 0.2930
15/99 [===>..........................] - ETA: 0s - loss: 0.1655 - mean_absolute_error: 0.2395
39/99 [==========>...................] - ETA: 0s - loss: 0.1650 - mean_absolute_error: 0.2351
67/99 [===================>..........] - ETA: 0s - loss: 0.1630 - mean_absolute_error: 0.2333
89/99 [=========================>....] - ETA: 0s - loss: 0.1615 - mean_absolute_error: 0.2326
99/99 [==============================] - 0s 4ms/step - loss: 0.1605 - mean_absolute_error: 0.2318 - val_loss: 0.2540 - val_mean_absolute_error: 0.3584
Epoch 11/500

 1/99 [..............................] - ETA: 0s - loss: 0.1351 - mean_absolute_error: 0.2180
15/99 [===>..........................] - ETA: 0s - loss: 0.1594 - mean_absolute_error: 0.2337
41/99 [===========>..................] - ETA: 0s - loss: 0.1524 - mean_absolute_error: 0.2284
65/99 [==================>...........] - ETA: 0s - loss: 0.1533 - mean_absolute_error: 0.2307
90/99 [==========================>...] - ETA: 0s - loss: 0.1545 - mean_absolute_error: 0.2308
99/99 [==============================] - 0s 3ms/step - loss: 0.1556 - mean_absolute_error: 0.2314 - val_loss: 0.2928 - val_mean_absolute_error: 0.3962
Epoch 12/500

 1/99 [..............................] - ETA: 0s - loss: 0.1469 - mean_absolute_error: 0.2176
22/99 [=====>........................] - ETA: 0s - loss: 0.1411 - mean_absolute_error: 0.2148
48/99 [=============>................] - ETA: 0s - loss: 0.1426 - mean_absolute_error: 0.2187
76/99 [======================>.......] - ETA: 0s - loss: 0.1450 - mean_absolute_error: 0.2209
95/99 [===========================>..] - ETA: 0s - loss: 0.1457 - mean_absolute_error: 0.2223
99/99 [==============================] - 0s 3ms/step - loss: 0.1467 - mean_absolute_error: 0.2236 - val_loss: 0.2757 - val_mean_absolute_error: 0.3863
Epoch 13/500

 1/99 [..............................] - ETA: 0s - loss: 0.1580 - mean_absolute_error: 0.2469
25/99 [======>.......................] - ETA: 0s - loss: 0.1460 - mean_absolute_error: 0.2274
54/99 [===============>..............] - ETA: 0s - loss: 0.1425 - mean_absolute_error: 0.2239
74/99 [=====================>........] - ETA: 0s - loss: 0.1443 - mean_absolute_error: 0.2249
95/99 [===========================>..] - ETA: 0s - loss: 0.1419 - mean_absolute_error: 0.2230
99/99 [==============================] - 0s 3ms/step - loss: 0.1411 - mean_absolute_error: 0.2223 - val_loss: 0.2650 - val_mean_absolute_error: 0.3838
Epoch 14/500

 1/99 [..............................] - ETA: 0s - loss: 0.1389 - mean_absolute_error: 0.2320
13/99 [==>...........................] - ETA: 0s - loss: 0.1284 - mean_absolute_error: 0.2106
23/99 [=====>........................] - ETA: 0s - loss: 0.1258 - mean_absolute_error: 0.2082
36/99 [=========>....................] - ETA: 0s - loss: 0.1286 - mean_absolute_error: 0.2102
42/99 [===========>..................] - ETA: 0s - loss: 0.1281 - mean_absolute_error: 0.2105
55/99 [===============>..............] - ETA: 0s - loss: 0.1300 - mean_absolute_error: 0.2113
68/99 [===================>..........] - ETA: 0s - loss: 0.1301 - mean_absolute_error: 0.2124
80/99 [=======================>......] - ETA: 0s - loss: 0.1328 - mean_absolute_error: 0.2159
96/99 [============================>.] - ETA: 0s - loss: 0.1346 - mean_absolute_error: 0.2187
99/99 [==============================] - 1s 6ms/step - loss: 0.1353 - mean_absolute_error: 0.2190 - val_loss: 0.3201 - val_mean_absolute_error: 0.4489
Epoch 15/500

 1/99 [..............................] - ETA: 0s - loss: 0.1038 - mean_absolute_error: 0.1931
16/99 [===>..........................] - ETA: 0s - loss: 0.1343 - mean_absolute_error: 0.2227
26/99 [======>.......................] - ETA: 0s - loss: 0.1324 - mean_absolute_error: 0.2220
33/99 [=========>....................] - ETA: 0s - loss: 0.1327 - mean_absolute_error: 0.2220
41/99 [===========>..................] - ETA: 0s - loss: 0.1307 - mean_absolute_error: 0.2194
54/99 [===============>..............] - ETA: 0s - loss: 0.1292 - mean_absolute_error: 0.2171
67/99 [===================>..........] - ETA: 0s - loss: 0.1289 - mean_absolute_error: 0.2164
80/99 [=======================>......] - ETA: 0s - loss: 0.1289 - mean_absolute_error: 0.2160
88/99 [=========================>....] - ETA: 0s - loss: 0.1296 - mean_absolute_error: 0.2175
99/99 [==============================] - 1s 7ms/step - loss: 0.1299 - mean_absolute_error: 0.2171 - val_loss: 0.2504 - val_mean_absolute_error: 0.3709
Epoch 16/500

 1/99 [..............................] - ETA: 0s - loss: 0.0963 - mean_absolute_error: 0.1809
 8/99 [=>............................] - ETA: 0s - loss: 0.1278 - mean_absolute_error: 0.2240
23/99 [=====>........................] - ETA: 0s - loss: 0.1202 - mean_absolute_error: 0.2111
31/99 [========>.....................] - ETA: 0s - loss: 0.1184 - mean_absolute_error: 0.2085
45/99 [============>.................] - ETA: 0s - loss: 0.1197 - mean_absolute_error: 0.2096
52/99 [==============>...............] - ETA: 0s - loss: 0.1208 - mean_absolute_error: 0.2103
65/99 [==================>...........] - ETA: 0s - loss: 0.1231 - mean_absolute_error: 0.2111
79/99 [======================>.......] - ETA: 0s - loss: 0.1254 - mean_absolute_error: 0.2128
85/99 [========================>.....] - ETA: 0s - loss: 0.1272 - mean_absolute_error: 0.2140
99/99 [==============================] - 1s 6ms/step - loss: 0.1291 - mean_absolute_error: 0.2169 - val_loss: 0.2962 - val_mean_absolute_error: 0.4368
Epoch 17/500

 1/99 [..............................] - ETA: 0s - loss: 0.1289 - mean_absolute_error: 0.2362
18/99 [====>.........................] - ETA: 0s - loss: 0.1371 - mean_absolute_error: 0.2234
37/99 [==========>...................] - ETA: 0s - loss: 0.1320 - mean_absolute_error: 0.2221
56/99 [===============>..............] - ETA: 0s - loss: 0.1287 - mean_absolute_error: 0.2201
74/99 [=====================>........] - ETA: 0s - loss: 0.1282 - mean_absolute_error: 0.2195
97/99 [============================>.] - ETA: 0s - loss: 0.1263 - mean_absolute_error: 0.2166
99/99 [==============================] - 0s 4ms/step - loss: 0.1258 - mean_absolute_error: 0.2162 - val_loss: 0.2267 - val_mean_absolute_error: 0.3522
Epoch 18/500

 1/99 [..............................] - ETA: 0s - loss: 0.1302 - mean_absolute_error: 0.2034
24/99 [======>.......................] - ETA: 0s - loss: 0.1225 - mean_absolute_error: 0.2128
44/99 [============>.................] - ETA: 0s - loss: 0.1213 - mean_absolute_error: 0.2133
64/99 [==================>...........] - ETA: 0s - loss: 0.1225 - mean_absolute_error: 0.2154
84/99 [========================>.....] - ETA: 0s - loss: 0.1214 - mean_absolute_error: 0.2144
99/99 [==============================] - 0s 3ms/step - loss: 0.1216 - mean_absolute_error: 0.2138 - val_loss: 0.2670 - val_mean_absolute_error: 0.4069
Epoch 19/500

 1/99 [..............................] - ETA: 0s - loss: 0.1594 - mean_absolute_error: 0.2564
27/99 [=======>......................] - ETA: 0s - loss: 0.1192 - mean_absolute_error: 0.2141
48/99 [=============>................] - ETA: 0s - loss: 0.1182 - mean_absolute_error: 0.2104
69/99 [===================>..........] - ETA: 0s - loss: 0.1180 - mean_absolute_error: 0.2085
91/99 [==========================>...] - ETA: 0s - loss: 0.1199 - mean_absolute_error: 0.2107
99/99 [==============================] - 0s 3ms/step - loss: 0.1203 - mean_absolute_error: 0.2111 - val_loss: 0.2209 - val_mean_absolute_error: 0.3519
Epoch 20/500

 1/99 [..............................] - ETA: 0s - loss: 0.1411 - mean_absolute_error: 0.2550
26/99 [======>.......................] - ETA: 0s - loss: 0.1225 - mean_absolute_error: 0.2179
44/99 [============>.................] - ETA: 0s - loss: 0.1195 - mean_absolute_error: 0.2156
65/99 [==================>...........] - ETA: 0s - loss: 0.1165 - mean_absolute_error: 0.2106
89/99 [=========================>....] - ETA: 0s - loss: 0.1150 - mean_absolute_error: 0.2070
99/99 [==============================] - 0s 3ms/step - loss: 0.1148 - mean_absolute_error: 0.2067 - val_loss: 0.2678 - val_mean_absolute_error: 0.4027
Epoch 21/500

 1/99 [..............................] - ETA: 0s - loss: 0.1383 - mean_absolute_error: 0.2296
27/99 [=======>......................] - ETA: 0s - loss: 0.1179 - mean_absolute_error: 0.2109
47/99 [=============>................] - ETA: 0s - loss: 0.1175 - mean_absolute_error: 0.2126
66/99 [===================>..........] - ETA: 0s - loss: 0.1150 - mean_absolute_error: 0.2102
88/99 [=========================>....] - ETA: 0s - loss: 0.1125 - mean_absolute_error: 0.2062
99/99 [==============================] - 0s 3ms/step - loss: 0.1119 - mean_absolute_error: 0.2055 - val_loss: 0.3736 - val_mean_absolute_error: 0.5018
Epoch 22/500

 1/99 [..............................] - ETA: 0s - loss: 0.1475 - mean_absolute_error: 0.2177
21/99 [=====>........................] - ETA: 0s - loss: 0.1208 - mean_absolute_error: 0.2163
43/99 [============>.................] - ETA: 0s - loss: 0.1148 - mean_absolute_error: 0.2102
70/99 [====================>.........] - ETA: 0s - loss: 0.1126 - mean_absolute_error: 0.2078
95/99 [===========================>..] - ETA: 0s - loss: 0.1114 - mean_absolute_error: 0.2072
99/99 [==============================] - 0s 3ms/step - loss: 0.1110 - mean_absolute_error: 0.2069 - val_loss: 0.3380 - val_mean_absolute_error: 0.4850
Epoch 23/500

 1/99 [..............................] - ETA: 1s - loss: 0.0892 - mean_absolute_error: 0.1844
21/99 [=====>........................] - ETA: 0s - loss: 0.1103 - mean_absolute_error: 0.2052
44/99 [============>.................] - ETA: 0s - loss: 0.1097 - mean_absolute_error: 0.2063
64/99 [==================>...........] - ETA: 0s - loss: 0.1090 - mean_absolute_error: 0.2056
82/99 [=======================>......] - ETA: 0s - loss: 0.1087 - mean_absolute_error: 0.2051
96/99 [============================>.] - ETA: 0s - loss: 0.1088 - mean_absolute_error: 0.2046
99/99 [==============================] - 0s 4ms/step - loss: 0.1087 - mean_absolute_error: 0.2046 - val_loss: 0.2987 - val_mean_absolute_error: 0.4415
Epoch 24/500

 1/99 [..............................] - ETA: 0s - loss: 0.1148 - mean_absolute_error: 0.2219
22/99 [=====>........................] - ETA: 0s - loss: 0.0996 - mean_absolute_error: 0.1927
36/99 [=========>....................] - ETA: 0s - loss: 0.1056 - mean_absolute_error: 0.2011
55/99 [===============>..............] - ETA: 0s - loss: 0.1045 - mean_absolute_error: 0.2021
72/99 [====================>.........] - ETA: 0s - loss: 0.1075 - mean_absolute_error: 0.2059
91/99 [==========================>...] - ETA: 0s - loss: 0.1080 - mean_absolute_error: 0.2066
99/99 [==============================] - 0s 4ms/step - loss: 0.1089 - mean_absolute_error: 0.2068 - val_loss: 0.2373 - val_mean_absolute_error: 0.3807
Epoch 25/500

 1/99 [..............................] - ETA: 0s - loss: 0.1444 - mean_absolute_error: 0.2228
15/99 [===>..........................] - ETA: 0s - loss: 0.1048 - mean_absolute_error: 0.2002
33/99 [=========>....................] - ETA: 0s - loss: 0.1033 - mean_absolute_error: 0.1994
49/99 [=============>................] - ETA: 0s - loss: 0.1031 - mean_absolute_error: 0.2004
64/99 [==================>...........] - ETA: 0s - loss: 0.1050 - mean_absolute_error: 0.2027
82/99 [=======================>......] - ETA: 0s - loss: 0.1067 - mean_absolute_error: 0.2050
97/99 [============================>.] - ETA: 0s - loss: 0.1064 - mean_absolute_error: 0.2049
99/99 [==============================] - 0s 4ms/step - loss: 0.1061 - mean_absolute_error: 0.2048 - val_loss: 0.2831 - val_mean_absolute_error: 0.4295
Epoch 26/500

 1/99 [..............................] - ETA: 0s - loss: 0.1036 - mean_absolute_error: 0.1896
15/99 [===>..........................] - ETA: 0s - loss: 0.1174 - mean_absolute_error: 0.2138
33/99 [=========>....................] - ETA: 0s - loss: 0.1048 - mean_absolute_error: 0.2039
55/99 [===============>..............] - ETA: 0s - loss: 0.1051 - mean_absolute_error: 0.2030
81/99 [=======================>......] - ETA: 0s - loss: 0.1027 - mean_absolute_error: 0.1992
99/99 [==============================] - 0s 3ms/step - loss: 0.1026 - mean_absolute_error: 0.1997 - val_loss: 0.2922 - val_mean_absolute_error: 0.4477
Epoch 27/500

 1/99 [..............................] - ETA: 0s - loss: 0.1053 - mean_absolute_error: 0.2006
18/99 [====>....
[2025-10-23 07:47:43] STDERR:
2025-10-23 07:47:11.170772: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-10-23 07:47:24.533312: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.


[2025-10-23 07:48:03] Running tomorrow data.py and temp.py
[2025-10-23 07:48:03] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-23 07:48:03] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:48:04] Script finished: tomorrow\data.py returncode=0
[2025-10-23 07:48:04] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-23 00:00:00
開始日付: 2025-10-16 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.60秒) ===

[2025-10-23 07:48:04] STDERR:
2025-10-23 07:48:04,216 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-23 07:48:04,216 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-23 07:48:04,216 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 07:48:04,216 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 07:48:04,216 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 07:48:04,261 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-23 07:48:04,261 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 07:48:04,261 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 07:48:04,451 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 07:48:04,467 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 07:48:04,467 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 07:48:04,467 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 07:48:04,467 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 07:48:04,498 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-23 07:48:04,498 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 07:48:04,498 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 07:48:04,738 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 07:48:04,762 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 07:48:04,763 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-23 07:48:04,788 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-23 07:48:04,791 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-23 07:48:04,791 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-23 07:48:04,799 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-23 07:48:04,817 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.60秒)

[2025-10-23 07:48:04] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-23 07:48:04] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:48:06] Script finished: tomorrow\temp.py returncode=0
[2025-10-23 07:48:06] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.069秒
メモリ使用量変化: +4.5MB (開始: 59.9MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-23 07:48:06] STDERR:
2025-10-23 07:48:05,719 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-23 07:48:05,719 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-23 07:48:05,719 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-23 07:48:05,719 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-23 07:48:06,770 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.051秒)
2025-10-23 07:48:06,788 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-23 07:48:06,788 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-23 07:48:06,788 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-23 07:48:06,788 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.000秒)
2025-10-23 07:48:06,788 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.069秒)

[2025-10-23 07:48:09] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2024']}
[2025-10-23 07:48:09] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-23 07:48:09] Child env subset: {'AI_TARGET_YEARS': '2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 07:48:20] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-23 07:48:20] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.4MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 11.85 GB
[データ読み込み開始] メモリ使用量: 11.85 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 11.85 GB
学習データの読み込みが完了しました (実行時間: 0.023秒)
[OK] load_training_data 実行時間: 0.096秒
[テスト・明日データ読み込み開始] メモリ使用量: 11.85 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 11.85 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.031秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.110秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 11.85 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 11.87 GB
モデル読み込み完了 (実行時間: 0.237秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 11.87 GB
[予測処理開始] メモリ使用量: 11.87 GB
テストデータ標準化開始: (879, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 11.84 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2196-3807kW, 翌日予測 2160-3851kW
[予測処理完了] メモリ使用量: 11.85 GB
予測処理完了 (実行時間: 0.409秒)
テスト予測: (879, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.409秒
[予測完了] メモリ使用量: 11.85 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (879, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(879, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 259.220 kW, R2スコア: 0.6188, MAE: 216.403 kW
[CSV保存開始] メモリ使用量: 11.85 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 11.85 GB
明日の予測結果の保存が完了しました (実行時間: 0.016秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.111秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 11.87 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: 0.6188
[OK] tomorrow 実行時間: 2.409秒
メモリ使用量変化: +57.2MB (開始: 300.4MB → 終了: 357.6MB)
=== 処理完了 ===
(簡略表示) RMSE: 259.220 kW, R2スコア: 0.6188
実行時間: 2.409秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-23 07:48:20] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-23 08:00:01] Received /run-data payload: {'years': ['2022', '2023', '2024']}
[2025-10-23 08:00:01] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:00:01] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:00:03] Script finished: data\data.py returncode=0
[2025-10-23 08:00:03] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:00:03] STDERR:
2025-10-23 08:00:02,937 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:00:02,937 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:00:02,937 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:00:02,968 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:00:02,968 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:00:02,985 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:00:03,031 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:00:03,173 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:00:03,173 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:00:24] Received /run-train payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:00:24] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-23 08:00:24] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:00:24] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:00:26] Script finished: data\data.py returncode=0
[2025-10-23 08:00:26] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:00:26] STDERR:
2025-10-23 08:00:26,250 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:00:26,263 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:00:26,263 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:00:26,282 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:00:26,282 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:00:26,312 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:00:26,360 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:00:26,512 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:00:26,512 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:00:26] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_train.py
[2025-10-23 08:00:26] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:00:31] Script finished: train\LightGBM\LightGBM_train.py returncode=0
[2025-10-23 08:00:31] STDOUT:
=== LightGBM統一最適化設定適用完了 ===
AI_TARGET_YEARS=2022,2023,2024
=== LightGBM学習開始 ===
=== LightGBM学習統合処理 開始 ===
=== LightGBM電力需要予測モデル学習開始 ===
=== 学習データ読み込み 開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
メモリ最適化: float32データ型使用、メモリ使用量約50%削減
=== 学習データ読み込み 完了 (実行時間: 0.10秒) ===
=== データ標準化処理 開始 ===
データの標準化を実行中...
データの標準化が完了しました（float32最適化済み）
=== データ標準化処理 完了 (実行時間: 0.00秒) ===
学習率を 0.1 に設定しました
=== LightGBMモデル構築 開始 ===
LightGBMモデルを構築中...
LightGBMモデル構築完了 - パラメータ: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'num_leaves': 31, 'min_child_samples': 20, 'subsample': 1.0, 'colsample_bytree': 1.0, 'random_state': 42, 'verbose': -1}
=== LightGBMモデル構築 完了 (実行時間: 0.00秒) ===
=== LightGBMモデル学習 開始 ===
LightGBMモデルの学習を開始します...
LightGBMモデルの学習が完了しました
=== LightGBMモデル学習 完了 (実行時間: 0.08秒) ===
=== モデル・スケーラー保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
LightGBMモデルを train/LightGBM/LightGBM_model.sav に保存しました
スケーラーを train/LightGBM/LightGBM_model_scaler.pkl に保存しました
=== モデル・スケーラー保存 完了 (実行時間: 0.04秒) ===
=== モデル性能評価 開始 ===
=== モデル性能評価開始 ===
モデル性能評価を実行中...
テストスコア: 0.9193
テスト損失: 27429.516, テストMAE: 107.717
RMSE: 165.619 kW
R2スコア: 0.9193
MAE: 107.717 kW
=== モデル性能評価完了 ===
=== モデル性能評価 完了 (実行時間: 0.00秒) ===
=== 予測結果CSV保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
予測結果を train/LightGBM/LightGBM_Ypred.csv に保存しました（2631行）
=== 予測結果CSV保存 完了 (実行時間: 0.03秒) ===
=== 予測結果可視化 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
全期間グラフを train/LightGBM/LightGBM_Ypred.png に保存しました（16:9統一フォーマット）
1週間グラフを train/LightGBM/LightGBM_Ypred_7d.png に保存しました（16:9統一フォーマット）
=== 予測結果可視化 完了 (実行時間: 2.19秒) ===
=== LightGBM電力需要予測モデル学習完了 ===
=== LightGBM学習統合処理 完了 (実行時間: 2.68秒) ===
=== LightGBM学習完了 (実行時間: 2.71秒) ===
最終結果 - RMSE: 165.619 kW, R2スコア: 0.9193, MAE: 107.717 kW

[2025-10-23 08:01:47] Received /run-train payload: {'model': 'Keras', 'years': ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']}
[2025-10-23 08:01:47] Running data pipeline before training with AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
[2025-10-23 08:01:47] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:01:47] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:01:49] Script finished: data\data.py returncode=0
[2025-10-23 08:01:49] STDOUT:
対象年に制限を適用します: ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024']
電力データファイル: 9件
気温データファイル: 9件
共通年: 9年分 (2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024)
電力データ読み込み中: data\juyo-2016.csv
電力データ読み込み中: data\juyo-2017.csv
電力データ読み込み中: data\juyo-2018.csv
電力データ読み込み中: data\juyo-2019.csv
電力データ読み込み中: data\juyo-2020.csv
電力データ読み込み中: data\juyo-2021.csv
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 76728行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2016.csv
気温データ読み込み中: data\temperature-2017.csv
気温データ読み込み中: data\temperature-2018.csv
気温データ読み込み中: data\temperature-2019.csv
気温データ読み込み中: data\temperature-2020.csv
気温データ読み込み中: data\temperature-2021.csv
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 78912行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 76723行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (76723, 4)
ターゲットデータ作成完了: (76723, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 69050行, テストデータ: 7673行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:01:49] STDERR:
2025-10-23 08:01:48,677 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:01:48,677 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:01:48,677 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:01:48,724 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:01:48,724 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:01:48,809 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:01:48,933 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:01:49,362 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:01:49,362 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:01:49] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_train.py
[2025-10-23 08:01:49] Child env subset: {'AI_TARGET_YEARS': '2016,2017,2018,2019,2020,2021,2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:04:24] Script finished: train\Keras\Keras_train.py returncode=0
[2025-10-23 08:04:24] STDOUT:
Keras: 統一パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2016,2017,2018,2019,2020,2021,2022,2023,2024
=== Keras学習開始 ===
環境変数指定による学習年: 2016,2017,2018,2019,2020,2021,2022,2023,2024
Keras電力需要予測モデルの学習を開始します...
=== 学習・テストデータ読み込み開始 ===
学習データを読み込み中...
学習データ形状: X_train=(69050, 4), y_train=(69050,)
テストデータ形状: X_test=(7673, 4), y_test=(7673,)
=== 学習・テストデータ読み込み完了 ===
=== データ標準化開始 ===
データの標準化を実行中...
標準化完了: 特徴量数=4, 目的変数正規化適用
=== データ標準化完了 ===
=== Kerasモデル構築開始 ===
Kerasモデルを構築中... (入力次元: 4)
改善版v3アーキテクチャ: 128→128→64→32→1
過学習対策v3: Dropout=0.1, L2正則化=0.001, Batch=64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 hidden1 (Dense)             (None, 128)               640       
                                                                 
 dropout1 (Dropout)          (None, 128)               0         
                                                                 
 hidden2 (Dense)             (None, 128)               16512     
                                                                 
 dropout2 (Dropout)          (None, 128)               0         
                                                                 
 hidden3 (Dense)             (None, 64)                8256      
                                                                 
 hidden4 (Dense)             (None, 32)                2080      
                                                                 
 output (Dense)              (None, 1)                 33        
                                                                 
=================================================================
Total params: 27521 (107.50 KB)
Trainable params: 27521 (107.50 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Kerasモデル構築完了 (学習率: 0.001, Batch: 64)
=== Kerasモデル構築完了 ===
=== モデル学習開始 ===
モデル学習開始 (epochs: 500, batch_size: 64, patience: 20)
Epoch 1/500

  1/864 [..............................] - ETA: 13:24 - loss: 1.3778 - mean_absolute_error: 0.8433
 22/864 [..............................] - ETA: 2s - loss: 0.8281 - mean_absolute_error: 0.6153   
 44/864 [>.............................] - ETA: 2s - loss: 0.6702 - mean_absolute_error: 0.5231
 63/864 [=>............................] - ETA: 2s - loss: 0.6035 - mean_absolute_error: 0.4825
 81/864 [=>............................] - ETA: 2s - loss: 0.5571 - mean_absolute_error: 0.4530
105/864 [==>...........................] - ETA: 2s - loss: 0.5200 - mean_absolute_error: 0.4289
133/864 [===>..........................] - ETA: 2s - loss: 0.4902 - mean_absolute_error: 0.4107
162/864 [====>.........................] - ETA: 1s - loss: 0.4654 - mean_absolute_error: 0.3958
183/864 [=====>........................] - ETA: 1s - loss: 0.4512 - mean_absolute_error: 0.3881
207/864 [======>.......................] - ETA: 1s - loss: 0.4404 - mean_absolute_error: 0.3834
233/864 [=======>......................] - ETA: 1s - loss: 0.4280 - mean_absolute_error: 0.3773
261/864 [========>.....................] - ETA: 1s - loss: 0.4152 - mean_absolute_error: 0.3701
286/864 [========>.....................] - ETA: 1s - loss: 0.4060 - mean_absolute_error: 0.3654
309/864 [=========>....................] - ETA: 1s - loss: 0.3988 - mean_absolute_error: 0.3618
331/864 [==========>...................] - ETA: 1s - loss: 0.3919 - mean_absolute_error: 0.3583
358/864 [===========>..................] - ETA: 1s - loss: 0.3845 - mean_absolute_error: 0.3549
380/864 [============>.................] - ETA: 1s - loss: 0.3795 - mean_absolute_error: 0.3528
409/864 [=============>................] - ETA: 1s - loss: 0.3727 - mean_absolute_error: 0.3492
435/864 [==============>...............] - ETA: 1s - loss: 0.3669 - mean_absolute_error: 0.3464
458/864 [==============>...............] - ETA: 1s - loss: 0.3613 - mean_absolute_error: 0.3434
478/864 [===============>..............] - ETA: 0s - loss: 0.3570 - mean_absolute_error: 0.3412
499/864 [================>.............] - ETA: 0s - loss: 0.3529 - mean_absolute_error: 0.3391
524/864 [=================>............] - ETA: 0s - loss: 0.3485 - mean_absolute_error: 0.3370
544/864 [=================>............] - ETA: 0s - loss: 0.3449 - mean_absolute_error: 0.3353
570/864 [==================>...........] - ETA: 0s - loss: 0.3401 - mean_absolute_error: 0.3328
589/864 [===================>..........] - ETA: 0s - loss: 0.3372 - mean_absolute_error: 0.3315
615/864 [====================>.........] - ETA: 0s - loss: 0.3325 - mean_absolute_error: 0.3291
642/864 [=====================>........] - ETA: 0s - loss: 0.3275 - mean_absolute_error: 0.3261
670/864 [======================>.......] - ETA: 0s - loss: 0.3233 - mean_absolute_error: 0.3240
696/864 [=======================>......] - ETA: 0s - loss: 0.3193 - mean_absolute_error: 0.3218
722/864 [========================>.....] - ETA: 0s - loss: 0.3158 - mean_absolute_error: 0.3198
744/864 [========================>.....] - ETA: 0s - loss: 0.3130 - mean_absolute_error: 0.3181
771/864 [=========================>....] - ETA: 0s - loss: 0.3094 - mean_absolute_error: 0.3161
797/864 [==========================>...] - ETA: 0s - loss: 0.3062 - mean_absolute_error: 0.3147
819/864 [===========================>..] - ETA: 0s - loss: 0.3035 - mean_absolute_error: 0.3132
841/864 [============================>.] - ETA: 0s - loss: 0.3011 - mean_absolute_error: 0.3118
864/864 [==============================] - 4s 3ms/step - loss: 0.2982 - mean_absolute_error: 0.3103 - val_loss: 0.2088 - val_mean_absolute_error: 0.2776
Epoch 2/500

  1/864 [..............................] - ETA: 0s - loss: 0.2098 - mean_absolute_error: 0.2896
 23/864 [..............................] - ETA: 2s - loss: 0.2096 - mean_absolute_error: 0.2719
 50/864 [>.............................] - ETA: 2s - loss: 0.2023 - mean_absolute_error: 0.2665
 76/864 [=>............................] - ETA: 1s - loss: 0.1962 - mean_absolute_error: 0.2614
 94/864 [==>...........................] - ETA: 1s - loss: 0.1966 - mean_absolute_error: 0.2606
121/864 [===>..........................] - ETA: 1s - loss: 0.1952 - mean_absolute_error: 0.2594
149/864 [====>.........................] - ETA: 1s - loss: 0.1973 - mean_absolute_error: 0.2616
174/864 [=====>........................] - ETA: 1s - loss: 0.1977 - mean_absolute_error: 0.2632
195/864 [=====>........................] - ETA: 1s - loss: 0.1963 - mean_absolute_error: 0.2628
217/864 [======>.......................] - ETA: 1s - loss: 0.1950 - mean_absolute_error: 0.2616
238/864 [=======>......................] - ETA: 1s - loss: 0.1923 - mean_absolute_error: 0.2594
262/864 [========>.....................] - ETA: 1s - loss: 0.1901 - mean_absolute_error: 0.2577
287/864 [========>.....................] - ETA: 1s - loss: 0.1890 - mean_absolute_error: 0.2572
314/864 [=========>....................] - ETA: 1s - loss: 0.1881 - mean_absolute_error: 0.2570
338/864 [==========>...................] - ETA: 1s - loss: 0.1864 - mean_absolute_error: 0.2558
359/864 [===========>..................] - ETA: 1s - loss: 0.1856 - mean_absolute_error: 0.2554
378/864 [============>.................] - ETA: 1s - loss: 0.1852 - mean_absolute_error: 0.2553
396/864 [============>.................] - ETA: 1s - loss: 0.1845 - mean_absolute_error: 0.2551
420/864 [=============>................] - ETA: 1s - loss: 0.1839 - mean_absolute_error: 0.2550
443/864 [==============>...............] - ETA: 1s - loss: 0.1834 - mean_absolute_error: 0.2546
466/864 [===============>..............] - ETA: 0s - loss: 0.1833 - mean_absolute_error: 0.2546
489/864 [===============>..............] - ETA: 0s - loss: 0.1826 - mean_absolute_error: 0.2542
513/864 [================>.............] - ETA: 0s - loss: 0.1814 - mean_absolute_error: 0.2538
538/864 [=================>............] - ETA: 0s - loss: 0.1798 - mean_absolute_error: 0.2526
566/864 [==================>...........] - ETA: 0s - loss: 0.1790 - mean_absolute_error: 0.2526
589/864 [===================>..........] - ETA: 0s - loss: 0.1789 - mean_absolute_error: 0.2527
614/864 [====================>.........] - ETA: 0s - loss: 0.1784 - mean_absolute_error: 0.2527
641/864 [=====================>........] - ETA: 0s - loss: 0.1771 - mean_absolute_error: 0.2521
666/864 [======================>.......] - ETA: 0s - loss: 0.1767 - mean_absolute_error: 0.2518
692/864 [=======================>......] - ETA: 0s - loss: 0.1764 - mean_absolute_error: 0.2518
717/864 [=======================>......] - ETA: 0s - loss: 0.1756 - mean_absolute_error: 0.2513
745/864 [========================>.....] - ETA: 0s - loss: 0.1749 - mean_absolute_error: 0.2511
768/864 [=========================>....] - ETA: 0s - loss: 0.1739 - mean_absolute_error: 0.2504
790/864 [==========================>...] - ETA: 0s - loss: 0.1730 - mean_absolute_error: 0.2499
811/864 [===========================>..] - ETA: 0s - loss: 0.1722 - mean_absolute_error: 0.2494
831/864 [===========================>..] - ETA: 0s - loss: 0.1713 - mean_absolute_error: 0.2489
859/864 [============================>.] - ETA: 0s - loss: 0.1706 - mean_absolute_error: 0.2487
864/864 [==============================] - 2s 3ms/step - loss: 0.1704 - mean_absolute_error: 0.2486 - val_loss: 0.1592 - val_mean_absolute_error: 0.2493
Epoch 3/500

  1/864 [..............................] - ETA: 4s - loss: 0.1800 - mean_absolute_error: 0.2702
 22/864 [..............................] - ETA: 2s - loss: 0.1610 - mean_absolute_error: 0.2550
 44/864 [>.............................] - ETA: 1s - loss: 0.1560 - mean_absolute_error: 0.2518
 64/864 [=>............................] - ETA: 1s - loss: 0.1528 - mean_absolute_error: 0.2481
 86/864 [=>............................] - ETA: 1s - loss: 0.1478 - mean_absolute_error: 0.2427
106/864 [==>...........................] - ETA: 1s - loss: 0.1502 - mean_absolute_error: 0.2448
127/864 [===>..........................] - ETA: 1s - loss: 0.1488 - mean_absolute_error: 0.2433
147/864 [====>.........................] - ETA: 1s - loss: 0.1505 - mean_absolute_error: 0.2448
167/864 [====>.........................] - ETA: 1s - loss: 0.1518 - mean_absolute_error: 0.2459
186/864 [=====>........................] - ETA: 1s - loss: 0.1504 - mean_absolute_error: 0.2444
205/864 [======>.......................] - ETA: 1s - loss: 0.1492 - mean_absolute_error: 0.2434
227/864 [======>.......................] - ETA: 1s - loss: 0.1477 - mean_absolute_error: 0.2421
257/864 [=======>......................] - ETA: 1s - loss: 0.1475 - mean_absolute_error: 0.2414
282/864 [========>.....................] - ETA: 1s - loss: 0.1474 - mean_absolute_error: 0.2412
309/864 [=========>....................] - ETA: 1s - loss: 0.1475 - mean_absolute_error: 0.2414
340/864 [==========>...................] - ETA: 1s - loss: 0.1470 - mean_absolute_error: 0.2412
369/864 [===========>..................] - ETA: 1s - loss: 0.1463 - mean_absolute_error: 0.2402
394/864 [============>.................] - ETA: 1s - loss: 0.1456 - mean_absolute_error: 0.2398
425/864 [=============>................] - ETA: 1s - loss: 0.1447 - mean_absolute_error: 0.2390
453/864 [==============>...............] - ETA: 0s - loss: 0.1445 - mean_absolute_error: 0.2391
475/864 [===============>..............] - ETA: 0s - loss: 0.1435 - mean_absolute_error: 0.2384
498/864 [================>.............] - ETA: 0s - loss: 0.1434 - mean_absolute_error: 0.2383
518/864 [================>.............] - ETA: 0s - loss: 0.1435 - mean_absolute_error: 0.2385
540/864 [=================>............] - ETA: 0s - loss: 0.1433 - mean_absolute_error: 0.2382
562/864 [==================>...........] - ETA: 0s - loss: 0.1431 - mean_absolute_error: 0.2383
581/864 [===================>..........] - ETA: 0s - loss: 0.1428 - mean_absolute_error: 0.2382
601/864 [===================>..........] - ETA: 0s - loss: 0.1426 - mean_absolute_error: 0.2380
622/864 [====================>.........] - ETA: 0s - loss: 0.1425 - mean_absolute_error: 0.2378
642/864 [=====================>........] - ETA: 0s - loss: 0.1425 - mean_absolute_error: 0.2379
663/864 [======================>.......] - ETA: 0s - loss: 0.1426 - mean_absolute_error: 0.2380
691/864 [======================>.......] - ETA: 0s - loss: 0.1422 - mean_absolute_error: 0.2378
718/864 [=======================>......] - ETA: 0s - loss: 0.1418 - mean_absolute_error: 0.2375
742/864 [========================>.....] - ETA: 0s - loss: 0.1420 - mean_absolute_error: 0.2375
765/864 [=========================>....] - ETA: 0s - loss: 0.1416 - mean_absolute_error: 0.2372
787/864 [==========================>...] - ETA: 0s - loss: 0.1416 - mean_absolute_error: 0.2374
802/864 [==========================>...] - ETA: 0s - loss: 0.1414 - mean_absolute_error: 0.2372
825/864 [===========================>..] - ETA: 0s - loss: 0.1417 - mean_absolute_error: 0.2375
846/864 [============================>.] - ETA: 0s - loss: 0.1412 - mean_absolute_error: 0.2372
862/864 [============================>.] - ETA: 0s - loss: 0.1413 - mean_absolute_error: 0.2373
864/864 [==============================] - 3s 3ms/step - loss: 0.1412 - mean_absolute_error: 0.2373 - val_loss: 0.1236 - val_mean_absolute_error: 0.2135
Epoch 4/500

  1/864 [..............................] - ETA: 12s - loss: 0.1573 - mean_absolute_error: 0.2569
 25/864 [..............................] - ETA: 2s - loss: 0.1336 - mean_absolute_error: 0.2357 
 47/864 [>.............................] - ETA: 2s - loss: 0.1405 - mean_absolute_error: 0.2421
 61/864 [=>............................] - ETA: 2s - loss: 0.1377 - mean_absolute_error: 0.2389
 76/864 [=>............................] - ETA: 2s - loss: 0.1337 - mean_absolute_error: 0.2349
 98/864 [==>...........................] - ETA: 2s - loss: 0.1316 - mean_absolute_error: 0.2324
119/864 [===>..........................] - ETA: 2s - loss: 0.1309 - mean_absolute_error: 0.2315
145/864 [====>.........................] - ETA: 2s - loss: 0.1293 - mean_absolute_error: 0.2305
168/864 [====>.........................] - ETA: 2s - loss: 0.1306 - mean_absolute_error: 0.2312
182/864 [=====>........................] - ETA: 2s - loss: 0.1300 - mean_absolute_error: 0.2310
196/864 [=====>........................] - ETA: 2s - loss: 0.1298 - mean_absolute_error: 0.2307
216/864 [======>.......................] - ETA: 2s - loss: 0.1286 - mean_absolute_error: 0.2300
231/864 [=======>......................] - ETA: 2s - loss: 0.1286 - mean_absolute_error: 0.2299
248/864 [=======>......................] - ETA: 1s - loss: 0.1296 - mean_absolute_error: 0.2308
271/864 [========>.....................] - ETA: 1s - loss: 0.1296 - mean_absolute_error: 0.2315
289/864 [=========>....................] - ETA: 1s - loss: 0.1311 - mean_absolute_error: 0.2328
317/864 [==========>...................] - ETA: 1s - loss: 0.1316 - mean_absolute_error: 0.2332
342/864 [==========>...................] - ETA: 1s - loss: 0.1310 - mean_absolute_error: 0.2328
363/864 [===========>..................] - ETA: 1s - loss: 0.1304 - mean_absolute_error: 0.2324
381/864 [============>.................] - ETA: 1s - loss: 0.1300 - mean_absolute_error: 0.2321
399/864 [============>.................] - ETA: 1s - loss: 0.1304 - mean_absolute_error: 0.2324
419/864 [=============>................] - ETA: 1s - loss: 0.1307 - mean_absolute_error: 0.2328
450/864 [==============>...............] - ETA: 1s - loss: 0.1311 - mean_absolute_error: 0.2332
478/864 [===============>..............] - ETA: 1s - loss: 0.1309 - mean_absolute_error: 0.2330
501/864 [================>.............] - ETA: 1s - loss: 0.1305 - mean_absolute_error: 0.2326
523/864 [=================>............] - ETA: 0s - loss: 0.1301 - mean_absolute_error: 0.2323
547/864 [=================>............] - ETA: 0s - loss: 0.1296 - mean_absolute_error: 0.2319
567/864 [==================>...........] - ETA: 0s - loss: 0.1297 - mean_absolute_error: 0.2322
584/864 [===================>..........] - ETA: 0s - loss: 0.1301 - mean_absolute_error: 0.2327
605/864 [====================>.........] - ETA: 0s - loss: 0.1305 - mean_absolute_error: 0.2331
632/864 [====================>.........] - ETA: 0s - loss: 0.1304 - mean_absolute_error: 0.2330
655/864 [=====================>........] - ETA: 0s - loss: 0.1308 - mean_absolute_error: 0.2334
681/864 [======================>.......] - ETA: 0s - loss: 0.1307 - mean_absolute_error: 0.2334
702/864 [=======================>......] - ETA: 0s - loss: 0.1303 - mean_absolute_error: 0.2331
729/864 [========================>.....] - ETA: 0s - loss: 0.1300 - mean_absolute_error: 0.2329
758/864 [=========================>....] - ETA: 0s - loss: 0.1299 - mean_absolute_error: 0.2327
785/864 [==========================>...] - ETA: 0s - loss: 0.1294 - mean_absolute_error: 0.2323
812/864 [===========================>..] - ETA: 0s - loss: 0.1291 - mean_absolute_error: 0.2321
830/864 [===========================>..] - ETA: 0s - loss: 0.1294 - mean_absolute_error: 0.2323
853/864 [============================>.] - ETA: 0s - loss: 0.1294 - mean_absolute_error: 0.2323
864/864 [==============================] - 3s 3ms/step - loss: 0.1291 - mean_absolute_error: 0.2322 - val_loss: 0.1487 - val_mean_absolute_error: 0.2629
Epoch 5/500

  1/864 [..............................] - ETA: 0s - loss: 0.1325 - mean_absolute_error: 0.2254
 17/864 [..............................] - ETA: 2s - loss: 0.1182 - mean_absolute_error: 0.2228
 35/864 [>.............................] - ETA: 2s - loss: 0.1185 - mean_absolute_error: 0.2224
 54/864 [>.............................] - ETA: 2s - loss: 0.1228 - mean_absolute_error: 0.2265
 81/864 [=>............................] - ETA: 2s - loss: 0.1271 - mean_absolute_error: 0.2284
107/864 [==>...........................] - ETA: 2s - loss: 0.1239 - mean_absolute_error: 0.2262
134/864 [===>..........................] - ETA: 1s - loss: 0.1239 - mean_absolute_error: 0.2273
162/864 [====>.........................] - ETA: 1s - loss: 0.1236 - mean_absolute_error: 0.2275
187/864 [=====>........................] - ETA: 1s - loss: 0.1227 - mean_absolute_error: 0.2264
213/864 [======>.......................] - ETA: 1s - loss: 0.1230 - mean_absolute_error: 0.2262
237/864 [=======>......................] - ETA: 1s - loss: 0.1230 - mean_absolute_error: 0.2265
263/864 [========>.....................] - ETA: 1s - loss: 0.1228 - mean_absolute_error: 0.2261
284/864 [========>.....................] - ETA: 1s - loss: 0.1223 - mean_absolute_error: 0.2262
307/864 [=========>....................] - ETA: 1s - loss: 0.1217 - mean_absolute_error: 0.2253
333/864 [==========>...................] - ETA: 1s - loss: 0.1221 - mean_absolute_error: 0.2259
359/864 [===========>..................] - ETA: 1s - loss: 0.1228 - mean_absolute_error: 0.2267
386/864 [============>.................] - ETA: 1s - loss: 0.1232 - mean_absolute_error: 0.2274
404/864 [=============>................] - ETA: 1s - loss: 0.1232 - mean_absolute_error: 0.2276
420/864 [=============>................] - ETA: 1s - loss: 0.1231 - mean_absolute_error: 0.2276
437/864 [==============>...............] - ETA: 1s - loss: 0.1229 - mean_absolute_error: 0.2274
452/864 [==============>...............] - ETA: 1s - loss: 0.1229 - mean_absolute_error: 0.2274
473/864 [===============>..............] - ETA: 1s - loss: 0.1224 - mean_absolute_error: 0.2269
495/864 [================>.............] - ETA: 0s - loss: 0.1227 - mean_absolute_error: 0.2271
517/864 [================>.............] - ETA: 0s - loss: 0.1227 - mean_absolute_error: 0.2273
538/864 [=================>............] - ETA: 0s - loss: 0.1226 - mean_absolute_error: 0.2274
562/864 [==================>...........] - ETA: 0s - loss: 0.1227 - mean_absolute_error: 0.2274
586/864 [===================>..........] - ETA: 0s - loss: 0.1225 - mean_absolute_error: 0.2273
613/864 [====================>.........] - ETA: 0s - loss: 0.1226 - mean_absolute_erro
[2025-10-23 08:04:24] STDERR:
2025-10-23 08:01:51.644228: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-10-23 08:01:57.439934: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.


[2025-10-23 08:05:53] Received /run-data payload: {'years': ['2022', '2023', '2024']}
[2025-10-23 08:05:53] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:05:53] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:05:55] Script finished: data\data.py returncode=0
[2025-10-23 08:05:55] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:05:55] STDERR:
2025-10-23 08:05:55,270 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:05:55,270 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:05:55,270 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:05:55,285 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:05:55,285 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:05:55,316 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:05:55,364 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:05:55,489 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:05:55,489 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:06:04] Received /run-train payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:06:04] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-23 08:06:04] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:06:04] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:06:06] Script finished: data\data.py returncode=0
[2025-10-23 08:06:06] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:06:06] STDERR:
2025-10-23 08:06:06,148 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:06:06,149 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:06:06,149 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:06:06,178 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:06:06,178 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:06:06,207 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:06:06,247 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:06:06,390 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:06:06,390 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:06:06] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_train.py
[2025-10-23 08:06:06] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:07:28] Script finished: train\Keras\Keras_train.py returncode=0
[2025-10-23 08:07:28] STDOUT:
Keras: 統一パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
=== Keras学習開始 ===
環境変数指定による学習年: 2022,2023,2024
Keras電力需要予測モデルの学習を開始します...
=== 学習・テストデータ読み込み開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
=== 学習・テストデータ読み込み完了 ===
=== データ標準化開始 ===
データの標準化を実行中...
標準化完了: 特徴量数=4, 目的変数正規化適用
=== データ標準化完了 ===
=== Kerasモデル構築開始 ===
Kerasモデルを構築中... (入力次元: 4)
改善版v3アーキテクチャ: 128→128→64→32→1
過学習対策v3: Dropout=0.1, L2正則化=0.001, Batch=64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 hidden1 (Dense)             (None, 128)               640       
                                                                 
 dropout1 (Dropout)          (None, 128)               0         
                                                                 
 hidden2 (Dense)             (None, 128)               16512     
                                                                 
 dropout2 (Dropout)          (None, 128)               0         
                                                                 
 hidden3 (Dense)             (None, 64)                8256      
                                                                 
 hidden4 (Dense)             (None, 32)                2080      
                                                                 
 output (Dense)              (None, 1)                 33        
                                                                 
=================================================================
Total params: 27521 (107.50 KB)
Trainable params: 27521 (107.50 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Kerasモデル構築完了 (学習率: 0.001, Batch: 64)
=== Kerasモデル構築完了 ===
=== モデル学習開始 ===
モデル学習開始 (epochs: 500, batch_size: 64, patience: 20)
Epoch 1/500

  1/296 [..............................] - ETA: 4:06 - loss: 1.1270 - mean_absolute_error: 0.7487
 22/296 [=>............................] - ETA: 0s - loss: 0.8090 - mean_absolute_error: 0.6130  
 47/296 [===>..........................] - ETA: 0s - loss: 0.6480 - mean_absolute_error: 0.5113
 74/296 [======>.......................] - ETA: 0s - loss: 0.5603 - mean_absolute_error: 0.4556
100/296 [=========>....................] - ETA: 0s - loss: 0.5152 - mean_absolute_error: 0.4267
123/296 [===========>..................] - ETA: 0s - loss: 0.4856 - mean_absolute_error: 0.4086
145/296 [=============>................] - ETA: 0s - loss: 0.4640 - mean_absolute_error: 0.3954
171/296 [================>.............] - ETA: 0s - loss: 0.4444 - mean_absolute_error: 0.3830
199/296 [===================>..........] - ETA: 0s - loss: 0.4283 - mean_absolute_error: 0.3741
224/296 [=====================>........] - ETA: 0s - loss: 0.4164 - mean_absolute_error: 0.3676
250/296 [========================>.....] - ETA: 0s - loss: 0.4035 - mean_absolute_error: 0.3594
272/296 [==========================>...] - ETA: 0s - loss: 0.3955 - mean_absolute_error: 0.3554
295/296 [============================>.] - ETA: 0s - loss: 0.3867 - mean_absolute_error: 0.3504
296/296 [==============================] - 2s 3ms/step - loss: 0.3862 - mean_absolute_error: 0.3500 - val_loss: 0.2451 - val_mean_absolute_error: 0.2589
Epoch 2/500

  1/296 [..............................] - ETA: 0s - loss: 0.3809 - mean_absolute_error: 0.3472
 24/296 [=>............................] - ETA: 0s - loss: 0.2781 - mean_absolute_error: 0.2910
 49/296 [===>..........................] - ETA: 0s - loss: 0.2724 - mean_absolute_error: 0.2871
 71/296 [======>.......................] - ETA: 0s - loss: 0.2710 - mean_absolute_error: 0.2880
 87/296 [=======>......................] - ETA: 0s - loss: 0.2713 - mean_absolute_error: 0.2877
110/296 [==========>...................] - ETA: 0s - loss: 0.2706 - mean_absolute_error: 0.2895
139/296 [=============>................] - ETA: 0s - loss: 0.2682 - mean_absolute_error: 0.2897
164/296 [===============>..............] - ETA: 0s - loss: 0.2636 - mean_absolute_error: 0.2863
184/296 [=================>............] - ETA: 0s - loss: 0.2615 - mean_absolute_error: 0.2856
214/296 [====================>.........] - ETA: 0s - loss: 0.2576 - mean_absolute_error: 0.2839
243/296 [=======================>......] - ETA: 0s - loss: 0.2539 - mean_absolute_error: 0.2818
270/296 [==========================>...] - ETA: 0s - loss: 0.2504 - mean_absolute_error: 0.2796
296/296 [==============================] - 1s 3ms/step - loss: 0.2479 - mean_absolute_error: 0.2783 - val_loss: 0.2020 - val_mean_absolute_error: 0.2486
Epoch 3/500

  1/296 [..............................] - ETA: 0s - loss: 0.2156 - mean_absolute_error: 0.2615
 21/296 [=>............................] - ETA: 0s - loss: 0.2194 - mean_absolute_error: 0.2634
 44/296 [===>..........................] - ETA: 0s - loss: 0.2189 - mean_absolute_error: 0.2653
 69/296 [=====>........................] - ETA: 0s - loss: 0.2130 - mean_absolute_error: 0.2610
 95/296 [========>.....................] - ETA: 0s - loss: 0.2100 - mean_absolute_error: 0.2581
124/296 [===========>..................] - ETA: 0s - loss: 0.2083 - mean_absolute_error: 0.2569
143/296 [=============>................] - ETA: 0s - loss: 0.2074 - mean_absolute_error: 0.2566
164/296 [===============>..............] - ETA: 0s - loss: 0.2060 - mean_absolute_error: 0.2564
190/296 [==================>...........] - ETA: 0s - loss: 0.2060 - mean_absolute_error: 0.2565
214/296 [====================>.........] - ETA: 0s - loss: 0.2055 - mean_absolute_error: 0.2566
240/296 [=======================>......] - ETA: 0s - loss: 0.2037 - mean_absolute_error: 0.2559
263/296 [=========================>....] - ETA: 0s - loss: 0.2023 - mean_absolute_error: 0.2549
285/296 [===========================>..] - ETA: 0s - loss: 0.2006 - mean_absolute_error: 0.2539
296/296 [==============================] - 1s 3ms/step - loss: 0.1997 - mean_absolute_error: 0.2536 - val_loss: 0.1524 - val_mean_absolute_error: 0.2145
Epoch 4/500

  1/296 [..............................] - ETA: 2s - loss: 0.1362 - mean_absolute_error: 0.1924
 29/296 [=>............................] - ETA: 0s - loss: 0.1725 - mean_absolute_error: 0.2382
 49/296 [===>..........................] - ETA: 0s - loss: 0.1704 - mean_absolute_error: 0.2367
 73/296 [======>.......................] - ETA: 0s - loss: 0.1746 - mean_absolute_error: 0.2412
 95/296 [========>.....................] - ETA: 0s - loss: 0.1759 - mean_absolute_error: 0.2428
121/296 [===========>..................] - ETA: 0s - loss: 0.1752 - mean_absolute_error: 0.2425
148/296 [==============>...............] - ETA: 0s - loss: 0.1743 - mean_absolute_error: 0.2425
172/296 [================>.............] - ETA: 0s - loss: 0.1754 - mean_absolute_error: 0.2443
194/296 [==================>...........] - ETA: 0s - loss: 0.1741 - mean_absolute_error: 0.2437
217/296 [====================>.........] - ETA: 0s - loss: 0.1725 - mean_absolute_error: 0.2431
238/296 [=======================>......] - ETA: 0s - loss: 0.1724 - mean_absolute_error: 0.2435
266/296 [=========================>....] - ETA: 0s - loss: 0.1713 - mean_absolute_error: 0.2433
292/296 [============================>.] - ETA: 0s - loss: 0.1707 - mean_absolute_error: 0.2426
296/296 [==============================] - 1s 3ms/step - loss: 0.1705 - mean_absolute_error: 0.2426 - val_loss: 0.1227 - val_mean_absolute_error: 0.1895
Epoch 5/500

  1/296 [..............................] - ETA: 0s - loss: 0.1512 - mean_absolute_error: 0.2194
 15/296 [>.............................] - ETA: 1s - loss: 0.1589 - mean_absolute_error: 0.2363
 33/296 [==>...........................] - ETA: 0s - loss: 0.1581 - mean_absolute_error: 0.2376
 51/296 [====>.........................] - ETA: 0s - loss: 0.1557 - mean_absolute_error: 0.2377
 71/296 [======>.......................] - ETA: 0s - loss: 0.1535 - mean_absolute_error: 0.2340
 89/296 [========>.....................] - ETA: 0s - loss: 0.1535 - mean_absolute_error: 0.2331
118/296 [==========>...................] - ETA: 0s - loss: 0.1563 - mean_absolute_error: 0.2357
142/296 [=============>................] - ETA: 0s - loss: 0.1552 - mean_absolute_error: 0.2348
157/296 [==============>...............] - ETA: 0s - loss: 0.1547 - mean_absolute_error: 0.2345
170/296 [================>.............] - ETA: 0s - loss: 0.1539 - mean_absolute_error: 0.2338
191/296 [==================>...........] - ETA: 0s - loss: 0.1546 - mean_absolute_error: 0.2344
207/296 [===================>..........] - ETA: 0s - loss: 0.1543 - mean_absolute_error: 0.2345
225/296 [=====================>........] - ETA: 0s - loss: 0.1537 - mean_absolute_error: 0.2346
248/296 [========================>.....] - ETA: 0s - loss: 0.1539 - mean_absolute_error: 0.2354
271/296 [==========================>...] - ETA: 0s - loss: 0.1539 - mean_absolute_error: 0.2362
296/296 [==============================] - 1s 3ms/step - loss: 0.1539 - mean_absolute_error: 0.2363 - val_loss: 0.1207 - val_mean_absolute_error: 0.2063
Epoch 6/500

  1/296 [..............................] - ETA: 0s - loss: 0.2236 - mean_absolute_error: 0.2837
 22/296 [=>............................] - ETA: 0s - loss: 0.1439 - mean_absolute_error: 0.2300
 50/296 [====>.........................] - ETA: 0s - loss: 0.1425 - mean_absolute_error: 0.2270
 76/296 [======>.......................] - ETA: 0s - loss: 0.1457 - mean_absolute_error: 0.2313
104/296 [=========>....................] - ETA: 0s - loss: 0.1458 - mean_absolute_error: 0.2315
128/296 [===========>..................] - ETA: 0s - loss: 0.1456 - mean_absolute_error: 0.2321
152/296 [==============>...............] - ETA: 0s - loss: 0.1443 - mean_absolute_error: 0.2313
177/296 [================>.............] - ETA: 0s - loss: 0.1439 - mean_absolute_error: 0.2312
205/296 [===================>..........] - ETA: 0s - loss: 0.1426 - mean_absolute_error: 0.2301
230/296 [======================>.......] - ETA: 0s - loss: 0.1415 - mean_absolute_error: 0.2293
259/296 [=========================>....] - ETA: 0s - loss: 0.1410 - mean_absolute_error: 0.2293
281/296 [===========================>..] - ETA: 0s - loss: 0.1408 - mean_absolute_error: 0.2292
296/296 [==============================] - 1s 3ms/step - loss: 0.1410 - mean_absolute_error: 0.2289 - val_loss: 0.1052 - val_mean_absolute_error: 0.1904
Epoch 7/500

  1/296 [..............................] - ETA: 0s - loss: 0.1501 - mean_absolute_error: 0.2212
 22/296 [=>............................] - ETA: 0s - loss: 0.1303 - mean_absolute_error: 0.2224
 45/296 [===>..........................] - ETA: 0s - loss: 0.1364 - mean_absolute_error: 0.2259
 67/296 [=====>........................] - ETA: 0s - loss: 0.1361 - mean_absolute_error: 0.2256
 89/296 [========>.....................] - ETA: 0s - loss: 0.1351 - mean_absolute_error: 0.2252
114/296 [==========>...................] - ETA: 0s - loss: 0.1347 - mean_absolute_error: 0.2262
138/296 [============>.................] - ETA: 0s - loss: 0.1343 - mean_absolute_error: 0.2267
161/296 [===============>..............] - ETA: 0s - loss: 0.1338 - mean_absolute_error: 0.2258
183/296 [=================>............] - ETA: 0s - loss: 0.1333 - mean_absolute_error: 0.2254
209/296 [====================>.........] - ETA: 0s - loss: 0.1324 - mean_absolute_error: 0.2244
239/296 [=======================>......] - ETA: 0s - loss: 0.1315 - mean_absolute_error: 0.2238
268/296 [==========================>...] - ETA: 0s - loss: 0.1298 - mean_absolute_error: 0.2223
296/296 [==============================] - 1s 3ms/step - loss: 0.1298 - mean_absolute_error: 0.2222 - val_loss: 0.1015 - val_mean_absolute_error: 0.1959
Epoch 8/500

  1/296 [..............................] - ETA: 0s - loss: 0.1327 - mean_absolute_error: 0.2202
 18/296 [>.............................] - ETA: 0s - loss: 0.1279 - mean_absolute_error: 0.2210
 40/296 [===>..........................] - ETA: 0s - loss: 0.1287 - mean_absolute_error: 0.2251
 65/296 [=====>........................] - ETA: 0s - loss: 0.1335 - mean_absolute_error: 0.2316
 86/296 [=======>......................] - ETA: 0s - loss: 0.1307 - mean_absolute_error: 0.2273
104/296 [=========>....................] - ETA: 0s - loss: 0.1302 - mean_absolute_error: 0.2273
130/296 [============>.................] - ETA: 0s - loss: 0.1279 - mean_absolute_error: 0.2245
156/296 [==============>...............] - ETA: 0s - loss: 0.1262 - mean_absolute_error: 0.2221
179/296 [=================>............] - ETA: 0s - loss: 0.1259 - mean_absolute_error: 0.2213
200/296 [===================>..........] - ETA: 0s - loss: 0.1256 - mean_absolute_error: 0.2209
225/296 [=====================>........] - ETA: 0s - loss: 0.1245 - mean_absolute_error: 0.2200
243/296 [=======================>......] - ETA: 0s - loss: 0.1252 - mean_absolute_error: 0.2207
265/296 [=========================>....] - ETA: 0s - loss: 0.1245 - mean_absolute_error: 0.2205
285/296 [===========================>..] - ETA: 0s - loss: 0.1246 - mean_absolute_error: 0.2209
296/296 [==============================] - 1s 3ms/step - loss: 0.1244 - mean_absolute_error: 0.2210 - val_loss: 0.0935 - val_mean_absolute_error: 0.1848
Epoch 9/500

  1/296 [..............................] - ETA: 0s - loss: 0.1427 - mean_absolute_error: 0.2397
 20/296 [=>............................] - ETA: 0s - loss: 0.1180 - mean_absolute_error: 0.2184
 43/296 [===>..........................] - ETA: 0s - loss: 0.1200 - mean_absolute_error: 0.2183
 65/296 [=====>........................] - ETA: 0s - loss: 0.1168 - mean_absolute_error: 0.2155
 84/296 [=======>......................] - ETA: 0s - loss: 0.1176 - mean_absolute_error: 0.2157
109/296 [==========>...................] - ETA: 0s - loss: 0.1208 - mean_absolute_error: 0.2189
134/296 [============>.................] - ETA: 0s - loss: 0.1229 - mean_absolute_error: 0.2212
160/296 [===============>..............] - ETA: 0s - loss: 0.1208 - mean_absolute_error: 0.2190
180/296 [=================>............] - ETA: 0s - loss: 0.1200 - mean_absolute_error: 0.2185
200/296 [===================>..........] - ETA: 0s - loss: 0.1202 - mean_absolute_error: 0.2186
227/296 [======================>.......] - ETA: 0s - loss: 0.1202 - mean_absolute_error: 0.2189
250/296 [========================>.....] - ETA: 0s - loss: 0.1211 - mean_absolute_error: 0.2201
274/296 [==========================>...] - ETA: 0s - loss: 0.1199 - mean_absolute_error: 0.2190
296/296 [==============================] - 1s 3ms/step - loss: 0.1199 - mean_absolute_error: 0.2188 - val_loss: 0.0911 - val_mean_absolute_error: 0.1875
Epoch 10/500

  1/296 [..............................] - ETA: 0s - loss: 0.1171 - mean_absolute_error: 0.2260
 16/296 [>.............................] - ETA: 1s - loss: 0.1077 - mean_absolute_error: 0.2109
 33/296 [==>...........................] - ETA: 1s - loss: 0.1063 - mean_absolute_error: 0.2095
 57/296 [====>.........................] - ETA: 0s - loss: 0.1120 - mean_absolute_error: 0.2121
 77/296 [======>.......................] - ETA: 0s - loss: 0.1117 - mean_absolute_error: 0.2142
 94/296 [========>.....................] - ETA: 0s - loss: 0.1144 - mean_absolute_error: 0.2166
113/296 [==========>...................] - ETA: 0s - loss: 0.1149 - mean_absolute_error: 0.2169
140/296 [=============>................] - ETA: 0s - loss: 0.1168 - mean_absolute_error: 0.2189
166/296 [===============>..............] - ETA: 0s - loss: 0.1156 - mean_absolute_error: 0.2176
191/296 [==================>...........] - ETA: 0s - loss: 0.1162 - mean_absolute_error: 0.2188
209/296 [====================>.........] - ETA: 0s - loss: 0.1164 - mean_absolute_error: 0.2188
231/296 [======================>.......] - ETA: 0s - loss: 0.1164 - mean_absolute_error: 0.2185
253/296 [========================>.....] - ETA: 0s - loss: 0.1167 - mean_absolute_error: 0.2186
279/296 [===========================>..] - ETA: 0s - loss: 0.1174 - mean_absolute_error: 0.2192
296/296 [==============================] - 1s 3ms/step - loss: 0.1179 - mean_absolute_error: 0.2199 - val_loss: 0.0959 - val_mean_absolute_error: 0.2005
Epoch 11/500

  1/296 [..............................] - ETA: 0s - loss: 0.1651 - mean_absolute_error: 0.2421
 21/296 [=>............................] - ETA: 0s - loss: 0.1130 - mean_absolute_error: 0.2192
 48/296 [===>..........................] - ETA: 0s - loss: 0.1139 - mean_absolute_error: 0.2188
 74/296 [======>.......................] - ETA: 0s - loss: 0.1155 - mean_absolute_error: 0.2198
100/296 [=========>....................] - ETA: 0s - loss: 0.1143 - mean_absolute_error: 0.2181
124/296 [===========>..................] - ETA: 0s - loss: 0.1133 - mean_absolute_error: 0.2173
148/296 [==============>...............] - ETA: 0s - loss: 0.1131 - mean_absolute_error: 0.2167
169/296 [================>.............] - ETA: 0s - loss: 0.1135 - mean_absolute_error: 0.2167
190/296 [==================>...........] - ETA: 0s - loss: 0.1126 - mean_absolute_error: 0.2153
213/296 [====================>.........] - ETA: 0s - loss: 0.1126 - mean_absolute_error: 0.2152
237/296 [=======================>......] - ETA: 0s - loss: 0.1116 - mean_absolute_error: 0.2144
260/296 [=========================>....] - ETA: 0s - loss: 0.1116 - mean_absolute_error: 0.2141
286/296 [===========================>..] - ETA: 0s - loss: 0.1128 - mean_absolute_error: 0.2152
296/296 [==============================] - 1s 3ms/step - loss: 0.1126 - mean_absolute_error: 0.2152 - val_loss: 0.0861 - val_mean_absolute_error: 0.1848
Epoch 12/500

  1/296 [..............................] - ETA: 0s - loss: 0.0844 - mean_absolute_error: 0.1790
 22/296 [=>............................] - ETA: 0s - loss: 0.1109 - mean_absolute_error: 0.2085
 49/296 [===>..........................] - ETA: 0s - loss: 0.1085 - mean_absolute_error: 0.2093
 76/296 [======>.......................] - ETA: 0s - loss: 0.1088 - mean_absolute_error: 0.2113
103/296 [=========>....................] - ETA: 0s - loss: 0.1062 - mean_absolute_error: 0.2100
124/296 [===========>..................] - ETA: 0s - loss: 0.1064 - mean_absolute_error: 0.2109
142/296 [=============>................] - ETA: 0s - loss: 0.1070 - mean_absolute_error: 0.2115
169/296 [================>.............] - ETA: 0s - loss: 0.1077 - mean_absolute_error: 0.2119
197/296 [==================>...........] - ETA: 0s - loss: 0.1084 - mean_absolute_error: 0.2126
225/296 [=====================>........] - ETA: 0s - loss: 0.1091 - mean_absolute_error: 0.2131
249/296 [========================>.....] - ETA: 0s - loss: 0.1099 - mean_absolute_error: 0.2137
270/296 [==========================>...] - ETA: 0s - loss: 0.1107 - mean_absolute_error: 0.2148
295/296 [============================>.] - ETA: 0s - loss: 0.1109 - mean_absolute_error: 0.2149
296/296 [==============================] - 1s 3ms/step - loss: 0.1109 - mean_absolute_error: 0.2150 - val_loss: 0.0886 - val_mean_absolute_error: 0.1921
Epoch 13/500

  1/296 [..............................] - ETA: 0s - loss: 0.1040 - mean_absolute_error: 0.1999
 19/296 [>.............................] - ETA: 0s - loss: 0.1236 - mean_absolute_error: 0.2261
 41/296 [===>..........................] - ETA: 0s - loss: 0.1133 - mean_absolute_error: 0.2165
 61/296 [=====>........................] - ETA: 0s - loss: 0.1106 - mean_absolute_error: 0.2155
 82/296 [=======>......................] - ETA: 0s - loss: 0.1110 - mean_absolute_error: 0.2154
113/296 [==========>...................] - ETA: 0s - loss: 0.1095 - mean_absolute_error: 0.2148
142/296 [=============>................] - ETA: 0s - loss: 0.1100 - mean_absolute_error: 0.2154
164/296 [===============>..............] - ETA: 0s - loss: 0.1099 - mean_absolute_error: 0.2157
183/296 [=================>............] - ETA: 0s - loss: 0.1086 - mean_absolute_error: 0.2143
201/296 [===================>..........] - ETA: 0s - loss: 0.1091 
[2025-10-23 08:07:28] STDERR:
2025-10-23 08:06:08.585730: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-10-23 08:06:14.057851: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.


[2025-10-23 08:08:24] Received /run-data payload: {'years': ['2022', '2023', '2024']}
[2025-10-23 08:08:24] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:08:24] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:08:34] Script finished: data\data.py returncode=0
[2025-10-23 08:08:34] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:08:34] STDERR:
2025-10-23 08:08:34,138 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:08:34,140 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:08:34,140 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:08:34,201 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:08:34,201 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:08:34,280 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:08:34,344 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:08:34,512 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:08:34,514 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:08:55] Received /run-train payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:08:55] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-23 08:08:55] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:08:55] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:08:57] Script finished: data\data.py returncode=0
[2025-10-23 08:08:57] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:08:57] STDERR:
2025-10-23 08:08:57,191 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:08:57,191 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:08:57,191 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:08:57,207 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:08:57,207 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:08:57,238 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:08:57,295 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:08:57,447 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:08:57,447 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:08:57] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Pycaret\Pycaret_train.py
[2025-10-23 08:08:57] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:09:21] Script finished: train\Pycaret\Pycaret_train.py returncode=0
[2025-10-23 08:09:21] STDOUT:
PyCaret: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
PyCaret電力需要予測AIモデル学習システム
統一リファクタリング仕様 - PyCaretConfig対応版
============================================================
PyCaret PyCaret電力需要予測モデル学習 を開始します...
PyCaret データ読み込み を開始します...
学習データを読み込み中...
設定: 読み込んだ特徴量列を config.feature_columns に反映しました (4 列)
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
PyCaret データ読み込み が正常に完了しました
PyCaret PyCaret実験環境セットアップ を開始します...
PyCaretパラメータ {'silent': True} でエラー: setup() got an unexpected keyword argument 'silent'
PyCaretセットアップ成功: {'data':        MONTH  WEEK  HOUR       TEMP      KW
0        1.0   5.0   1.0   0.700000  3062.0
1        1.0   5.0   2.0   0.500000  2929.0
2        1.0   5.0   3.0   0.500000  2828.0
3        1.0   5.0   4.0   0.300000  2786.0
4        1.0   5.0   5.0  -0.200000  2828.0
...      ...   ...   ...        ...     ...
23666    9.0   4.0   3.0  27.400000  2827.0
23667    9.0   4.0   4.0  27.299999  2825.0
23668    9.0   4.0   5.0  26.900000  2908.0
23669    9.0   4.0   6.0  26.799999  3169.0
23670    9.0   4.0   7.0  28.100000  3716.0

[23671 rows x 5 columns], 'target': 'KW', 'session_id': 123, 'verbose': False}
PyCaret PyCaret実験環境セットアップ が正常に完了しました
PyCaret PyCaretモデル作成・学習 を開始します...
PyCaretモデル（lightgbm）を作成・学習中...
           MAE         MSE      RMSE      R2   RMSLE    MAPE
Fold                                                        
0     125.2144  31794.6683  178.3106  0.9405  0.0522  0.0382
1     120.9207  31976.6358  178.8201  0.9391  0.0540  0.0376
2     121.1220  31135.9836  176.4539  0.9391  0.0522  0.0372
3     125.2550  33426.7820  182.8299  0.9372  0.0543  0.0382
4     122.9873  32776.9684  181.0441  0.9338  0.0539  0.0379
5     130.9828  37629.9639  193.9844  0.9291  0.0572  0.0401
6     124.2342  35663.3741  188.8475  0.9321  0.0553  0.0384
7     125.3091  34730.6987  186.3617  0.9314  0.0548  0.0383
8     128.1099  35799.8223  189.2084  0.9314  0.0553  0.0391
9     121.5504  31386.3046  177.1618  0.9404  0.0530  0.0377
Mean  124.5686  33632.1202  183.3023  0.9354  0.0542  0.0383
Std     3.0336   2101.8860    5.6924  0.0041  0.0015  0.0008
メモリ最適化を実行しました
PyCaret PyCaretモデル作成・学習 が正常に完了しました
PyCaret PyCaretモデル保存 を開始します...
Transformation Pipeline and Model Successfully Saved
PyCaretモデルを train/Pycaret/Pycaret_model.pkl に保存しました
PyCaret PyCaretモデル保存 が正常に完了しました
PyCaret PyCaretモデル予測 を開始します...
予測が完了しました。予測値の形状: (2631,)
メモリ最適化を実行しました
PyCaret PyCaretモデル予測 が正常に完了しました
PyCaret モデル性能評価 を開始します...
PyCaretテストスコア: 0.919
最終結果 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
PyCaret モデル性能評価 が正常に完了しました
PyCaret 予測結果CSV保存 を開始します...
予測結果を train/Pycaret/Pycaret_Ypred.csv に保存しました
PyCaret 予測結果CSV保存 が正常に完了しました
PyCaret 予測結果グラフ作成 を開始します...
全期間グラフを train/Pycaret/Pycaret_Ypred.png に保存しました
1週間グラフを train/Pycaret/Pycaret_Ypred_7d.png に保存しました
メモリ最適化を実行しました
PyCaret 予測結果グラフ作成 が正常に完了しました
PyCaret PyCaret電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] PyCaret学習完了 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
============================================================

[2025-10-23 08:09:21] STDERR:

Processing:   0%|          | 0/4 [00:00<?, ?it/s]
Processing:  75%|███████▌  | 3/4 [00:06<00:02,  2.21s/it]
Processing: 100%|██████████| 4/4 [00:06<00:00,  1.53s/it]
                                                         

[2025-10-23 08:09:41] Received /run-train payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:09:41] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-23 08:09:41] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-23 08:09:41] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:09:43] Script finished: data\data.py returncode=0
[2025-10-23 08:09:43] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-23 08:09:43] STDERR:
2025-10-23 08:09:43,205 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-23 08:09:43,205 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-23 08:09:43,205 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-23 08:09:43,236 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-23 08:09:43,236 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-23 08:09:43,252 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-23 08:09:43,300 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-23 08:09:43,459 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-23 08:09:43,459 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-23 08:09:43] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\RandomForest\RandomForest_train.py
[2025-10-23 08:09:43] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:09:47] Script finished: train\RandomForest\RandomForest_train.py returncode=0
[2025-10-23 08:09:47] STDOUT:
RandomForest: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest電力需要予測AIモデル学習システム
統一リファクタリング仕様 - RandomForestConfig対応版
============================================================
RandomForest RandomForest電力需要予測モデル学習 を開始します...
RandomForest データ読み込み を開始します...
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
RandomForest データ読み込み が正常に完了しました
RandomForest データ標準化 を開始します...
メモリ最適化を実行しました
RandomForest データ標準化 が正常に完了しました
RandomForest RandomForestモデル作成 を開始します...
Random Forestモデルパラメータ: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'n_jobs': -1, 'random_state': 42}
RandomForest RandomForestモデル作成 が正常に完了しました
RandomForest RandomForestモデル学習 を開始します...
メモリ最適化を実行しました
RandomForest RandomForestモデル学習 が正常に完了しました
RandomForest モデル・スケーラー保存 を開始します...
Random Forestモデルを train/RandomForest/RandomForest_model.sav に保存しました
スケーラーを train/RandomForest/RandomForest_model_scaler.pkl に保存しました
RandomForest モデル・スケーラー保存 が正常に完了しました
RandomForest モデル性能評価 を開始します...
テストスコア: 0.908
最終結果 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
メモリ最適化を実行しました
RandomForest モデル性能評価 が正常に完了しました
RandomForest 予測結果CSV保存 を開始します...
予測結果を train/RandomForest/RandomForest_Ypred.csv に保存しました
RandomForest 予測結果CSV保存 が正常に完了しました
RandomForest 予測結果グラフ作成 を開始します...
全期間グラフを train/RandomForest/RandomForest_Ypred.png に保存しました
1週間グラフを train/RandomForest/RandomForest_Ypred_7d.png に保存しました
メモリ最適化を実行しました
RandomForest 予測結果グラフ作成 が正常に完了しました
RandomForest RandomForest電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] RandomForest学習完了 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
============================================================

[2025-10-23 08:10:43] Running tomorrow data.py and temp.py
[2025-10-23 08:10:43] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-23 08:10:43] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:10:44] Script finished: tomorrow\data.py returncode=0
[2025-10-23 08:10:44] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-23 00:00:00
開始日付: 2025-10-16 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.53秒) ===

[2025-10-23 08:10:44] STDERR:
2025-10-23 08:10:43,987 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-23 08:10:43,987 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-23 08:10:43,987 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 08:10:43,987 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 08:10:43,987 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 08:10:44,018 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-23 08:10:44,018 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 08:10:44,018 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 08:10:44,208 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 08:10:44,247 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 08:10:44,247 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 08:10:44,247 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 08:10:44,247 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 08:10:44,256 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-23 08:10:44,256 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 08:10:44,256 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 08:10:44,414 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 08:10:44,447 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 08:10:44,447 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-23 08:10:44,461 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-23 08:10:44,476 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-23 08:10:44,476 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-23 08:10:44,476 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-23 08:10:44,514 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.53秒)

[2025-10-23 08:10:44] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-23 08:10:44] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:10:46] Script finished: tomorrow\temp.py returncode=0
[2025-10-23 08:10:46] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.087秒
メモリ使用量変化: +4.4MB (開始: 59.9MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-23 08:10:46] STDERR:
2025-10-23 08:10:45,408 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-23 08:10:45,408 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-23 08:10:45,408 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-23 08:10:45,408 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-23 08:10:46,464 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.056秒)
2025-10-23 08:10:46,479 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-23 08:10:46,479 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-23 08:10:46,494 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-23 08:10:46,494 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.016秒)
2025-10-23 08:10:46,494 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.087秒)

[2025-10-23 08:10:49] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:10:49] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-23 08:10:49] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:11:09] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-23 08:11:09] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 301.0MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 11.83 GB
[データ読み込み開始] メモリ使用量: 11.83 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 11.84 GB
学習データの読み込みが完了しました (実行時間: 0.047秒)
[OK] load_training_data 実行時間: 0.190秒
[テスト・明日データ読み込み開始] メモリ使用量: 11.84 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 11.84 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.032秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.158秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 11.83 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 11.85 GB
モデル読み込み完了 (実行時間: 0.426秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 11.85 GB
[予測処理開始] メモリ使用量: 11.85 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 11.85 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 11.86 GB
予測処理完了 (実行時間: 0.842秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.846秒
[予測完了] メモリ使用量: 11.86 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.001秒)
最終結果 - RMSE: 791.918 kW, R2スコア: -2.4657, MAE: 740.641 kW
[CSV保存開始] メモリ使用量: 11.86 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 11.86 GB
明日の予測結果の保存が完了しました (実行時間: 0.010秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.122秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 11.83 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.4657
[OK] tomorrow 実行時間: 3.094秒
メモリ使用量変化: +58.9MB (開始: 301.0MB → 終了: 360.0MB)
=== 処理完了 ===
(簡略表示) RMSE: 791.918 kW, R2スコア: -2.4657
実行時間: 3.094秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-23 08:11:09] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-23 08:13:00] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:13:00] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-23 08:13:00] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:13:03] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-23 08:13:03] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.032秒
メモリ使用量: 115.4MB → 117.8MB (差分: +2.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.032秒
メモリ使用量: 117.8MB → 117.8MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.066秒
メモリ使用量: 117.8MB → 120.0MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9343
最終結果 - RMSE: 104.377 kW, R2: 0.9343, MAE: 77.914 kW
実行完了: 予測実行
実行時間: 0.047秒
メモリ使用量: 120.0MB → 120.2MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.035秒
メモリ使用量: 120.2MB → 120.4MB (差分: +0.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.679秒
メモリ使用量: 120.4MB → 139.9MB (差分: +19.5MB)
ガベージコレクション: 4220個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 0.911秒
メモリ使用量: 115.4MB → 139.9MB (差分: +24.5MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 104.38 kW, スコア: 0.96
総実行時間: 0.911秒
============================================================

[2025-10-23 08:14:42] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:14:42] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-23 08:14:42] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:14:48] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-23 08:14:48] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.055秒
メモリ使用量: 199.8MB → 200.5MB (差分: +0.7MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.121秒
メモリ使用量: 200.5MB → 202.6MB (差分: +2.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.144秒
メモリ使用量: 202.6MB → 203.0MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.063秒
メモリ使用量: 203.0MB → 203.2MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 107.078 kW, R2スコア: 0.9309, MAE: 79.988 kW
実行完了: 精度指標計算
実行時間: 0.054秒
メモリ使用量: 203.2MB → 203.2MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.541秒
メモリ使用量: 203.2MB → 218.1MB (差分: +14.9MB)
ガベージコレクション: 4047個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.104秒
メモリ使用量: 199.8MB → 218.1MB (差分: +18.3MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 107.08 kW, R2スコア: 0.931
総実行時間: 1.104秒
============================================================

[2025-10-23 08:15:08] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-23 08:15:09] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-23 08:15:09] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 08:15:12] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-23 08:15:12] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.047秒
メモリ使用量: 115.6MB → 118.5MB (差分: +2.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.016秒
メモリ使用量: 118.5MB → 118.7MB (差分: +0.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.330秒
メモリ使用量: 118.7MB → 306.2MB (差分: +187.5MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.943
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.063秒
メモリ使用量: 306.2MB → 306.7MB (差分: +0.5MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.031秒
メモリ使用量: 306.7MB → 306.7MB (差分: -0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 97.597 kW, R2スコア: 0.9426, MAE: 73.964 kW
実行完了: 精度指標計算
実行時間: 0.031秒
メモリ使用量: 306.7MB → 306.7MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.678秒
メモリ使用量: 306.7MB → 324.4MB (差分: +17.7MB)
ガベージコレクション: 4101個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.245秒
メモリ使用量: 115.6MB → 142.6MB (差分: +27.0MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 97.60 kW, R2スコア: 0.943
総実行時間: 1.245秒
============================================================

[2025-10-23 13:15:15] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-23 13:15:15] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-23 13:15:15] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 13:15:51] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-23 13:15:51] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.9MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.86 GB
[データ読み込み開始] メモリ使用量: 12.86 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.87 GB
学習データの読み込みが完了しました (実行時間: 0.119秒)
[OK] load_training_data 実行時間: 0.246秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.87 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.87 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.031秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.174秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.86 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.87 GB
モデル読み込み完了 (実行時間: 0.534秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.87 GB
[予測処理開始] メモリ使用量: 12.87 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.87 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 12.89 GB
予測処理完了 (実行時間: 1.036秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 1.036秒
[予測完了] メモリ使用量: 12.89 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 791.918 kW, R2スコア: -2.4657, MAE: 740.641 kW
[CSV保存開始] メモリ使用量: 12.89 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.89 GB
明日の予測結果の保存が完了しました (実行時間: 0.019秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.147秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.94 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.4657
[OK] tomorrow 実行時間: 4.316秒
メモリ使用量変化: +59.1MB (開始: 300.9MB → 終了: 360.0MB)
=== 処理完了 ===
(簡略表示) RMSE: 791.918 kW, R2スコア: -2.4657
実行時間: 4.316秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-23 13:15:51] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-23 13:17:15] Running tomorrow data.py and temp.py
[2025-10-23 13:17:15] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-23 13:17:15] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 13:17:17] Script finished: tomorrow\data.py returncode=0
[2025-10-23 13:17:17] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-23 00:00:00
開始日付: 2025-10-16 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.60秒) ===

[2025-10-23 13:17:17] STDERR:
2025-10-23 13:17:16,508 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-23 13:17:16,508 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-23 13:17:16,508 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 13:17:16,508 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 13:17:16,508 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 13:17:16,540 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-23 13:17:16,540 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 13:17:16,540 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 13:17:16,776 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-23 13:17:16,802 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 13:17:16,802 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 13:17:16,802 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-23 13:17:16,802 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-23 13:17:16,823 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-23 13:17:16,823 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-23 13:17:16,823 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-23 13:17:17,017 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-23 13:17:17,049 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-23 13:17:17,049 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-23 13:17:17,065 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-23 13:17:17,080 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-23 13:17:17,084 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-23 13:17:17,097 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-23 13:17:17,110 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.60秒)

[2025-10-23 13:17:17] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-23 13:17:17] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-23 13:17:19] Script finished: tomorrow\temp.py returncode=0
[2025-10-23 13:17:19] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.304秒
メモリ使用量変化: +4.4MB (開始: 59.9MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-23 13:17:19] STDERR:
2025-10-23 13:17:18,023 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-23 13:17:18,023 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-23 13:17:18,023 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-23 13:17:18,023 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-23 13:17:19,303 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.280秒)
2025-10-23 13:17:19,321 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-23 13:17:19,321 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-23 13:17:19,327 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-23 13:17:19,327 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.006秒)
2025-10-23 13:17:19,327 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.304秒)

[2025-10-24 08:08:16] Running tomorrow data.py and temp.py
[2025-10-24 08:08:16] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 08:08:16] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:08:22] Script finished: tomorrow\data.py returncode=0
[2025-10-24 08:08:22] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.69秒) ===

[2025-10-24 08:08:22] STDERR:
2025-10-24 08:08:21,428 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 08:08:21,428 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 08:08:21,428 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:08:21,428 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:08:21,428 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:08:21,474 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,080行)
2025-10-24 08:08:21,474 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:08:21,474 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:08:21,756 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:08:21,803 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:08:21,803 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:08:21,803 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:08:21,803 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:08:21,819 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:08:21,819 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:08:21,819 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:08:21,992 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:08:22,044 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:08:22,045 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 08:08:22,086 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 08:08:22,101 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 08:08:22,101 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 08:08:22,101 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 08:08:22,117 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.69秒)

[2025-10-24 08:08:22] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 08:08:22] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:08:24] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 08:08:24] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.243秒
メモリ使用量変化: +4.5MB (開始: 59.6MB → 終了: 64.2MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 08:08:24] STDERR:
2025-10-24 08:08:23,346 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.6MB
2025-10-24 08:08:23,346 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 08:08:23,346 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 08:08:23,346 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 08:08:24,555 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.208秒)
2025-10-24 08:08:24,580 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 08:08:24,581 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 08:08:24,588 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 08:08:24,588 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.007秒)
2025-10-24 08:08:24,589 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.242秒)

[2025-10-24 08:08:36] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:08:36] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 08:08:36] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:09:10] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 08:09:10] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 301.0MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.79 GB
[データ読み込み開始] メモリ使用量: 12.79 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.81 GB
学習データの読み込みが完了しました (実行時間: 0.086秒)
[OK] load_training_data 実行時間: 0.189秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.81 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.81 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.049秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.158秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.80 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.80 GB
モデル読み込み完了 (実行時間: 0.604秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.80 GB
[予測処理開始] メモリ使用量: 12.80 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.80 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 12.82 GB
予測処理完了 (実行時間: 0.926秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.926秒
[予測完了] メモリ使用量: 12.82 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 798.878 kW, R2スコア: -2.5269, MAE: 739.873 kW
[CSV保存開始] メモリ使用量: 12.82 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.82 GB
明日の予測結果の保存が完了しました (実行時間: 0.016秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.150秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.83 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.5269
[OK] tomorrow 実行時間: 4.410秒
メモリ使用量変化: +59.8MB (開始: 301.0MB → 終了: 360.8MB)
=== 処理完了 ===
(簡略表示) RMSE: 798.878 kW, R2スコア: -2.5269
実行時間: 4.410秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 08:09:10] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 08:09:21] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:09:21] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 08:09:21] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:09:24] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 08:09:24] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.053秒
メモリ使用量: 116.0MB → 119.1MB (差分: +3.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.042秒
メモリ使用量: 119.1MB → 119.1MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.178秒
メモリ使用量: 119.1MB → 120.6MB (差分: +1.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.053秒
メモリ使用量: 120.6MB → 120.8MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.040秒
メモリ使用量: 120.8MB → 120.9MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.737秒
メモリ使用量: 120.9MB → 140.4MB (差分: +19.5MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 1.133秒
メモリ使用量: 116.0MB → 138.2MB (差分: +22.2MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 1.133秒
============================================================

[2025-10-24 08:09:35] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:09:35] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 08:09:35] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:09:50] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 08:09:50] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.092秒
メモリ使用量: 200.4MB → 201.0MB (差分: +0.6MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.130秒
メモリ使用量: 201.0MB → 202.9MB (差分: +1.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.202秒
メモリ使用量: 202.9MB → 203.3MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.080秒
メモリ使用量: 203.3MB → 203.5MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.078秒
メモリ使用量: 203.5MB → 203.5MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.794秒
メモリ使用量: 203.5MB → 219.9MB (差分: +16.4MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.688秒
メモリ使用量: 200.4MB → 219.9MB (差分: +19.5MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.689秒
============================================================

[2025-10-24 08:09:59] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:09:59] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 08:09:59] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:10:03] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-24 08:10:03] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.047秒
メモリ使用量: 116.1MB → 118.3MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.043秒
メモリ使用量: 118.3MB → 118.4MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.504秒
メモリ使用量: 118.4MB → 306.0MB (差分: +187.6MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.934
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.102秒
メモリ使用量: 306.0MB → 306.7MB (差分: +0.7MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.047秒
メモリ使用量: 306.7MB → 306.8MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 103.417 kW, R2スコア: 0.9338, MAE: 80.473 kW
実行完了: 精度指標計算
実行時間: 0.052秒
メモリ使用量: 306.8MB → 306.8MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.788秒
メモリ使用量: 306.8MB → 326.0MB (差分: +19.2MB)
ガベージコレクション: 4216個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.643秒
メモリ使用量: 116.1MB → 144.2MB (差分: +28.1MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 103.42 kW, R2スコア: 0.934
総実行時間: 1.643秒
============================================================

[2025-10-24 08:24:50] Running tomorrow data.py and temp.py
[2025-10-24 08:24:50] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 08:24:50] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:24:55] Script finished: tomorrow\data.py returncode=0
[2025-10-24 08:24:55] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.71秒) ===

[2025-10-24 08:24:55] STDERR:
2025-10-24 08:24:55,137 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 08:24:55,137 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 08:24:55,137 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:24:55,137 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:24:55,137 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:24:55,174 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:24:55,174 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:24:55,174 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:24:55,495 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:24:55,520 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:24:55,520 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:24:55,520 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:24:55,520 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:24:55,541 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:24:55,542 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:24:55,542 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:24:55,748 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:24:55,764 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:24:55,764 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 08:24:55,794 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 08:24:55,801 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 08:24:55,801 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 08:24:55,824 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 08:24:55,844 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.71秒)

[2025-10-24 08:24:55] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 08:24:55] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:24:58] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 08:24:58] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.267秒
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 08:24:58] STDERR:
2025-10-24 08:24:57,000 - __main__ - WARNING - <module>:62 - psutil未インストール - メモリ監視機能は無効です
2025-10-24 08:24:57,001 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 08:24:57,001 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 08:24:57,001 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 08:24:58,222 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.221秒)
2025-10-24 08:24:58,261 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 08:24:58,261 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 08:24:58,268 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 08:24:58,268 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.006秒)
2025-10-24 08:24:58,268 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.267秒)

[2025-10-24 08:25:02] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:25:02] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 08:25:02] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:25:19] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 08:25:19] STDOUT:
警告: psutilが利用できません。メモリ監視機能を無効化します。
Keras Tomorrow: パフォーマンス最適化設定を適用しました
警告: TensorFlowが利用できません。互換性モードで実行します。
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ監視無効
[データ読み込み開始] メモリ監視無効
訓練データを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ監視無効
学習データの読み込みが完了しました (実行時間: 0.079秒)
[OK] load_training_data 実行時間: 0.140秒
[テスト・明日データ読み込み開始] メモリ監視無効
テストラベルを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ監視無効
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.035秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.096秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ監視無効
モデルディレクトリ: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
⚠️ SAVファイル読み込み失敗（手法2）: No module named 'keras'
[WARN] 警告: 実際のモデルを読み込めませんでした。ダミーモデルで代替します。
[OK] ダミーモデル作成完了（手法3）
[モデル読み込み完了] メモリ監視無効
モデル読み込み完了 (実行時間: 0.042秒)
モデルタイプ: <class '__main__.load_model_and_scaler.<locals>.DummyModel'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ監視無効
[予測処理開始] メモリ監視無効
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ監視無効
テストデータ予測実行中...
[WARN] テストデータ予測でエラー: load_model_and_scaler.<locals>.DummyModel.predict() got an unexpected keyword argument 'verbose'
フォールバック予測を使用します
翌日データ予測実行中...
[WARN] 翌日データ予測でエラー: load_model_and_scaler.<locals>.DummyModel.predict() got an unexpected keyword argument 'verbose'
フォールバック予測を使用します
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 5000-5000kW, 翌日予測 5000-5000kW
[予測処理完了] メモリ監視無効
予測処理完了 (実行時間: 0.050秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.050秒
[予測完了] メモリ監視無効
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.002秒)
最終結果 - RMSE: 2318.452 kW, R2スコア: -inf, MAE: 2283.363 kW
[CSV保存開始] メモリ監視無効
明日の予測結果を保存しています: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ監視無効
明日の予測結果の保存が完了しました (実行時間: 0.004秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.056秒
予測結果のグラフを作成しています: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ監視無効
明日の電力需要予測が完了しました: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -inf
[OK] tomorrow 実行時間: 2.874秒
=== 処理完了 ===
(簡略表示) RMSE: 2318.452 kW, R2スコア: -inf
実行時間: 2.874秒
出力ファイル: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 08:25:19] STDERR:
C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py:526: RuntimeWarning: divide by zero encountered in scalar divide
  r2_score = 1 - (ss_res / ss_tot)

[2025-10-24 08:26:55] Received /run-data payload: {'years': ['2022', '2023', '2024']}
[2025-10-24 08:26:55] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 08:26:55] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:26:58] Script finished: data\data.py returncode=0
[2025-10-24 08:26:58] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 08:26:58] STDERR:
2025-10-24 08:26:57,514 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 08:26:57,516 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 08:26:57,517 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 08:26:57,585 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 08:26:57,585 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 08:26:57,654 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 08:26:57,749 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 08:26:57,937 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 08:26:57,938 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 08:27:00] Received /run-train payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:27:00] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 08:27:00] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 08:27:00] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:27:03] Script finished: data\data.py returncode=0
[2025-10-24 08:27:03] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 08:27:03] STDERR:
2025-10-24 08:27:03,145 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 08:27:03,146 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 08:27:03,146 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 08:27:03,176 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 08:27:03,177 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 08:27:03,210 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 08:27:03,304 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 08:27:03,470 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 08:27:03,472 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 08:27:03] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_train.py
[2025-10-24 08:27:03] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:27:12] Script finished: train\LightGBM\LightGBM_train.py returncode=0
[2025-10-24 08:27:12] STDOUT:
=== LightGBM統一最適化設定適用完了 ===
AI_TARGET_YEARS=2022,2023,2024
=== LightGBM学習開始 ===
=== LightGBM学習統合処理 開始 ===
=== LightGBM電力需要予測モデル学習開始 ===
=== 学習データ読み込み 開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
メモリ最適化: float32データ型使用、メモリ使用量約50%削減
=== 学習データ読み込み 完了 (実行時間: 0.09秒) ===
=== データ標準化処理 開始 ===
データの標準化を実行中...
データの標準化が完了しました（float32最適化済み）
=== データ標準化処理 完了 (実行時間: 0.00秒) ===
学習率を 0.1 に設定しました
=== LightGBMモデル構築 開始 ===
LightGBMモデルを構築中...
LightGBMモデル構築完了 - パラメータ: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'num_leaves': 31, 'min_child_samples': 20, 'subsample': 1.0, 'colsample_bytree': 1.0, 'random_state': 42, 'verbose': -1}
=== LightGBMモデル構築 完了 (実行時間: 0.00秒) ===
=== LightGBMモデル学習 開始 ===
LightGBMモデルの学習を開始します...
LightGBMモデルの学習が完了しました
=== LightGBMモデル学習 完了 (実行時間: 2.16秒) ===
=== モデル・スケーラー保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
LightGBMモデルを train/LightGBM/LightGBM_model.sav に保存しました
スケーラーを train/LightGBM/LightGBM_model_scaler.pkl に保存しました
=== モデル・スケーラー保存 完了 (実行時間: 0.06秒) ===
=== モデル性能評価 開始 ===
=== モデル性能評価開始 ===
モデル性能評価を実行中...
テストスコア: 0.9193
テスト損失: 27429.516, テストMAE: 107.717
RMSE: 165.619 kW
R2スコア: 0.9193
MAE: 107.717 kW
=== モデル性能評価完了 ===
=== モデル性能評価 完了 (実行時間: 0.01秒) ===
=== 予測結果CSV保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
予測結果を train/LightGBM/LightGBM_Ypred.csv に保存しました（2631行）
=== 予測結果CSV保存 完了 (実行時間: 0.06秒) ===
=== 予測結果可視化 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
全期間グラフを train/LightGBM/LightGBM_Ypred.png に保存しました（16:9統一フォーマット）
1週間グラフを train/LightGBM/LightGBM_Ypred_7d.png に保存しました（16:9統一フォーマット）
=== 予測結果可視化 完了 (実行時間: 2.59秒) ===
=== LightGBM電力需要予測モデル学習完了 ===
=== LightGBM学習統合処理 完了 (実行時間: 5.44秒) ===
=== LightGBM学習完了 (実行時間: 5.51秒) ===
最終結果 - RMSE: 165.619 kW, R2スコア: 0.9193, MAE: 107.717 kW

[2025-10-24 08:27:19] Running tomorrow data.py and temp.py
[2025-10-24 08:27:19] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 08:27:19] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:27:21] Script finished: tomorrow\data.py returncode=0
[2025-10-24 08:27:21] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.52秒) ===

[2025-10-24 08:27:21] STDERR:
2025-10-24 08:27:20,701 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 08:27:20,701 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 08:27:20,701 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:27:20,701 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:27:20,701 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:27:20,715 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:27:20,715 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:27:20,715 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:27:20,912 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:27:20,940 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:27:20,941 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:27:20,941 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:27:20,941 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:27:20,963 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:27:20,963 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:27:20,963 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:27:21,153 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:27:21,168 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:27:21,168 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 08:27:21,193 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 08:27:21,196 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 08:27:21,196 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 08:27:21,211 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 08:27:21,223 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.52秒)

[2025-10-24 08:27:21] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 08:27:21] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:27:23] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 08:27:23] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.228秒
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 08:27:23] STDERR:
2025-10-24 08:27:22,277 - __main__ - WARNING - <module>:62 - psutil未インストール - メモリ監視機能は無効です
2025-10-24 08:27:22,279 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 08:27:22,279 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 08:27:22,279 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 08:27:23,473 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.195秒)
2025-10-24 08:27:23,500 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 08:27:23,500 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 08:27:23,506 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 08:27:23,506 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.006秒)
2025-10-24 08:27:23,506 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.228秒)

[2025-10-24 08:27:27] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:27:27] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 08:27:27] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:27:30] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=1
[2025-10-24 08:27:30] STDERR:
Traceback (most recent call last):
  File "C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 20, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

[2025-10-24 08:27:50] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:27:50] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 08:27:50] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:27:50] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=1
[2025-10-24 08:27:50] STDERR:
Traceback (most recent call last):
  File "C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py", line 15, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

[2025-10-24 08:27:58] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:27:58] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 08:27:58] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:27:58] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=1
[2025-10-24 08:27:58] STDERR:
Traceback (most recent call last):
  File "C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py", line 16, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

[2025-10-24 08:28:42] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:28:42] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 08:28:42] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:28:46] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 08:28:46] STDOUT:
警告: psutilが利用できません。メモリ監視機能を無効化します。
Keras Tomorrow: パフォーマンス最適化設定を適用しました
警告: TensorFlowが利用できません。互換性モードで実行します。
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ監視無効
[データ読み込み開始] メモリ監視無効
訓練データを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ監視無効
学習データの読み込みが完了しました (実行時間: 0.019秒)
[OK] load_training_data 実行時間: 0.055秒
[テスト・明日データ読み込み開始] メモリ監視無効
テストラベルを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ監視無効
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.006秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.054秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ監視無効
モデルディレクトリ: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
⚠️ SAVファイル読み込み失敗（手法2）: No module named 'keras'
[WARN] 警告: 実際のモデルを読み込めませんでした。ダミーモデルで代替します。
[OK] ダミーモデル作成完了（手法3）
[モデル読み込み完了] メモリ監視無効
モデル読み込み完了 (実行時間: 0.002秒)
モデルタイプ: <class '__main__.load_model_and_scaler.<locals>.DummyModel'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ監視無効
[予測処理開始] メモリ監視無効
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ監視無効
テストデータ予測実行中...
[WARN] テストデータ予測でエラー: load_model_and_scaler.<locals>.DummyModel.predict() got an unexpected keyword argument 'verbose'
フォールバック予測を使用します
翌日データ予測実行中...
[WARN] 翌日データ予測でエラー: load_model_and_scaler.<locals>.DummyModel.predict() got an unexpected keyword argument 'verbose'
フォールバック予測を使用します
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 5000-5000kW, 翌日予測 5000-5000kW
[予測処理完了] メモリ監視無効
予測処理完了 (実行時間: 0.051秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.051秒
[予測完了] メモリ監視無効
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.003秒)
最終結果 - RMSE: 2318.452 kW, R2スコア: -inf, MAE: 2283.363 kW
[CSV保存開始] メモリ監視無効
明日の予測結果を保存しています: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ監視無効
明日の予測結果の保存が完了しました (実行時間: 0.005秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.064秒
予測結果のグラフを作成しています: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ監視無効
明日の電力需要予測が完了しました: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -inf
[OK] tomorrow 実行時間: 1.341秒
=== 処理完了 ===
(簡略表示) RMSE: 2318.452 kW, R2スコア: -inf
実行時間: 1.341秒
出力ファイル: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 08:28:46] STDERR:
C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py:526: RuntimeWarning: divide by zero encountered in scalar divide
  r2_score = 1 - (ss_res / ss_tot)

[2025-10-24 08:28:58] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:28:58] Executing script: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 08:28:58] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:29:02] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 08:29:02] STDOUT:
警告: psutilが利用できません。メモリ監視機能を無効化します。
Keras Tomorrow: パフォーマンス最適化設定を適用しました
警告: TensorFlowが利用できません。互換性モードで実行します。
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ監視無効
[データ読み込み開始] メモリ監視無効
訓練データを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ監視無効
学習データの読み込みが完了しました (実行時間: 0.021秒)
[OK] load_training_data 実行時間: 0.069秒
[テスト・明日データ読み込み開始] メモリ監視無効
テストラベルを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ監視無効
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.004秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.043秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ監視無効
モデルディレクトリ: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
⚠️ SAVファイル読み込み失敗（手法2）: No module named 'keras'
[WARN] 警告: 実際のモデルを読み込めませんでした。ダミーモデルで代替します。
[OK] ダミーモデル作成完了（手法3）
[モデル読み込み完了] メモリ監視無効
モデル読み込み完了 (実行時間: 0.002秒)
モデルタイプ: <class '__main__.load_model_and_scaler.<locals>.DummyModel'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ監視無効
[予測処理開始] メモリ監視無効
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ監視無効
テストデータ予測実行中...
[WARN] テストデータ予測でエラー: load_model_and_scaler.<locals>.DummyModel.predict() got an unexpected keyword argument 'verbose'
フォールバック予測を使用します
翌日データ予測実行中...
[WARN] 翌日データ予測でエラー: load_model_and_scaler.<locals>.DummyModel.predict() got an unexpected keyword argument 'verbose'
フォールバック予測を使用します
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 5000-5000kW, 翌日予測 5000-5000kW
[予測処理完了] メモリ監視無効
予測処理完了 (実行時間: 0.039秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.039秒
[予測完了] メモリ監視無効
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.001秒)
最終結果 - RMSE: 2318.452 kW, R2スコア: -inf, MAE: 2283.363 kW
[CSV保存開始] メモリ監視無効
明日の予測結果を保存しています: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ監視無効
明日の予測結果の保存が完了しました (実行時間: 0.004秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.045秒
予測結果のグラフを作成しています: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ監視無効
明日の電力需要予測が完了しました: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -inf
[OK] tomorrow 実行時間: 1.460秒
=== 処理完了 ===
(簡略表示) RMSE: 2318.452 kW, R2スコア: -inf
実行時間: 1.460秒
出力ファイル: C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 08:29:02] STDERR:
C:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py:526: RuntimeWarning: divide by zero encountered in scalar divide
  r2_score = 1 - (ss_res / ss_tot)

[2025-10-24 08:29:45] Running tomorrow data.py and temp.py
[2025-10-24 08:29:45] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 08:29:45] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:29:49] Script finished: tomorrow\data.py returncode=0
[2025-10-24 08:29:49] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.78秒) ===

[2025-10-24 08:29:49] STDERR:
2025-10-24 08:29:48,765 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 08:29:48,765 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 08:29:48,765 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:29:48,765 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:29:48,765 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:29:48,780 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:29:48,780 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:29:48,780 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:29:48,999 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:29:49,052 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:29:49,053 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:29:49,053 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:29:49,053 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:29:49,073 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:29:49,073 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:29:49,073 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:29:49,388 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:29:49,429 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:29:49,438 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 08:29:49,490 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 08:29:49,490 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 08:29:49,490 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 08:29:49,505 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 08:29:49,540 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.78秒)

[2025-10-24 08:29:49] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 08:29:49] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:29:51] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 08:29:51] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.049秒
メモリ使用量変化: +4.4MB (開始: 59.8MB → 終了: 64.2MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 08:29:51] STDERR:
2025-10-24 08:29:50,725 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.8MB
2025-10-24 08:29:50,725 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 08:29:50,725 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 08:29:50,725 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 08:29:51,752 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.027秒)
2025-10-24 08:29:51,773 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 08:29:51,773 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 08:29:51,773 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 08:29:51,773 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.000秒)
2025-10-24 08:29:51,773 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.049秒)

[2025-10-24 08:29:54] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:29:54] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 08:29:54] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:30:26] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 08:30:26] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.6MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 13.14 GB
[データ読み込み開始] メモリ使用量: 13.14 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 13.14 GB
学習データの読み込みが完了しました (実行時間: 0.031秒)
[OK] load_training_data 実行時間: 0.142秒
[テスト・明日データ読み込み開始] メモリ使用量: 13.14 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 13.14 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.157秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 13.14 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 13.16 GB
モデル読み込み完了 (実行時間: 0.472秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 13.16 GB
[予測処理開始] メモリ使用量: 13.16 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 13.16 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 13.18 GB
予測処理完了 (実行時間: 0.892秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.908秒
[予測完了] メモリ使用量: 13.18 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.015秒)
最終結果 - RMSE: 798.878 kW, R2スコア: -2.5269, MAE: 739.873 kW
[CSV保存開始] メモリ使用量: 13.18 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 13.18 GB
明日の予測結果の保存が完了しました (実行時間: 0.016秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.158秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 13.21 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.5269
[OK] tomorrow 実行時間: 4.144秒
メモリ使用量変化: +60.2MB (開始: 300.6MB → 終了: 360.8MB)
=== 処理完了 ===
(簡略表示) RMSE: 798.878 kW, R2スコア: -2.5269
実行時間: 4.160秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 08:30:26] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 08:31:16] Running tomorrow data.py and temp.py
[2025-10-24 08:31:16] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 08:31:16] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:31:18] Script finished: tomorrow\data.py returncode=0
[2025-10-24 08:31:18] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.60秒) ===

[2025-10-24 08:31:18] STDERR:
2025-10-24 08:31:17,502 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 08:31:17,502 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 08:31:17,502 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:31:17,502 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:31:17,502 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:31:17,517 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:31:17,517 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:31:17,517 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:31:17,723 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:31:17,755 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:31:17,755 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:31:17,755 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:31:17,755 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:31:17,771 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:31:17,771 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:31:17,771 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:31:18,010 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:31:18,026 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:31:18,026 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 08:31:18,057 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 08:31:18,057 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 08:31:18,057 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 08:31:18,073 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 08:31:18,104 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.60秒)

[2025-10-24 08:31:18] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 08:31:18] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:31:20] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 08:31:20] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.059秒
メモリ使用量変化: +4.5MB (開始: 59.7MB → 終了: 64.2MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 08:31:20] STDERR:
2025-10-24 08:31:19,139 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.7MB
2025-10-24 08:31:19,139 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 08:31:19,139 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 08:31:19,139 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 08:31:20,175 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.036秒)
2025-10-24 08:31:20,191 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 08:31:20,192 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 08:31:20,194 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 08:31:20,198 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.003秒)
2025-10-24 08:31:20,198 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.059秒)

[2025-10-24 08:31:24] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:31:24] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 08:31:24] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:31:39] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 08:31:39] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 301.0MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 13.12 GB
[データ読み込み開始] メモリ使用量: 13.12 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 13.13 GB
学習データの読み込みが完了しました (実行時間: 0.063秒)
[OK] load_training_data 実行時間: 0.174秒
[テスト・明日データ読み込み開始] メモリ使用量: 13.13 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 13.13 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.015秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.125秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 13.13 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 13.13 GB
モデル読み込み完了 (実行時間: 0.364秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 13.13 GB
[予測処理開始] メモリ使用量: 13.13 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 13.13 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 13.15 GB
予測処理完了 (実行時間: 0.667秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.682秒
[予測完了] メモリ使用量: 13.15 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 798.878 kW, R2スコア: -2.5269, MAE: 739.873 kW
[CSV保存開始] メモリ使用量: 13.15 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 13.15 GB
明日の予測結果の保存が完了しました (実行時間: 0.021秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.127秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 13.18 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.5269
[OK] tomorrow 実行時間: 3.464秒
メモリ使用量変化: +57.7MB (開始: 301.0MB → 終了: 358.7MB)
=== 処理完了 ===
(簡略表示) RMSE: 798.878 kW, R2スコア: -2.5269
実行時間: 3.464秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 08:31:39] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 08:31:54] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:31:54] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 08:31:54] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:31:57] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=1
[2025-10-24 08:31:57] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.051秒
メモリ使用量: 115.6MB → 117.9MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.048秒
メモリ使用量: 117.9MB → 117.9MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.174秒
メモリ使用量: 117.9MB → 119.3MB (差分: +1.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
エラー発生 in 予測実行: 'Booster' object has no attribute 'handle'
トレースバック:
Traceback (most recent call last):
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 94, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 154, in predict_with_model
    Ytomorrow = model.predict(Xtomorrow_scaled)
  File "C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\lightgbm\sklearn.py", line 803, in predict
    return self._Booster.predict(X, raw_score=raw_score, start_iteration=start_iteration, num_iteration=num_iteration,
  File "C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\lightgbm\basic.py", line 3532, in predict
    predictor = self._to_predictor(deepcopy(kwargs))
  File "C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\lightgbm\basic.py", line 3622, in _to_predictor
    predictor = _InnerPredictor(booster_handle=self.handle, pred_parameter=pred_parameter)
AttributeError: 'Booster' object has no attribute 'handle'

エラー発生 in LightGBM翌日予測メイン処理: cannot unpack non-iterable NoneType object
トレースバック:
Traceback (most recent call last):
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 94, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 273, in execute_tomorrow_prediction
    Ytomorrow, REG_RMSE, REG_SCORE, accuracy = predict_with_model(model, Xtomorrow_scaled, y_test)
TypeError: cannot unpack non-iterable NoneType object


[2025-10-24 08:31:57] STDERR:
Traceback (most recent call last):
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 299, in <module>
    rmse, score = execute_tomorrow_prediction(config)
TypeError: cannot unpack non-iterable NoneType object

[2025-10-24 08:32:18] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:32:18] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 08:32:18] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:32:32] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 08:32:32] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.069秒
メモリ使用量: 199.9MB → 200.5MB (差分: +0.6MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.148秒
メモリ使用量: 200.5MB → 202.5MB (差分: +1.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.199秒
メモリ使用量: 202.5MB → 202.9MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.084秒
メモリ使用量: 202.9MB → 203.0MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.058秒
メモリ使用量: 203.0MB → 203.0MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.973秒
メモリ使用量: 203.0MB → 218.1MB (差分: +15.0MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.766秒
メモリ使用量: 199.9MB → 218.1MB (差分: +18.2MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.766秒
============================================================

[2025-10-24 08:32:40] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:32:40] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 08:32:40] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:32:45] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-24 08:32:45] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.048秒
メモリ使用量: 115.8MB → 117.9MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.045秒
メモリ使用量: 117.9MB → 118.0MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.417秒
メモリ使用量: 118.0MB → 306.0MB (差分: +188.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.934
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.123秒
メモリ使用量: 306.0MB → 306.5MB (差分: +0.5MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.065秒
メモリ使用量: 306.5MB → 306.6MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 103.417 kW, R2スコア: 0.9338, MAE: 80.473 kW
実行完了: 精度指標計算
実行時間: 0.049秒
メモリ使用量: 306.6MB → 306.6MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.860秒
メモリ使用量: 306.6MB → 324.5MB (差分: +17.9MB)
ガベージコレクション: 4216個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.662秒
メモリ使用量: 115.8MB → 142.7MB (差分: +26.9MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 103.42 kW, R2スコア: 0.934
総実行時間: 1.662秒
============================================================

[2025-10-24 08:32:57] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:32:57] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 08:32:57] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:33:00] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=1
[2025-10-24 08:33:00] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.056秒
メモリ使用量: 115.6MB → 118.9MB (差分: +3.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.047秒
メモリ使用量: 118.9MB → 118.9MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.078秒
メモリ使用量: 118.9MB → 119.4MB (差分: +0.5MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
エラー発生 in 予測実行: 'Booster' object has no attribute 'handle'
トレースバック:
Traceback (most recent call last):
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 94, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 154, in predict_with_model
    Ytomorrow = model.predict(Xtomorrow_scaled)
  File "C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\lightgbm\sklearn.py", line 803, in predict
    return self._Booster.predict(X, raw_score=raw_score, start_iteration=start_iteration, num_iteration=num_iteration,
  File "C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\lightgbm\basic.py", line 3532, in predict
    predictor = self._to_predictor(deepcopy(kwargs))
  File "C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\lightgbm\basic.py", line 3622, in _to_predictor
    predictor = _InnerPredictor(booster_handle=self.handle, pred_parameter=pred_parameter)
AttributeError: 'Booster' object has no attribute 'handle'

エラー発生 in LightGBM翌日予測メイン処理: cannot unpack non-iterable NoneType object
トレースバック:
Traceback (most recent call last):
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 94, in wrapper
    result = func(*args, **kwargs)
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 273, in execute_tomorrow_prediction
    Ytomorrow, REG_RMSE, REG_SCORE, accuracy = predict_with_model(model, Xtomorrow_scaled, y_test)
TypeError: cannot unpack non-iterable NoneType object


[2025-10-24 08:33:00] STDERR:
Traceback (most recent call last):
  File "c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py", line 299, in <module>
    rmse, score = execute_tomorrow_prediction(config)
TypeError: cannot unpack non-iterable NoneType object

[2025-10-24 08:33:08] Received /run-train payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:33:08] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 08:33:08] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 08:33:08] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:33:11] Script finished: data\data.py returncode=0
[2025-10-24 08:33:11] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 08:33:11] STDERR:
2025-10-24 08:33:10,607 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 08:33:10,607 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 08:33:10,607 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 08:33:10,650 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 08:33:10,650 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 08:33:10,710 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 08:33:10,781 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 08:33:10,989 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 08:33:10,993 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 08:33:11] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_train.py
[2025-10-24 08:33:11] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:33:16] Script finished: train\LightGBM\LightGBM_train.py returncode=0
[2025-10-24 08:33:16] STDOUT:
=== LightGBM統一最適化設定適用完了 ===
AI_TARGET_YEARS=2022,2023,2024
=== LightGBM学習開始 ===
=== LightGBM学習統合処理 開始 ===
=== LightGBM電力需要予測モデル学習開始 ===
=== 学習データ読み込み 開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
メモリ最適化: float32データ型使用、メモリ使用量約50%削減
=== 学習データ読み込み 完了 (実行時間: 0.08秒) ===
=== データ標準化処理 開始 ===
データの標準化を実行中...
データの標準化が完了しました（float32最適化済み）
=== データ標準化処理 完了 (実行時間: 0.00秒) ===
学習率を 0.1 に設定しました
=== LightGBMモデル構築 開始 ===
LightGBMモデルを構築中...
LightGBMモデル構築完了 - パラメータ: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'num_leaves': 31, 'min_child_samples': 20, 'subsample': 1.0, 'colsample_bytree': 1.0, 'random_state': 42, 'verbose': -1}
=== LightGBMモデル構築 完了 (実行時間: 0.00秒) ===
=== LightGBMモデル学習 開始 ===
LightGBMモデルの学習を開始します...
LightGBMモデルの学習が完了しました
=== LightGBMモデル学習 完了 (実行時間: 0.22秒) ===
=== モデル・スケーラー保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
LightGBMモデルを train/LightGBM/LightGBM_model.sav に保存しました
スケーラーを train/LightGBM/LightGBM_model_scaler.pkl に保存しました
=== モデル・スケーラー保存 完了 (実行時間: 0.05秒) ===
=== モデル性能評価 開始 ===
=== モデル性能評価開始 ===
モデル性能評価を実行中...
テストスコア: 0.9193
テスト損失: 27429.516, テストMAE: 107.717
RMSE: 165.619 kW
R2スコア: 0.9193
MAE: 107.717 kW
=== モデル性能評価完了 ===
=== モデル性能評価 完了 (実行時間: 0.01秒) ===
=== 予測結果CSV保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
予測結果を train/LightGBM/LightGBM_Ypred.csv に保存しました（2631行）
=== 予測結果CSV保存 完了 (実行時間: 0.03秒) ===
=== 予測結果可視化 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
全期間グラフを train/LightGBM/LightGBM_Ypred.png に保存しました（16:9統一フォーマット）
1週間グラフを train/LightGBM/LightGBM_Ypred_7d.png に保存しました（16:9統一フォーマット）
=== 予測結果可視化 完了 (実行時間: 2.58秒) ===
=== LightGBM電力需要予測モデル学習完了 ===
=== LightGBM学習統合処理 完了 (実行時間: 3.29秒) ===
=== LightGBM学習完了 (実行時間: 3.32秒) ===
最終結果 - RMSE: 165.619 kW, R2スコア: 0.9193, MAE: 107.717 kW

[2025-10-24 08:33:28] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:33:28] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 08:33:28] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:33:31] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 08:33:31] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.061秒
メモリ使用量: 115.3MB → 118.3MB (差分: +2.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.065秒
メモリ使用量: 118.3MB → 118.4MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.079秒
メモリ使用量: 118.4MB → 119.9MB (差分: +1.5MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.046秒
メモリ使用量: 119.9MB → 120.1MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.047秒
メモリ使用量: 120.1MB → 120.2MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.803秒
メモリ使用量: 120.2MB → 138.1MB (差分: +17.9MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 1.133秒
メモリ使用量: 115.3MB → 138.1MB (差分: +22.8MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 1.133秒
============================================================

[2025-10-24 08:34:03] Received /run-data payload: {'years': ['2022', '2023', '2024']}
[2025-10-24 08:34:03] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 08:34:03] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:34:05] Script finished: data\data.py returncode=0
[2025-10-24 08:34:05] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 08:34:05] STDERR:
2025-10-24 08:34:05,385 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 08:34:05,385 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 08:34:05,385 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 08:34:05,416 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 08:34:05,416 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 08:34:05,448 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 08:34:05,510 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 08:34:05,725 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 08:34:05,725 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 08:34:11] Received /run-train payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:34:11] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 08:34:11] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 08:34:11] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:34:14] Script finished: data\data.py returncode=0
[2025-10-24 08:34:14] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 08:34:14] STDERR:
2025-10-24 08:34:13,761 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 08:34:13,761 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 08:34:13,761 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 08:34:13,776 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 08:34:13,792 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 08:34:13,824 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 08:34:13,887 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 08:34:14,070 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 08:34:14,070 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 08:34:14] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_train.py
[2025-10-24 08:34:14] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:35:58] Script finished: train\Keras\Keras_train.py returncode=0
[2025-10-24 08:35:58] STDOUT:
Keras: 統一パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
=== Keras学習開始 ===
環境変数指定による学習年: 2022,2023,2024
Keras電力需要予測モデルの学習を開始します...
=== 学習・テストデータ読み込み開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
=== 学習・テストデータ読み込み完了 ===
=== データ標準化開始 ===
データの標準化を実行中...
標準化完了: 特徴量数=4, 目的変数正規化適用
=== データ標準化完了 ===
=== Kerasモデル構築開始 ===
Kerasモデルを構築中... (入力次元: 4)
改善版v3アーキテクチャ: 128→128→64→32→1
過学習対策v3: Dropout=0.1, L2正則化=0.001, Batch=64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 hidden1 (Dense)             (None, 128)               640       
                                                                 
 dropout1 (Dropout)          (None, 128)               0         
                                                                 
 hidden2 (Dense)             (None, 128)               16512     
                                                                 
 dropout2 (Dropout)          (None, 128)               0         
                                                                 
 hidden3 (Dense)             (None, 64)                8256      
                                                                 
 hidden4 (Dense)             (None, 32)                2080      
                                                                 
 output (Dense)              (None, 1)                 33        
                                                                 
=================================================================
Total params: 27521 (107.50 KB)
Trainable params: 27521 (107.50 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Kerasモデル構築完了 (学習率: 0.001, Batch: 64)
=== Kerasモデル構築完了 ===
=== モデル学習開始 ===
モデル学習開始 (epochs: 500, batch_size: 64, patience: 20)
Epoch 1/500

  1/296 [..............................] - ETA: 8:58 - loss: 1.1270 - mean_absolute_error: 0.7487
 14/296 [>.............................] - ETA: 1s - loss: 0.8909 - mean_absolute_error: 0.6587  
 37/296 [==>...........................] - ETA: 0s - loss: 0.6993 - mean_absolute_error: 0.5443
 56/296 [====>.........................] - ETA: 0s - loss: 0.6139 - mean_absolute_error: 0.4903
 75/296 [======>.......................] - ETA: 0s - loss: 0.5589 - mean_absolute_error: 0.4550
 98/296 [========>.....................] - ETA: 0s - loss: 0.5193 - mean_absolute_error: 0.4298
122/296 [===========>..................] - ETA: 0s - loss: 0.4863 - mean_absolute_error: 0.4089
148/296 [==============>...............] - ETA: 0s - loss: 0.4615 - mean_absolute_error: 0.3939
171/296 [================>.............] - ETA: 0s - loss: 0.4444 - mean_absolute_error: 0.3830
193/296 [==================>...........] - ETA: 0s - loss: 0.4318 - mean_absolute_error: 0.3759
220/296 [=====================>........] - ETA: 0s - loss: 0.4180 - mean_absolute_error: 0.3683
244/296 [=======================>......] - ETA: 0s - loss: 0.4068 - mean_absolute_error: 0.3616
269/296 [==========================>...] - ETA: 0s - loss: 0.3963 - mean_absolute_error: 0.3557
289/296 [============================>.] - ETA: 0s - loss: 0.3891 - mean_absolute_error: 0.3518
296/296 [==============================] - 3s 4ms/step - loss: 0.3862 - mean_absolute_error: 0.3500 - val_loss: 0.2451 - val_mean_absolute_error: 0.2589
Epoch 2/500

  1/296 [..............................] - ETA: 0s - loss: 0.3809 - mean_absolute_error: 0.3472
 22/296 [=>............................] - ETA: 0s - loss: 0.2768 - mean_absolute_error: 0.2894
 49/296 [===>..........................] - ETA: 0s - loss: 0.2724 - mean_absolute_error: 0.2871
 70/296 [======>.......................] - ETA: 0s - loss: 0.2717 - mean_absolute_error: 0.2885
 90/296 [========>.....................] - ETA: 0s - loss: 0.2723 - mean_absolute_error: 0.2885
110/296 [==========>...................] - ETA: 0s - loss: 0.2706 - mean_absolute_error: 0.2895
133/296 [============>.................] - ETA: 0s - loss: 0.2681 - mean_absolute_error: 0.2892
154/296 [==============>...............] - ETA: 0s - loss: 0.2644 - mean_absolute_error: 0.2869
180/296 [=================>............] - ETA: 0s - loss: 0.2623 - mean_absolute_error: 0.2861
202/296 [===================>..........] - ETA: 0s - loss: 0.2582 - mean_absolute_error: 0.2837
219/296 [=====================>........] - ETA: 0s - loss: 0.2567 - mean_absolute_error: 0.2834
241/296 [=======================>......] - ETA: 0s - loss: 0.2542 - mean_absolute_error: 0.2821
266/296 [=========================>....] - ETA: 0s - loss: 0.2507 - mean_absolute_error: 0.2798
288/296 [============================>.] - ETA: 0s - loss: 0.2486 - mean_absolute_error: 0.2786
296/296 [==============================] - 1s 3ms/step - loss: 0.2479 - mean_absolute_error: 0.2783 - val_loss: 0.2020 - val_mean_absolute_error: 0.2486
Epoch 3/500

  1/296 [..............................] - ETA: 0s - loss: 0.2156 - mean_absolute_error: 0.2615
 19/296 [>.............................] - ETA: 0s - loss: 0.2222 - mean_absolute_error: 0.2662
 47/296 [===>..........................] - ETA: 0s - loss: 0.2185 - mean_absolute_error: 0.2652
 67/296 [=====>........................] - ETA: 0s - loss: 0.2134 - mean_absolute_error: 0.2612
 88/296 [=======>......................] - ETA: 0s - loss: 0.2101 - mean_absolute_error: 0.2584
112/296 [==========>...................] - ETA: 0s - loss: 0.2095 - mean_absolute_error: 0.2572
136/296 [============>.................] - ETA: 0s - loss: 0.2076 - mean_absolute_error: 0.2567
155/296 [==============>...............] - ETA: 0s - loss: 0.2063 - mean_absolute_error: 0.2561
173/296 [================>.............] - ETA: 0s - loss: 0.2057 - mean_absolute_error: 0.2563
195/296 [==================>...........] - ETA: 0s - loss: 0.2059 - mean_absolute_error: 0.2564
220/296 [=====================>........] - ETA: 0s - loss: 0.2049 - mean_absolute_error: 0.2562
240/296 [=======================>......] - ETA: 0s - loss: 0.2037 - mean_absolute_error: 0.2559
260/296 [=========================>....] - ETA: 0s - loss: 0.2024 - mean_absolute_error: 0.2551
282/296 [===========================>..] - ETA: 0s - loss: 0.2007 - mean_absolute_error: 0.2540
296/296 [==============================] - 1s 3ms/step - loss: 0.1997 - mean_absolute_error: 0.2536 - val_loss: 0.1524 - val_mean_absolute_error: 0.2145
Epoch 4/500

  1/296 [..............................] - ETA: 0s - loss: 0.1362 - mean_absolute_error: 0.1924
 18/296 [>.............................] - ETA: 0s - loss: 0.1719 - mean_absolute_error: 0.2393
 39/296 [==>...........................] - ETA: 0s - loss: 0.1696 - mean_absolute_error: 0.2359
 59/296 [====>.........................] - ETA: 0s - loss: 0.1740 - mean_absolute_error: 0.2403
 84/296 [=======>......................] - ETA: 0s - loss: 0.1744 - mean_absolute_error: 0.2417
103/296 [=========>....................] - ETA: 0s - loss: 0.1742 - mean_absolute_error: 0.2410
125/296 [===========>..................] - ETA: 0s - loss: 0.1755 - mean_absolute_error: 0.2429
149/296 [==============>...............] - ETA: 0s - loss: 0.1745 - mean_absolute_error: 0.2428
175/296 [================>.............] - ETA: 0s - loss: 0.1750 - mean_absolute_error: 0.2440
199/296 [===================>..........] - ETA: 0s - loss: 0.1742 - mean_absolute_error: 0.2441
221/296 [=====================>........] - ETA: 0s - loss: 0.1724 - mean_absolute_error: 0.2431
241/296 [=======================>......] - ETA: 0s - loss: 0.1726 - mean_absolute_error: 0.2437
262/296 [=========================>....] - ETA: 0s - loss: 0.1716 - mean_absolute_error: 0.2434
281/296 [===========================>..] - ETA: 0s - loss: 0.1704 - mean_absolute_error: 0.2424
296/296 [==============================] - 1s 3ms/step - loss: 0.1705 - mean_absolute_error: 0.2426 - val_loss: 0.1227 - val_mean_absolute_error: 0.1895
Epoch 5/500

  1/296 [..............................] - ETA: 0s - loss: 0.1512 - mean_absolute_error: 0.2194
 20/296 [=>............................] - ETA: 0s - loss: 0.1575 - mean_absolute_error: 0.2349
 44/296 [===>..........................] - ETA: 0s - loss: 0.1549 - mean_absolute_error: 0.2370
 68/296 [=====>........................] - ETA: 0s - loss: 0.1533 - mean_absolute_error: 0.2340
 87/296 [=======>......................] - ETA: 0s - loss: 0.1538 - mean_absolute_error: 0.2333
109/296 [==========>...................] - ETA: 0s - loss: 0.1549 - mean_absolute_error: 0.2341
130/296 [============>.................] - ETA: 0s - loss: 0.1557 - mean_absolute_error: 0.2350
151/296 [==============>...............] - ETA: 0s - loss: 0.1549 - mean_absolute_error: 0.2345
174/296 [================>.............] - ETA: 0s - loss: 0.1540 - mean_absolute_error: 0.2337
195/296 [==================>...........] - ETA: 0s - loss: 0.1548 - mean_absolute_error: 0.2347
218/296 [=====================>........] - ETA: 0s - loss: 0.1540 - mean_absolute_error: 0.2346
237/296 [=======================>......] - ETA: 0s - loss: 0.1537 - mean_absolute_error: 0.2348
259/296 [=========================>....] - ETA: 0s - loss: 0.1537 - mean_absolute_error: 0.2357
278/296 [===========================>..] - ETA: 0s - loss: 0.1533 - mean_absolute_error: 0.2358
296/296 [==============================] - 1s 3ms/step - loss: 0.1539 - mean_absolute_error: 0.2363 - val_loss: 0.1207 - val_mean_absolute_error: 0.2063
Epoch 6/500

  1/296 [..............................] - ETA: 0s - loss: 0.2236 - mean_absolute_error: 0.2837
 16/296 [>.............................] - ETA: 0s - loss: 0.1456 - mean_absolute_error: 0.2334
 38/296 [==>...........................] - ETA: 0s - loss: 0.1452 - mean_absolute_error: 0.2298
 62/296 [=====>........................] - ETA: 0s - loss: 0.1448 - mean_absolute_error: 0.2305
 81/296 [=======>......................] - ETA: 0s - loss: 0.1458 - mean_absolute_error: 0.2313
103/296 [=========>....................] - ETA: 0s - loss: 0.1450 - mean_absolute_error: 0.2308
118/296 [==========>...................] - ETA: 0s - loss: 0.1452 - mean_absolute_error: 0.2311
141/296 [=============>................] - ETA: 0s - loss: 0.1452 - mean_absolute_error: 0.2317
166/296 [===============>..............] - ETA: 0s - loss: 0.1440 - mean_absolute_error: 0.2316
188/296 [==================>...........] - ETA: 0s - loss: 0.1432 - mean_absolute_error: 0.2305
207/296 [===================>..........] - ETA: 0s - loss: 0.1427 - mean_absolute_error: 0.2300
226/296 [=====================>........] - ETA: 0s - loss: 0.1418 - mean_absolute_error: 0.2295
245/296 [=======================>......] - ETA: 0s - loss: 0.1413 - mean_absolute_error: 0.2292
264/296 [=========================>....] - ETA: 0s - loss: 0.1410 - mean_absolute_error: 0.2293
286/296 [===========================>..] - ETA: 0s - loss: 0.1408 - mean_absolute_error: 0.2292
296/296 [==============================] - 1s 3ms/step - loss: 0.1410 - mean_absolute_error: 0.2289 - val_loss: 0.1052 - val_mean_absolute_error: 0.1904
Epoch 7/500

  1/296 [..............................] - ETA: 0s - loss: 0.1501 - mean_absolute_error: 0.2212
 22/296 [=>............................] - ETA: 0s - loss: 0.1303 - mean_absolute_error: 0.2224
 46/296 [===>..........................] - ETA: 0s - loss: 0.1359 - mean_absolute_error: 0.2251
 65/296 [=====>........................] - ETA: 0s - loss: 0.1364 - mean_absolute_error: 0.2258
 84/296 [=======>......................] - ETA: 0s - loss: 0.1360 - mean_absolute_error: 0.2261
103/296 [=========>....................] - ETA: 0s - loss: 0.1344 - mean_absolute_error: 0.2249
123/296 [===========>..................] - ETA: 0s - loss: 0.1350 - mean_absolute_error: 0.2269
141/296 [=============>................] - ETA: 0s - loss: 0.1348 - mean_absolute_error: 0.2273
166/296 [===============>..............] - ETA: 0s - loss: 0.1338 - mean_absolute_error: 0.2259
183/296 [=================>............] - ETA: 0s - loss: 0.1333 - mean_absolute_error: 0.2254
203/296 [===================>..........] - ETA: 0s - loss: 0.1325 - mean_absolute_error: 0.2246
225/296 [=====================>........] - ETA: 0s - loss: 0.1311 - mean_absolute_error: 0.2231
245/296 [=======================>......] - ETA: 0s - loss: 0.1308 - mean_absolute_error: 0.2231
266/296 [=========================>....] - ETA: 0s - loss: 0.1299 - mean_absolute_error: 0.2223
289/296 [============================>.] - ETA: 0s - loss: 0.1294 - mean_absolute_error: 0.2217
296/296 [==============================] - 1s 3ms/step - loss: 0.1298 - mean_absolute_error: 0.2222 - val_loss: 0.1015 - val_mean_absolute_error: 0.1959
Epoch 8/500

  1/296 [..............................] - ETA: 4s - loss: 0.1327 - mean_absolute_error: 0.2202
 18/296 [>.............................] - ETA: 0s - loss: 0.1279 - mean_absolute_error: 0.2210
 41/296 [===>..........................] - ETA: 0s - loss: 0.1284 - mean_absolute_error: 0.2251
 62/296 [=====>........................] - ETA: 0s - loss: 0.1320 - mean_absolute_error: 0.2304
 82/296 [=======>......................] - ETA: 0s - loss: 0.1300 - mean_absolute_error: 0.2274
105/296 [=========>....................] - ETA: 0s - loss: 0.1304 - mean_absolute_error: 0.2274
120/296 [===========>..................] - ETA: 0s - loss: 0.1290 - mean_absolute_error: 0.2258
144/296 [=============>................] - ETA: 0s - loss: 0.1258 - mean_absolute_error: 0.2220
163/296 [===============>..............] - ETA: 0s - loss: 0.1272 - mean_absolute_error: 0.2228
187/296 [=================>............] - ETA: 0s - loss: 0.1263 - mean_absolute_error: 0.2215
214/296 [====================>.........] - ETA: 0s - loss: 0.1249 - mean_absolute_error: 0.2204
234/296 [======================>.......] - ETA: 0s - loss: 0.1249 - mean_absolute_error: 0.2204
249/296 [========================>.....] - ETA: 0s - loss: 0.1249 - mean_absolute_error: 0.2205
267/296 [==========================>...] - ETA: 0s - loss: 0.1245 - mean_absolute_error: 0.2207
288/296 [============================>.] - ETA: 0s - loss: 0.1246 - mean_absolute_error: 0.2209
296/296 [==============================] - 1s 3ms/step - loss: 0.1244 - mean_absolute_error: 0.2210 - val_loss: 0.0935 - val_mean_absolute_error: 0.1848
Epoch 9/500

  1/296 [..............................] - ETA: 0s - loss: 0.1427 - mean_absolute_error: 0.2397
 19/296 [>.............................] - ETA: 0s - loss: 0.1154 - mean_absolute_error: 0.2172
 39/296 [==>...........................] - ETA: 0s - loss: 0.1190 - mean_absolute_error: 0.2167
 61/296 [=====>........................] - ETA: 0s - loss: 0.1176 - mean_absolute_error: 0.2157
 81/296 [=======>......................] - ETA: 0s - loss: 0.1173 - mean_absolute_error: 0.2154
107/296 [=========>....................] - ETA: 0s - loss: 0.1204 - mean_absolute_error: 0.2186
131/296 [============>.................] - ETA: 0s - loss: 0.1229 - mean_absolute_error: 0.2211
145/296 [=============>................] - ETA: 0s - loss: 0.1217 - mean_absolute_error: 0.2197
164/296 [===============>..............] - ETA: 0s - loss: 0.1207 - mean_absolute_error: 0.2190
181/296 [=================>............] - ETA: 0s - loss: 0.1200 - mean_absolute_error: 0.2185
201/296 [===================>..........] - ETA: 0s - loss: 0.1201 - mean_absolute_error: 0.2186
226/296 [=====================>........] - ETA: 0s - loss: 0.1200 - mean_absolute_error: 0.2188
253/296 [========================>.....] - ETA: 0s - loss: 0.1208 - mean_absolute_error: 0.2200
272/296 [==========================>...] - ETA: 0s - loss: 0.1200 - mean_absolute_error: 0.2189
296/296 [==============================] - ETA: 0s - loss: 0.1199 - mean_absolute_error: 0.2188
296/296 [==============================] - 1s 3ms/step - loss: 0.1199 - mean_absolute_error: 0.2188 - val_loss: 0.0911 - val_mean_absolute_error: 0.1875
Epoch 10/500

  1/296 [..............................] - ETA: 0s - loss: 0.1171 - mean_absolute_error: 0.2260
 11/296 [>.............................] - ETA: 1s - loss: 0.1047 - mean_absolute_error: 0.2049
 22/296 [=>............................] - ETA: 1s - loss: 0.1035 - mean_absolute_error: 0.2075
 40/296 [===>..........................] - ETA: 1s - loss: 0.1076 - mean_absolute_error: 0.2086
 60/296 [=====>........................] - ETA: 0s - loss: 0.1111 - mean_absolute_error: 0.2120
 81/296 [=======>......................] - ETA: 0s - loss: 0.1113 - mean_absolute_error: 0.2141
107/296 [=========>....................] - ETA: 0s - loss: 0.1148 - mean_absolute_error: 0.2165
128/296 [===========>..................] - ETA: 0s - loss: 0.1163 - mean_absolute_error: 0.2185
149/296 [==============>...............] - ETA: 0s - loss: 0.1161 - mean_absolute_error: 0.2179
166/296 [===============>..............] - ETA: 0s - loss: 0.1156 - mean_absolute_error: 0.2176
189/296 [==================>...........] - ETA: 0s - loss: 0.1162 - mean_absolute_error: 0.2187
212/296 [====================>.........] - ETA: 0s - loss: 0.1165 - mean_absolute_error: 0.2190
231/296 [======================>.......] - ETA: 0s - loss: 0.1164 - mean_absolute_error: 0.2185
247/296 [========================>.....] - ETA: 0s - loss: 0.1166 - mean_absolute_error: 0.2185
265/296 [=========================>....] - ETA: 0s - loss: 0.1170 - mean_absolute_error: 0.2188
287/296 [============================>.] - ETA: 0s - loss: 0.1175 - mean_absolute_error: 0.2196
296/296 [==============================] - 1s 3ms/step - loss: 0.1179 - mean_absolute_error: 0.2199 - val_loss: 0.0959 - val_mean_absolute_error: 0.2005
Epoch 11/500

  1/296 [..............................] - ETA: 1s - loss: 0.1651 - mean_absolute_error: 0.2421
 21/296 [=>............................] - ETA: 0s - loss: 0.1130 - mean_absolute_error: 0.2192
 41/296 [===>..........................] - ETA: 0s - loss: 0.1121 - mean_absolute_error: 0.2169
 57/296 [====>.........................] - ETA: 0s - loss: 0.1139 - mean_absolute_error: 0.2186
 75/296 [======>.......................] - ETA: 0s - loss: 0.1155 - mean_absolute_error: 0.2201
 92/296 [========>.....................] - ETA: 0s - loss: 0.1133 - mean_absolute_error: 0.2177
112/296 [==========>...................] - ETA: 0s - loss: 0.1133 - mean_absolute_error: 0.2173
131/296 [============>.................] - ETA: 0s - loss: 0.1130 - mean_absolute_error: 0.2171
150/296 [==============>...............] - ETA: 0s - loss: 0.1132 - mean_absolute_error: 0.2167
168/296 [================>.............] - ETA: 0s - loss: 0.1135 - mean_absolute_error: 0.2167
187/296 [=================>............] - ETA: 0s - loss: 0.1128 - mean_absolute_error: 0.2156
207/296 [===================>..........] - ETA: 0s - loss: 0.1130 - mean_absolute_error: 0.2154
229/296 [======================>.......] - ETA: 0s - loss: 0.1121 - mean_absolute_error: 0.2148
247/296 [========================>.....] - ETA: 0s - loss: 0.1113 - mean_absolute_error: 0.2140
268/296 [==========================>...] - ETA: 0s - loss: 0.1122 - mean_absolute_error: 0.2146
290/296 [============================>.] - ETA: 0s - loss: 0.1127 - mean_absolute_error: 0.2152
296/296 [==============================] - 1s 3ms/step - loss: 0.1126 - mean_absolute_error: 0.2152 - val_loss: 0.0861 - val_mean_absolute_error: 0.1848
Epoch 12/500

  1/296 [..............................] - ETA: 0s - loss: 0.0844 - mean_absolute_error: 0.1790
 25/296 [=>............................] - ETA: 0s - loss: 0.1130 - mean_absolute_error: 0.2119
 50/296 [====>.........................] - ETA: 0s - loss: 0.1089 - mean_absolute_error: 0.2097
 73/296 [======>.......................] - ETA: 0s - loss: 0.1083 - mean_absolute_error: 0.2106
 97/296 [========>.....................] - ETA: 0s - loss: 0.1064 - mean_absolute_error: 0.2099
117/296 [==========>...................] - ETA: 0s - loss: 0.1065 - mean_absolute_error: 0.2107
139/296 [=============>................] 
[2025-10-24 08:35:58] STDERR:
2025-10-24 08:34:16.818797: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-10-24 08:34:24.767656: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.


[2025-10-24 08:36:38] Received /run-train payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:36:38] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 08:36:38] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 08:36:38] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:36:41] Script finished: data\data.py returncode=0
[2025-10-24 08:36:41] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 08:36:41] STDERR:
2025-10-24 08:36:40,609 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 08:36:40,609 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 08:36:40,609 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 08:36:40,641 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 08:36:40,641 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 08:36:40,699 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 08:36:40,778 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 08:36:40,959 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 08:36:40,964 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 08:36:41] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Pycaret\Pycaret_train.py
[2025-10-24 08:36:41] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:37:02] Script finished: train\Pycaret\Pycaret_train.py returncode=0
[2025-10-24 08:37:02] STDOUT:
PyCaret: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
PyCaret電力需要予測AIモデル学習システム
統一リファクタリング仕様 - PyCaretConfig対応版
============================================================
PyCaret PyCaret電力需要予測モデル学習 を開始します...
PyCaret データ読み込み を開始します...
学習データを読み込み中...
設定: 読み込んだ特徴量列を config.feature_columns に反映しました (4 列)
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
PyCaret データ読み込み が正常に完了しました
PyCaret PyCaret実験環境セットアップ を開始します...
PyCaretパラメータ {'silent': True} でエラー: setup() got an unexpected keyword argument 'silent'
PyCaretセットアップ成功: {'data':        MONTH  WEEK  HOUR       TEMP      KW
0        1.0   5.0   1.0   0.700000  3062.0
1        1.0   5.0   2.0   0.500000  2929.0
2        1.0   5.0   3.0   0.500000  2828.0
3        1.0   5.0   4.0   0.300000  2786.0
4        1.0   5.0   5.0  -0.200000  2828.0
...      ...   ...   ...        ...     ...
23666    9.0   4.0   3.0  27.400000  2827.0
23667    9.0   4.0   4.0  27.299999  2825.0
23668    9.0   4.0   5.0  26.900000  2908.0
23669    9.0   4.0   6.0  26.799999  3169.0
23670    9.0   4.0   7.0  28.100000  3716.0

[23671 rows x 5 columns], 'target': 'KW', 'session_id': 123, 'verbose': False}
PyCaret PyCaret実験環境セットアップ が正常に完了しました
PyCaret PyCaretモデル作成・学習 を開始します...
PyCaretモデル（lightgbm）を作成・学習中...
           MAE         MSE      RMSE      R2   RMSLE    MAPE
Fold                                                        
0     125.2144  31794.6683  178.3106  0.9405  0.0522  0.0382
1     120.9207  31976.6358  178.8201  0.9391  0.0540  0.0376
2     121.1220  31135.9836  176.4539  0.9391  0.0522  0.0372
3     125.2550  33426.7820  182.8299  0.9372  0.0543  0.0382
4     122.9873  32776.9684  181.0441  0.9338  0.0539  0.0379
5     130.9828  37629.9639  193.9844  0.9291  0.0572  0.0401
6     124.2342  35663.3741  188.8475  0.9321  0.0553  0.0384
7     125.3091  34730.6987  186.3617  0.9314  0.0548  0.0383
8     128.1099  35799.8223  189.2084  0.9314  0.0553  0.0391
9     121.5504  31386.3046  177.1618  0.9404  0.0530  0.0377
Mean  124.5686  33632.1202  183.3023  0.9354  0.0542  0.0383
Std     3.0336   2101.8860    5.6924  0.0041  0.0015  0.0008
メモリ最適化を実行しました
PyCaret PyCaretモデル作成・学習 が正常に完了しました
PyCaret PyCaretモデル保存 を開始します...
Transformation Pipeline and Model Successfully Saved
PyCaretモデルを train/Pycaret/Pycaret_model.pkl に保存しました
PyCaret PyCaretモデル保存 が正常に完了しました
PyCaret PyCaretモデル予測 を開始します...
予測が完了しました。予測値の形状: (2631,)
メモリ最適化を実行しました
PyCaret PyCaretモデル予測 が正常に完了しました
PyCaret モデル性能評価 を開始します...
PyCaretテストスコア: 0.919
最終結果 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
PyCaret モデル性能評価 が正常に完了しました
PyCaret 予測結果CSV保存 を開始します...
予測結果を train/Pycaret/Pycaret_Ypred.csv に保存しました
PyCaret 予測結果CSV保存 が正常に完了しました
PyCaret 予測結果グラフ作成 を開始します...
全期間グラフを train/Pycaret/Pycaret_Ypred.png に保存しました
1週間グラフを train/Pycaret/Pycaret_Ypred_7d.png に保存しました
メモリ最適化を実行しました
PyCaret 予測結果グラフ作成 が正常に完了しました
PyCaret PyCaret電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] PyCaret学習完了 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
============================================================

[2025-10-24 08:37:02] STDERR:

Processing:   0%|          | 0/4 [00:00<?, ?it/s]
Processing:  75%|███████▌  | 3/4 [00:10<00:03,  3.48s/it]
Processing: 100%|██████████| 4/4 [00:10<00:00,  2.41s/it]
                                                         

[2025-10-24 08:37:13] Received /run-train payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:37:13] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 08:37:13] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 08:37:13] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:37:15] Script finished: data\data.py returncode=0
[2025-10-24 08:37:15] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 08:37:15] STDERR:
2025-10-24 08:37:15,401 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 08:37:15,401 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 08:37:15,401 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 08:37:15,417 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 08:37:15,417 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 08:37:15,464 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 08:37:15,511 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 08:37:15,684 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 08:37:15,699 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 08:37:15] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\RandomForest\RandomForest_train.py
[2025-10-24 08:37:15] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:37:20] Script finished: train\RandomForest\RandomForest_train.py returncode=0
[2025-10-24 08:37:20] STDOUT:
RandomForest: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest電力需要予測AIモデル学習システム
統一リファクタリング仕様 - RandomForestConfig対応版
============================================================
RandomForest RandomForest電力需要予測モデル学習 を開始します...
RandomForest データ読み込み を開始します...
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
RandomForest データ読み込み が正常に完了しました
RandomForest データ標準化 を開始します...
メモリ最適化を実行しました
RandomForest データ標準化 が正常に完了しました
RandomForest RandomForestモデル作成 を開始します...
Random Forestモデルパラメータ: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'n_jobs': -1, 'random_state': 42}
RandomForest RandomForestモデル作成 が正常に完了しました
RandomForest RandomForestモデル学習 を開始します...
メモリ最適化を実行しました
RandomForest RandomForestモデル学習 が正常に完了しました
RandomForest モデル・スケーラー保存 を開始します...
Random Forestモデルを train/RandomForest/RandomForest_model.sav に保存しました
スケーラーを train/RandomForest/RandomForest_model_scaler.pkl に保存しました
RandomForest モデル・スケーラー保存 が正常に完了しました
RandomForest モデル性能評価 を開始します...
テストスコア: 0.908
最終結果 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
メモリ最適化を実行しました
RandomForest モデル性能評価 が正常に完了しました
RandomForest 予測結果CSV保存 を開始します...
予測結果を train/RandomForest/RandomForest_Ypred.csv に保存しました
RandomForest 予測結果CSV保存 が正常に完了しました
RandomForest 予測結果グラフ作成 を開始します...
全期間グラフを train/RandomForest/RandomForest_Ypred.png に保存しました
1週間グラフを train/RandomForest/RandomForest_Ypred_7d.png に保存しました
メモリ最適化を実行しました
RandomForest 予測結果グラフ作成 が正常に完了しました
RandomForest RandomForest電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] RandomForest学習完了 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
============================================================

[2025-10-24 08:37:51] Running tomorrow data.py and temp.py
[2025-10-24 08:37:51] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 08:37:51] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:37:53] Script finished: tomorrow\data.py returncode=0
[2025-10-24 08:37:53] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.67秒) ===

[2025-10-24 08:37:53] STDERR:
2025-10-24 08:37:52,644 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 08:37:52,644 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 08:37:52,644 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:37:52,644 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:37:52,644 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:37:52,644 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:37:52,644 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:37:52,644 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:37:52,927 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:37:52,958 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:37:52,958 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:37:52,958 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:37:52,958 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:37:52,979 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:37:52,979 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:37:52,979 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:37:53,219 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:37:53,250 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:37:53,250 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 08:37:53,285 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 08:37:53,285 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 08:37:53,285 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 08:37:53,298 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 08:37:53,315 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.67秒)

[2025-10-24 08:37:53] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 08:37:53] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:37:56] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 08:37:56] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.083秒
メモリ使用量変化: +4.3MB (開始: 59.9MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 08:37:56] STDERR:
2025-10-24 08:37:55,404 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-24 08:37:55,404 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 08:37:55,404 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 08:37:55,404 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 08:37:56,455 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.051秒)
2025-10-24 08:37:56,484 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 08:37:56,484 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 08:37:56,487 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 08:37:56,487 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.003秒)
2025-10-24 08:37:56,487 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.083秒)

[2025-10-24 08:38:00] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:38:00] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 08:38:00] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:38:19] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 08:38:19] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.8MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.97 GB
[データ読み込み開始] メモリ使用量: 12.97 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.97 GB
学習データの読み込みが完了しました (実行時間: 0.031秒)
[OK] load_training_data 実行時間: 0.159秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.97 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.97 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.015秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.125秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.97 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.98 GB
モデル読み込み完了 (実行時間: 0.458秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.98 GB
[予測処理開始] メモリ使用量: 12.98 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.98 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 13.00 GB
予測処理完了 (実行時間: 0.909秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.930秒
[予測完了] メモリ使用量: 13.00 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.002秒)
最終結果 - RMSE: 798.878 kW, R2スコア: -2.5269, MAE: 739.873 kW
[CSV保存開始] メモリ使用量: 13.00 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 13.00 GB
明日の予測結果の保存が完了しました (実行時間: 0.006秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.111秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 13.03 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.5269
[OK] tomorrow 実行時間: 3.950秒
メモリ使用量変化: +58.6MB (開始: 300.8MB → 終了: 359.4MB)
=== 処理完了 ===
(簡略表示) RMSE: 798.878 kW, R2スコア: -2.5269
実行時間: 3.950秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 08:38:19] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 08:38:23] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:38:23] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 08:38:23] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:38:26] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 08:38:26] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.048秒
メモリ使用量: 115.5MB → 118.4MB (差分: +2.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.032秒
メモリ使用量: 118.4MB → 118.5MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.064秒
メモリ使用量: 118.5MB → 120.2MB (差分: +1.8MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.033秒
メモリ使用量: 120.2MB → 120.4MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.047秒
メモリ使用量: 120.4MB → 120.6MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.884秒
メモリ使用量: 120.6MB → 138.2MB (差分: +17.6MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 1.139秒
メモリ使用量: 115.5MB → 138.2MB (差分: +22.7MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 1.139秒
============================================================

[2025-10-24 08:38:37] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:38:37] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 08:38:37] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:38:44] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 08:38:44] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.063秒
メモリ使用量: 200.1MB → 200.5MB (差分: +0.4MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.129秒
メモリ使用量: 200.5MB → 202.4MB (差分: +1.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.177秒
メモリ使用量: 202.4MB → 202.9MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.063秒
メモリ使用量: 202.9MB → 203.0MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.062秒
メモリ使用量: 203.0MB → 203.0MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.665秒
メモリ使用量: 203.0MB → 218.3MB (差分: +15.3MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.286秒
メモリ使用量: 200.1MB → 218.4MB (差分: +18.3MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.286秒
============================================================

[2025-10-24 08:38:57] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:38:57] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 08:38:57] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:39:01] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-24 08:39:01] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.063秒
メモリ使用量: 116.1MB → 118.2MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.036秒
メモリ使用量: 118.2MB → 118.3MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.329秒
メモリ使用量: 118.3MB → 305.8MB (差分: +187.5MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.934
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.079秒
メモリ使用量: 305.8MB → 306.4MB (差分: +0.6MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.047秒
メモリ使用量: 306.4MB → 306.5MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 103.417 kW, R2スコア: 0.9338, MAE: 80.473 kW
実行完了: 精度指標計算
実行時間: 0.038秒
メモリ使用量: 306.5MB → 306.5MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.742秒
メモリ使用量: 306.5MB → 324.4MB (差分: +17.8MB)
ガベージコレクション: 4216個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.393秒
メモリ使用量: 116.1MB → 142.8MB (差分: +26.7MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 103.42 kW, R2スコア: 0.934
総実行時間: 1.393秒
============================================================

[2025-10-24 08:49:50] Running tomorrow data.py and temp.py
[2025-10-24 08:49:50] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 08:49:50] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:49:55] Script finished: tomorrow\data.py returncode=0
[2025-10-24 08:49:55] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.75秒) ===

[2025-10-24 08:49:55] STDERR:
2025-10-24 08:49:54,572 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 08:49:54,572 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 08:49:54,572 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:49:54,572 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:49:54,572 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:49:54,603 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:49:54,603 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:49:54,603 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:49:54,940 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 08:49:54,968 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:49:54,968 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:49:54,968 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 08:49:54,968 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 08:49:54,999 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 08:49:54,999 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 08:49:54,999 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 08:49:55,210 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 08:49:55,241 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 08:49:55,241 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 08:49:55,282 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 08:49:55,292 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 08:49:55,292 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 08:49:55,305 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 08:49:55,327 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.75秒)

[2025-10-24 08:49:55] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 08:49:55] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:49:57] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 08:49:57] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.061秒
メモリ使用量変化: +4.4MB (開始: 59.9MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 08:49:57] STDERR:
2025-10-24 08:49:56,442 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-24 08:49:56,442 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 08:49:56,442 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 08:49:56,442 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 08:49:57,469 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.027秒)
2025-10-24 08:49:57,503 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 08:49:57,503 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 08:49:57,503 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 08:49:57,503 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.000秒)
2025-10-24 08:49:57,503 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.061秒)

[2025-10-24 08:50:01] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:50:01] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 08:50:01] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:50:13] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 08:50:13] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.080秒
メモリ使用量: 116.0MB → 119.1MB (差分: +3.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.063秒
メモリ使用量: 119.1MB → 119.1MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.189秒
メモリ使用量: 119.1MB → 120.5MB (差分: +1.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.055秒
メモリ使用量: 120.5MB → 120.7MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.045秒
メモリ使用量: 120.7MB → 120.9MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 1.532秒
メモリ使用量: 120.9MB → 138.4MB (差分: +17.5MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 2.009秒
メモリ使用量: 116.0MB → 138.4MB (差分: +22.4MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 2.009秒
============================================================

[2025-10-24 08:50:44] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:50:44] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 08:50:44] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:50:57] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 08:50:57] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.080秒
メモリ使用量: 200.2MB → 200.9MB (差分: +0.7MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.143秒
メモリ使用量: 200.9MB → 202.9MB (差分: +2.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.191秒
メモリ使用量: 202.9MB → 203.3MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.093秒
メモリ使用量: 203.3MB → 203.4MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.062秒
メモリ使用量: 203.4MB → 203.4MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.891秒
メモリ使用量: 203.4MB → 218.5MB (差分: +15.0MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.693秒
メモリ使用量: 200.2MB → 218.5MB (差分: +18.3MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.693秒
============================================================

[2025-10-24 08:51:29] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 08:51:29] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 08:51:29] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 08:51:33] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-24 08:51:33] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.060秒
メモリ使用量: 116.1MB → 118.3MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.043秒
メモリ使用量: 118.3MB → 118.4MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.437秒
メモリ使用量: 118.4MB → 306.1MB (差分: +187.7MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.934
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.102秒
メモリ使用量: 306.1MB → 306.8MB (差分: +0.6MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.054秒
メモリ使用量: 306.8MB → 306.7MB (差分: -0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 103.417 kW, R2スコア: 0.9338, MAE: 80.473 kW
実行完了: 精度指標計算
実行時間: 0.066秒
メモリ使用量: 306.7MB → 306.7MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.843秒
メモリ使用量: 306.7MB → 324.3MB (差分: +17.6MB)
ガベージコレクション: 4216個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.652秒
メモリ使用量: 116.1MB → 142.5MB (差分: +26.4MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 103.42 kW, R2スコア: 0.934
総実行時間: 1.652秒
============================================================

[2025-10-24 09:04:04] Running tomorrow data.py and temp.py
[2025-10-24 09:04:04] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 09:04:04] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:04:08] Script finished: tomorrow\data.py returncode=0
[2025-10-24 09:04:08] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.55秒) ===

[2025-10-24 09:04:08] STDERR:
2025-10-24 09:04:07,494 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 09:04:07,494 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 09:04:07,494 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:04:07,494 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:04:07,494 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:04:07,526 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:04:07,526 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:04:07,526 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:04:07,730 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:04:07,762 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:04:07,763 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:04:07,763 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:04:07,763 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:04:07,778 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:04:07,778 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:04:07,778 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:04:07,951 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:04:07,983 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:04:07,983 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 09:04:08,014 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 09:04:08,014 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 09:04:08,014 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 09:04:08,042 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 09:04:08,047 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.55秒)

[2025-10-24 09:04:08] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 09:04:08] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:04:10] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 09:04:10] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.092秒
メモリ使用量変化: +4.4MB (開始: 60.0MB → 終了: 64.4MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 09:04:10] STDERR:
2025-10-24 09:04:09,213 - __main__ - INFO - main:440 - 開始時メモリ使用量: 60.0MB
2025-10-24 09:04:09,213 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 09:04:09,213 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 09:04:09,213 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 09:04:10,260 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.047秒)
2025-10-24 09:04:10,292 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 09:04:10,292 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 09:04:10,292 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 09:04:10,292 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.000秒)
2025-10-24 09:04:10,292 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.079秒)

[2025-10-24 09:04:19] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:04:19] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 09:04:19] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:04:32] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-24 09:04:32] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.110秒
メモリ使用量: 115.8MB → 118.1MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.031秒
メモリ使用量: 118.1MB → 118.1MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 1.297秒
メモリ使用量: 118.1MB → 306.0MB (差分: +187.8MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.934
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.086秒
メモリ使用量: 306.0MB → 306.4MB (差分: +0.5MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.047秒
メモリ使用量: 306.4MB → 306.6MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 103.417 kW, R2スコア: 0.9338, MAE: 80.473 kW
実行完了: 精度指標計算
実行時間: 0.032秒
メモリ使用量: 306.6MB → 306.6MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 1.640秒
メモリ使用量: 306.6MB → 324.0MB (差分: +17.5MB)
ガベージコレクション: 4216個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 3.289秒
メモリ使用量: 115.8MB → 142.0MB (差分: +26.2MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 103.42 kW, R2スコア: 0.934
総実行時間: 3.289秒
============================================================

[2025-10-24 09:05:00] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:05:00] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 09:05:00] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:05:13] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 09:05:13] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.063秒
メモリ使用量: 200.2MB → 200.6MB (差分: +0.4MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.190秒
メモリ使用量: 200.6MB → 202.8MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.193秒
メモリ使用量: 202.8MB → 203.3MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.100秒
メモリ使用量: 203.3MB → 203.4MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.086秒
メモリ使用量: 203.4MB → 203.4MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.735秒
メモリ使用量: 203.4MB → 218.3MB (差分: +14.9MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.523秒
メモリ使用量: 200.2MB → 218.3MB (差分: +18.1MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.523秒
============================================================

[2025-10-24 09:05:31] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:05:31] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 09:05:31] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:05:35] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 09:05:35] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.047秒
メモリ使用量: 115.7MB → 118.0MB (差分: +2.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.048秒
メモリ使用量: 118.0MB → 118.1MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.085秒
メモリ使用量: 118.1MB → 120.1MB (差分: +2.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.042秒
メモリ使用量: 120.1MB → 120.4MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.037秒
メモリ使用量: 120.4MB → 120.5MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.674秒
メモリ使用量: 120.5MB → 138.3MB (差分: +17.8MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 0.964秒
メモリ使用量: 115.7MB → 138.4MB (差分: +22.7MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 0.964秒
============================================================

[2025-10-24 09:05:52] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:05:52] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 09:05:52] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:06:12] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 09:06:12] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.8MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 13.11 GB
[データ読み込み開始] メモリ使用量: 13.11 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 13.12 GB
学習データの読み込みが完了しました (実行時間: 0.072秒)
[OK] load_training_data 実行時間: 0.152秒
[テスト・明日データ読み込み開始] メモリ使用量: 13.12 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 13.12 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.111秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 13.12 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 13.13 GB
モデル読み込み完了 (実行時間: 0.486秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 13.13 GB
[予測処理開始] メモリ使用量: 13.13 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 13.13 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 13.15 GB
予測処理完了 (実行時間: 0.728秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.728秒
[予測完了] メモリ使用量: 13.15 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 798.878 kW, R2スコア: -2.5269, MAE: 739.873 kW
[CSV保存開始] メモリ使用量: 13.15 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 13.15 GB
明日の予測結果の保存が完了しました (実行時間: 0.016秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.110秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 13.18 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.5269
[OK] tomorrow 実行時間: 3.138秒
メモリ使用量変化: +58.4MB (開始: 300.8MB → 終了: 359.2MB)
=== 処理完了 ===
(簡略表示) RMSE: 798.878 kW, R2スコア: -2.5269
実行時間: 3.138秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 09:06:12] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 09:13:47] Running tomorrow data.py and temp.py
[2025-10-24 09:13:47] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 09:13:47] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:13:48] Script finished: tomorrow\data.py returncode=0
[2025-10-24 09:13:48] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.57秒) ===

[2025-10-24 09:13:48] STDERR:
2025-10-24 09:13:47,878 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 09:13:47,878 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 09:13:47,878 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:13:47,878 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:13:47,878 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:13:47,894 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:13:47,894 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:13:47,894 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:13:48,083 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:13:48,117 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:13:48,117 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:13:48,117 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:13:48,117 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:13:48,133 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:13:48,133 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:13:48,133 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:13:48,361 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:13:48,397 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:13:48,399 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 09:13:48,430 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 09:13:48,430 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 09:13:48,430 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 09:13:48,448 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 09:13:48,450 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.57秒)

[2025-10-24 09:13:48] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 09:13:48] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:13:50] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 09:13:50] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.078秒
メモリ使用量変化: +4.4MB (開始: 59.9MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 09:13:50] STDERR:
2025-10-24 09:13:49,283 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.9MB
2025-10-24 09:13:49,283 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 09:13:49,283 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 09:13:49,283 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 09:13:50,345 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.047秒)
2025-10-24 09:13:50,351 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 09:13:50,351 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 09:13:50,361 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 09:13:50,361 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.010秒)
2025-10-24 09:13:50,361 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.078秒)

[2025-10-24 09:13:56] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:13:56] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 09:13:56] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:13:59] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 09:13:59] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.031秒
メモリ使用量: 115.7MB → 118.0MB (差分: +2.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.047秒
メモリ使用量: 118.0MB → 118.5MB (差分: +0.5MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.066秒
メモリ使用量: 118.5MB → 120.3MB (差分: +1.8MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.030秒
メモリ使用量: 120.3MB → 120.5MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.049秒
メモリ使用量: 120.5MB → 120.6MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.649秒
メモリ使用量: 120.6MB → 138.2MB (差分: +17.6MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 0.904秒
メモリ使用量: 115.7MB → 138.3MB (差分: +22.6MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 0.904秒
============================================================

[2025-10-24 09:14:11] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:14:11] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 09:14:11] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:14:16] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 09:14:16] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.047秒
メモリ使用量: 200.2MB → 200.9MB (差分: +0.7MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.096秒
メモリ使用量: 200.9MB → 202.9MB (差分: +2.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.157秒
メモリ使用量: 202.9MB → 203.4MB (差分: +0.5MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.064秒
メモリ使用量: 203.4MB → 203.5MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.064秒
メモリ使用量: 203.5MB → 203.6MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.614秒
メモリ使用量: 203.6MB → 218.4MB (差分: +14.8MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.152秒
メモリ使用量: 200.2MB → 218.4MB (差分: +18.2MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.152秒
============================================================

[2025-10-24 09:14:25] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:14:25] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 09:14:25] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:14:29] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-24 09:14:29] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.046秒
メモリ使用量: 115.8MB → 118.0MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.031秒
メモリ使用量: 118.0MB → 118.1MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.284秒
メモリ使用量: 118.1MB → 306.0MB (差分: +187.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.934
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.097秒
メモリ使用量: 306.0MB → 306.8MB (差分: +0.8MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.042秒
メモリ使用量: 306.8MB → 306.9MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 103.417 kW, R2スコア: 0.9338, MAE: 80.473 kW
実行完了: 精度指標計算
実行時間: 0.022秒
メモリ使用量: 306.9MB → 306.9MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.679秒
メモリ使用量: 306.9MB → 324.1MB (差分: +17.2MB)
ガベージコレクション: 4216個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.238秒
メモリ使用量: 115.8MB → 142.3MB (差分: +26.5MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 103.42 kW, R2スコア: 0.934
総実行時間: 1.238秒
============================================================

[2025-10-24 09:14:39] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:14:39] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 09:14:39] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:14:50] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 09:14:50] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.5MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.45 GB
[データ読み込み開始] メモリ使用量: 12.45 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.45 GB
学習データの読み込みが完了しました (実行時間: 0.031秒)
[OK] load_training_data 実行時間: 0.111秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.45 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.45 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.000秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.094秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.45 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.47 GB
モデル読み込み完了 (実行時間: 0.236秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.47 GB
[予測処理開始] メモリ使用量: 12.47 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.47 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 12.45 GB
予測処理完了 (実行時間: 0.554秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.554秒
[予測完了] メモリ使用量: 12.45 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (2631, 1)
[WARN] 形状不一致を検出: ypred(168, 1) vs ytest(2631, 1)
[OK] ytestを調整: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 798.878 kW, R2スコア: -2.5269, MAE: 739.873 kW
[CSV保存開始] メモリ使用量: 12.45 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.45 GB
明日の予測結果の保存が完了しました (実行時間: 0.016秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.095秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.43 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -2.5269
[OK] tomorrow 実行時間: 2.513秒
メモリ使用量変化: +58.2MB (開始: 300.5MB → 終了: 358.7MB)
=== 処理完了 ===
(簡略表示) RMSE: 798.878 kW, R2スコア: -2.5269
実行時間: 2.513秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 09:14:50] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 09:20:13] Running tomorrow data.py and temp.py
[2025-10-24 09:20:13] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 09:20:13] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:20:14] Script finished: tomorrow\data.py returncode=0
[2025-10-24 09:20:14] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.64秒) ===

[2025-10-24 09:20:14] STDERR:
2025-10-24 09:20:14,017 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 09:20:14,033 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 09:20:14,033 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:20:14,033 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:20:14,033 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:20:14,038 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:20:14,038 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:20:14,038 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:20:14,270 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:20:14,302 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:20:14,302 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:20:14,302 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:20:14,302 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:20:14,318 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:20:14,318 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:20:14,318 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:20:14,577 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:20:14,608 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:20:14,608 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 09:20:14,639 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 09:20:14,639 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 09:20:14,639 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 09:20:14,639 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 09:20:14,656 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.64秒)

[2025-10-24 09:20:14] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 09:20:14] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:20:16] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 09:20:16] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.057秒
メモリ使用量変化: +4.4MB (開始: 59.8MB → 終了: 64.2MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 09:20:16] STDERR:
2025-10-24 09:20:15,445 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.8MB
2025-10-24 09:20:15,445 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 09:20:15,445 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 09:20:15,445 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 09:20:16,470 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.026秒)
2025-10-24 09:20:16,486 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 09:20:16,486 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 09:20:16,501 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 09:20:16,501 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.016秒)
2025-10-24 09:20:16,501 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.057秒)

[2025-10-24 09:20:21] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:20:21] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 09:20:21] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:20:24] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 09:20:24] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.032秒
メモリ使用量: 115.4MB → 117.8MB (差分: +2.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.047秒
メモリ使用量: 117.8MB → 117.8MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.049秒
メモリ使用量: 117.8MB → 120.5MB (差分: +2.7MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.032秒
メモリ使用量: 120.5MB → 120.7MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.063秒
メモリ使用量: 120.7MB → 120.8MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.718秒
メモリ使用量: 120.8MB → 138.5MB (差分: +17.7MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 0.973秒
メモリ使用量: 115.4MB → 138.5MB (差分: +23.1MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 0.973秒
============================================================

[2025-10-24 09:22:44] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:22:44] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 09:22:44] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:22:50] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 09:22:50] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.052秒
メモリ使用量: 200.4MB → 201.0MB (差分: +0.6MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.126秒
メモリ使用量: 201.0MB → 203.2MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.142秒
メモリ使用量: 203.2MB → 203.6MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.063秒
メモリ使用量: 203.6MB → 203.7MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.048秒
メモリ使用量: 203.7MB → 203.7MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.620秒
メモリ使用量: 203.7MB → 220.2MB (差分: +16.4MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.161秒
メモリ使用量: 200.4MB → 220.2MB (差分: +19.8MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.161秒
============================================================

[2025-10-24 09:23:02] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:23:02] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 09:23:02] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:23:13] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 09:23:13] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 301.2MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.26 GB
[データ読み込み開始] メモリ使用量: 12.26 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.27 GB
学習データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_training_data 実行時間: 0.095秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.27 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.26 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.094秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.23 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.23 GB
モデル読み込み完了 (実行時間: 0.236秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.23 GB
[予測処理開始] メモリ使用量: 12.23 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.24 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 12.24 GB
予測処理完了 (実行時間: 0.492秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.501秒
[予測完了] メモリ使用量: 12.24 GB
評価指標を計算しています
ypred形状: (2631, 1), ytest形状: (168, 1)
[WARN] 形状不一致を検出: ypred(2631, 1) vs ytest(168, 1)
[OK] ypredを調整: (168, 1) (先頭168行使用)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 1377.782 kW, R2スコア: -10.7561, MAE: 1089.733 kW
[CSV保存開始] メモリ使用量: 12.24 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.24 GB
明日の予測結果の保存が完了しました (実行時間: 0.005秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.096秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.25 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: -10.7561
[OK] tomorrow 実行時間: 2.498秒
メモリ使用量変化: +56.7MB (開始: 301.2MB → 終了: 357.9MB)
=== 処理完了 ===
(簡略表示) RMSE: 1377.782 kW, R2スコア: -10.7561
実行時間: 2.498秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 09:23:13] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 09:29:34] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:29:34] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 09:29:34] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:30:02] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 09:30:02] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.7MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.66 GB
[データ読み込み開始] メモリ使用量: 12.66 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.67 GB
学習データの読み込みが完了しました (実行時間: 0.094秒)
[OK] load_training_data 実行時間: 0.188秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.67 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.67 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.031秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.126秒
[INFO] Xtomorrowを調整: 336行 → 168行 (過去7日分のみ使用)
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.57 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.58 GB
モデル読み込み完了 (実行時間: 0.253秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.58 GB
[予測処理開始] メモリ使用量: 12.58 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (168, 4)
[データ標準化完了] メモリ使用量: 12.58 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 12.59 GB
予測処理完了 (実行時間: 0.591秒)
テスト予測: (2631, 1), 翌日予測: (168, 1)
[OK] predict_with_model 実行時間: 0.591秒
[予測完了] メモリ使用量: 12.59 GB
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 99.865 kW, R2スコア: 0.9382, MAE: 74.031 kW
[CSV保存開始] メモリ使用量: 12.59 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.59 GB
明日の予測結果の保存が完了しました (実行時間: 0.016秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.109秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.65 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: 0.9382
[OK] tomorrow 実行時間: 3.205秒
メモリ使用量変化: +59.4MB (開始: 300.7MB → 終了: 360.1MB)
=== 処理完了 ===
(簡略表示) RMSE: 99.865 kW, R2スコア: 0.9382
実行時間: 3.205秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 09:30:02] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 09:34:29] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:34:29] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 09:34:29] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:34:39] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 09:34:39] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 301.2MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.48 GB
[データ読み込み開始] メモリ使用量: 12.48 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.48 GB
学習データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_training_data 実行時間: 0.095秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.45 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.45 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.081秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.45 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.45 GB
モデル読み込み完了 (実行時間: 0.203秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.45 GB
[予測処理開始] メモリ使用量: 12.45 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.45 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 12.41 GB
予測処理完了 (実行時間: 0.458秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.458秒
[予測完了] メモリ使用量: 12.41 GB
[INFO] 評価計算: Ytomorrow_pred 336行のうち先頭168行を使用
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 99.865 kW, R2スコア: 0.9382, MAE: 74.031 kW
[CSV保存開始] メモリ使用量: 12.41 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.41 GB
明日の予測結果の保存が完了しました (実行時間: 0.000秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.095秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.45 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: 0.9382
[OK] tomorrow 実行時間: 2.170秒
メモリ使用量変化: +60.1MB (開始: 301.2MB → 終了: 361.2MB)
=== 処理完了 ===
(簡略表示) RMSE: 99.865 kW, R2スコア: 0.9382
実行時間: 2.170秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 09:34:39] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


[2025-10-24 09:35:34] Received /run-data payload: {'years': ['2022', '2023', '2024']}
[2025-10-24 09:35:35] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 09:35:35] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:35:36] Script finished: data\data.py returncode=0
[2025-10-24 09:35:36] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 09:35:36] STDERR:
2025-10-24 09:35:36,474 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 09:35:36,474 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 09:35:36,474 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 09:35:36,538 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 09:35:36,538 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 09:35:36,617 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 09:35:36,664 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 09:35:36,822 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 09:35:36,822 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 09:35:40] Received /run-train payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:35:40] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 09:35:40] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 09:35:40] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:35:42] Script finished: data\data.py returncode=0
[2025-10-24 09:35:42] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 09:35:42] STDERR:
2025-10-24 09:35:42,370 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 09:35:42,370 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 09:35:42,370 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 09:35:42,401 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 09:35:42,401 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 09:35:42,417 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 09:35:42,465 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 09:35:42,607 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 09:35:42,613 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 09:35:42] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_train.py
[2025-10-24 09:35:42] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:37:15] Script finished: train\Keras\Keras_train.py returncode=0
[2025-10-24 09:37:15] STDOUT:
Keras: 統一パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
=== Keras学習開始 ===
環境変数指定による学習年: 2022,2023,2024
Keras電力需要予測モデルの学習を開始します...
=== 学習・テストデータ読み込み開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
=== 学習・テストデータ読み込み完了 ===
=== データ標準化開始 ===
データの標準化を実行中...
標準化完了: 特徴量数=4, 目的変数正規化適用
=== データ標準化完了 ===
=== Kerasモデル構築開始 ===
Kerasモデルを構築中... (入力次元: 4)
改善版v3アーキテクチャ: 128→128→64→32→1
過学習対策v3: Dropout=0.1, L2正則化=0.001, Batch=64
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 hidden1 (Dense)             (None, 128)               640       
                                                                 
 dropout1 (Dropout)          (None, 128)               0         
                                                                 
 hidden2 (Dense)             (None, 128)               16512     
                                                                 
 dropout2 (Dropout)          (None, 128)               0         
                                                                 
 hidden3 (Dense)             (None, 64)                8256      
                                                                 
 hidden4 (Dense)             (None, 32)                2080      
                                                                 
 output (Dense)              (None, 1)                 33        
                                                                 
=================================================================
Total params: 27521 (107.50 KB)
Trainable params: 27521 (107.50 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
Kerasモデル構築完了 (学習率: 0.001, Batch: 64)
=== Kerasモデル構築完了 ===
=== モデル学習開始 ===
モデル学習開始 (epochs: 500, batch_size: 64, patience: 20)
Epoch 1/500

  1/296 [..............................] - ETA: 6:59 - loss: 1.1270 - mean_absolute_error: 0.7487
 25/296 [=>............................] - ETA: 0s - loss: 0.7848 - mean_absolute_error: 0.5966  
 47/296 [===>..........................] - ETA: 0s - loss: 0.6480 - mean_absolute_error: 0.5113
 73/296 [======>.......................] - ETA: 0s - loss: 0.5630 - mean_absolute_error: 0.4572
 96/296 [========>.....................] - ETA: 0s - loss: 0.5220 - mean_absolute_error: 0.4317
124/296 [===========>..................] - ETA: 0s - loss: 0.4843 - mean_absolute_error: 0.4079
155/296 [==============>...............] - ETA: 0s - loss: 0.4561 - mean_absolute_error: 0.3901
181/296 [=================>............] - ETA: 0s - loss: 0.4379 - mean_absolute_error: 0.3792
203/296 [===================>..........] - ETA: 0s - loss: 0.4257 - mean_absolute_error: 0.3726
221/296 [=====================>........] - ETA: 0s - loss: 0.4176 - mean_absolute_error: 0.3681
236/296 [======================>.......] - ETA: 0s - loss: 0.4105 - mean_absolute_error: 0.3639
249/296 [========================>.....] - ETA: 0s - loss: 0.4040 - mean_absolute_error: 0.3598
264/296 [=========================>....] - ETA: 0s - loss: 0.3983 - mean_absolute_error: 0.3566
293/296 [============================>.] - ETA: 0s - loss: 0.3873 - mean_absolute_error: 0.3508
296/296 [==============================] - 3s 4ms/step - loss: 0.3862 - mean_absolute_error: 0.3500 - val_loss: 0.2451 - val_mean_absolute_error: 0.2589
Epoch 2/500

  1/296 [..............................] - ETA: 2s - loss: 0.3809 - mean_absolute_error: 0.3472
 20/296 [=>............................] - ETA: 0s - loss: 0.2789 - mean_absolute_error: 0.2915
 37/296 [==>...........................] - ETA: 0s - loss: 0.2752 - mean_absolute_error: 0.2897
 54/296 [====>.........................] - ETA: 0s - loss: 0.2730 - mean_absolute_error: 0.2877
 78/296 [======>.......................] - ETA: 0s - loss: 0.2712 - mean_absolute_error: 0.2879
103/296 [=========>....................] - ETA: 0s - loss: 0.2719 - mean_absolute_error: 0.2896
131/296 [============>.................] - ETA: 0s - loss: 0.2680 - mean_absolute_error: 0.2890
158/296 [===============>..............] - ETA: 0s - loss: 0.2633 - mean_absolute_error: 0.2860
185/296 [=================>............] - ETA: 0s - loss: 0.2616 - mean_absolute_error: 0.2857
207/296 [===================>..........] - ETA: 0s - loss: 0.2575 - mean_absolute_error: 0.2834
228/296 [======================>.......] - ETA: 0s - loss: 0.2557 - mean_absolute_error: 0.2829
247/296 [========================>.....] - ETA: 0s - loss: 0.2532 - mean_absolute_error: 0.2813
265/296 [=========================>....] - ETA: 0s - loss: 0.2509 - mean_absolute_error: 0.2800
279/296 [===========================>..] - ETA: 0s - loss: 0.2496 - mean_absolute_error: 0.2792
296/296 [==============================] - 1s 3ms/step - loss: 0.2479 - mean_absolute_error: 0.2783 - val_loss: 0.2020 - val_mean_absolute_error: 0.2486
Epoch 3/500

  1/296 [..............................] - ETA: 0s - loss: 0.2156 - mean_absolute_error: 0.2615
 24/296 [=>............................] - ETA: 0s - loss: 0.2210 - mean_absolute_error: 0.2646
 51/296 [====>.........................] - ETA: 0s - loss: 0.2178 - mean_absolute_error: 0.2647
 73/296 [======>.......................] - ETA: 0s - loss: 0.2134 - mean_absolute_error: 0.2617
 87/296 [=======>......................] - ETA: 0s - loss: 0.2104 - mean_absolute_error: 0.2588
112/296 [==========>...................] - ETA: 0s - loss: 0.2095 - mean_absolute_error: 0.2572
139/296 [=============>................] - ETA: 0s - loss: 0.2078 - mean_absolute_error: 0.2570
162/296 [===============>..............] - ETA: 0s - loss: 0.2059 - mean_absolute_error: 0.2563
189/296 [==================>...........] - ETA: 0s - loss: 0.2062 - mean_absolute_error: 0.2566
214/296 [====================>.........] - ETA: 0s - loss: 0.2055 - mean_absolute_error: 0.2566
244/296 [=======================>......] - ETA: 0s - loss: 0.2037 - mean_absolute_error: 0.2559
274/296 [==========================>...] - ETA: 0s - loss: 0.2012 - mean_absolute_error: 0.2541
296/296 [==============================] - 1s 3ms/step - loss: 0.1997 - mean_absolute_error: 0.2536 - val_loss: 0.1524 - val_mean_absolute_error: 0.2145
Epoch 4/500

  1/296 [..............................] - ETA: 0s - loss: 0.1362 - mean_absolute_error: 0.1924
 20/296 [=>............................] - ETA: 0s - loss: 0.1706 - mean_absolute_error: 0.2369
 38/296 [==>...........................] - ETA: 0s - loss: 0.1700 - mean_absolute_error: 0.2362
 56/296 [====>.........................] - ETA: 0s - loss: 0.1739 - mean_absolute_error: 0.2397
 74/296 [======>.......................] - ETA: 0s - loss: 0.1742 - mean_absolute_error: 0.2408
 98/296 [========>.....................] - ETA: 0s - loss: 0.1752 - mean_absolute_error: 0.2422
128/296 [===========>..................] - ETA: 0s - loss: 0.1755 - mean_absolute_error: 0.2429
159/296 [===============>..............] - ETA: 0s - loss: 0.1748 - mean_absolute_error: 0.2433
184/296 [=================>............] - ETA: 0s - loss: 0.1742 - mean_absolute_error: 0.2434
207/296 [===================>..........] - ETA: 0s - loss: 0.1735 - mean_absolute_error: 0.2438
233/296 [======================>.......] - ETA: 0s - loss: 0.1726 - mean_absolute_error: 0.2436
257/296 [=========================>....] - ETA: 0s - loss: 0.1716 - mean_absolute_error: 0.2433
278/296 [===========================>..] - ETA: 0s - loss: 0.1707 - mean_absolute_error: 0.2427
295/296 [============================>.] - ETA: 0s - loss: 0.1706 - mean_absolute_error: 0.2427
296/296 [==============================] - 1s 3ms/step - loss: 0.1705 - mean_absolute_error: 0.2426 - val_loss: 0.1227 - val_mean_absolute_error: 0.1895
Epoch 5/500

  1/296 [..............................] - ETA: 1s - loss: 0.1512 - mean_absolute_error: 0.2194
 22/296 [=>............................] - ETA: 0s - loss: 0.1587 - mean_absolute_error: 0.2352
 42/296 [===>..........................] - ETA: 0s - loss: 0.1550 - mean_absolute_error: 0.2368
 63/296 [=====>........................] - ETA: 0s - loss: 0.1543 - mean_absolute_error: 0.2353
 83/296 [=======>......................] - ETA: 0s - loss: 0.1544 - mean_absolute_error: 0.2343
109/296 [==========>...................] - ETA: 0s - loss: 0.1549 - mean_absolute_error: 0.2341
129/296 [============>.................] - ETA: 0s - loss: 0.1558 - mean_absolute_error: 0.2349
146/296 [=============>................] - ETA: 0s - loss: 0.1554 - mean_absolute_error: 0.2352
163/296 [===============>..............] - ETA: 0s - loss: 0.1546 - mean_absolute_error: 0.2343
175/296 [================>.............] - ETA: 0s - loss: 0.1542 - mean_absolute_error: 0.2340
197/296 [==================>...........] - ETA: 0s - loss: 0.1546 - mean_absolute_error: 0.2344
224/296 [=====================>........] - ETA: 0s - loss: 0.1536 - mean_absolute_error: 0.2345
253/296 [========================>.....] - ETA: 0s - loss: 0.1540 - mean_absolute_error: 0.2356
280/296 [===========================>..] - ETA: 0s - loss: 0.1534 - mean_absolute_error: 0.2357
296/296 [==============================] - 1s 3ms/step - loss: 0.1539 - mean_absolute_error: 0.2363 - val_loss: 0.1207 - val_mean_absolute_error: 0.2063
Epoch 6/500

  1/296 [..............................] - ETA: 0s - loss: 0.2236 - mean_absolute_error: 0.2837
 21/296 [=>............................] - ETA: 0s - loss: 0.1447 - mean_absolute_error: 0.2310
 44/296 [===>..........................] - ETA: 0s - loss: 0.1445 - mean_absolute_error: 0.2292
 63/296 [=====>........................] - ETA: 0s - loss: 0.1444 - mean_absolute_error: 0.2300
 88/296 [=======>......................] - ETA: 0s - loss: 0.1452 - mean_absolute_error: 0.2302
118/296 [==========>...................] - ETA: 0s - loss: 0.1452 - mean_absolute_error: 0.2311
149/296 [==============>...............] - ETA: 0s - loss: 0.1447 - mean_absolute_error: 0.2317
179/296 [=================>............] - ETA: 0s - loss: 0.1438 - mean_absolute_error: 0.2310
202/296 [===================>..........] - ETA: 0s - loss: 0.1427 - mean_absolute_error: 0.2304
218/296 [=====================>........] - ETA: 0s - loss: 0.1425 - mean_absolute_error: 0.2303
243/296 [=======================>......] - ETA: 0s - loss: 0.1415 - mean_absolute_error: 0.2294
268/296 [==========================>...] - ETA: 0s - loss: 0.1409 - mean_absolute_error: 0.2292
295/296 [============================>.] - ETA: 0s - loss: 0.1410 - mean_absolute_error: 0.2290
296/296 [==============================] - 1s 3ms/step - loss: 0.1410 - mean_absolute_error: 0.2289 - val_loss: 0.1052 - val_mean_absolute_error: 0.1904
Epoch 7/500

  1/296 [..............................] - ETA: 0s - loss: 0.1501 - mean_absolute_error: 0.2212
 28/296 [=>............................] - ETA: 0s - loss: 0.1303 - mean_absolute_error: 0.2221
 58/296 [====>.........................] - ETA: 0s - loss: 0.1375 - mean_absolute_error: 0.2268
 81/296 [=======>......................] - ETA: 0s - loss: 0.1362 - mean_absolute_error: 0.2260
106/296 [=========>....................] - ETA: 0s - loss: 0.1345 - mean_absolute_error: 0.2252
132/296 [============>.................] - ETA: 0s - loss: 0.1350 - mean_absolute_error: 0.2271
151/296 [==============>...............] - ETA: 0s - loss: 0.1343 - mean_absolute_error: 0.2263
178/296 [=================>............] - ETA: 0s - loss: 0.1334 - mean_absolute_error: 0.2255
200/296 [===================>..........] - ETA: 0s - loss: 0.1325 - mean_absolute_error: 0.2244
220/296 [=====================>........] - ETA: 0s - loss: 0.1315 - mean_absolute_error: 0.2236
244/296 [=======================>......] - ETA: 0s - loss: 0.1309 - mean_absolute_error: 0.2232
274/296 [==========================>...] - ETA: 0s - loss: 0.1297 - mean_absolute_error: 0.2220
296/296 [==============================] - 1s 3ms/step - loss: 0.1298 - mean_absolute_error: 0.2222 - val_loss: 0.1015 - val_mean_absolute_error: 0.1959
Epoch 8/500

  1/296 [..............................] - ETA: 0s - loss: 0.1327 - mean_absolute_error: 0.2202
 17/296 [>.............................] - ETA: 1s - loss: 0.1277 - mean_absolute_error: 0.2204
 33/296 [==>...........................] - ETA: 1s - loss: 0.1277 - mean_absolute_error: 0.2241
 57/296 [====>.........................] - ETA: 0s - loss: 0.1323 - mean_absolute_error: 0.2303
 87/296 [=======>......................] - ETA: 0s - loss: 0.1307 - mean_absolute_error: 0.2274
109/296 [==========>...................] - ETA: 0s - loss: 0.1299 - mean_absolute_error: 0.2270
134/296 [============>.................] - ETA: 0s - loss: 0.1271 - mean_absolute_error: 0.2234
163/296 [===============>..............] - ETA: 0s - loss: 0.1272 - mean_absolute_error: 0.2228
193/296 [==================>...........] - ETA: 0s - loss: 0.1255 - mean_absolute_error: 0.2208
221/296 [=====================>........] - ETA: 0s - loss: 0.1247 - mean_absolute_error: 0.2202
246/296 [=======================>......] - ETA: 0s - loss: 0.1251 - mean_absolute_error: 0.2206
264/296 [=========================>....] - ETA: 0s - loss: 0.1246 - mean_absolute_error: 0.2207
282/296 [===========================>..] - ETA: 0s - loss: 0.1244 - mean_absolute_error: 0.2207
296/296 [==============================] - 1s 3ms/step - loss: 0.1244 - mean_absolute_error: 0.2210 - val_loss: 0.0935 - val_mean_absolute_error: 0.1848
Epoch 9/500

  1/296 [..............................] - ETA: 0s - loss: 0.1427 - mean_absolute_error: 0.2397
 16/296 [>.............................] - ETA: 1s - loss: 0.1122 - mean_absolute_error: 0.2128
 38/296 [==>...........................] - ETA: 0s - loss: 0.1196 - mean_absolute_error: 0.2175
 59/296 [====>.........................] - ETA: 0s - loss: 0.1178 - mean_absolute_error: 0.2158
 80/296 [=======>......................] - ETA: 0s - loss: 0.1175 - mean_absolute_error: 0.2158
100/296 [=========>....................] - ETA: 0s - loss: 0.1195 - mean_absolute_error: 0.2176
128/296 [===========>..................] - ETA: 0s - loss: 0.1229 - mean_absolute_error: 0.2210
159/296 [===============>..............] - ETA: 0s - loss: 0.1208 - mean_absolute_error: 0.2191
184/296 [=================>............] - ETA: 0s - loss: 0.1202 - mean_absolute_error: 0.2187
209/296 [====================>.........] - ETA: 0s - loss: 0.1202 - mean_absolute_error: 0.2188
237/296 [=======================>......] - ETA: 0s - loss: 0.1205 - mean_absolute_error: 0.2194
260/296 [=========================>....] - ETA: 0s - loss: 0.1204 - mean_absolute_error: 0.2195
290/296 [============================>.] - ETA: 0s - loss: 0.1197 - mean_absolute_error: 0.2185
296/296 [==============================] - 1s 3ms/step - loss: 0.1199 - mean_absolute_error: 0.2188 - val_loss: 0.0911 - val_mean_absolute_error: 0.1875
Epoch 10/500

  1/296 [..............................] - ETA: 0s - loss: 0.1171 - mean_absolute_error: 0.2260
 24/296 [=>............................] - ETA: 0s - loss: 0.1026 - mean_absolute_error: 0.2064
 47/296 [===>..........................] - ETA: 0s - loss: 0.1079 - mean_absolute_error: 0.2081
 74/296 [======>.......................] - ETA: 0s - loss: 0.1127 - mean_absolute_error: 0.2152
 92/296 [========>.....................] - ETA: 0s - loss: 0.1135 - mean_absolute_error: 0.2157
111/296 [==========>...................] - ETA: 0s - loss: 0.1142 - mean_absolute_error: 0.2161
137/296 [============>.................] - ETA: 0s - loss: 0.1166 - mean_absolute_error: 0.2189
160/296 [===============>..............] - ETA: 0s - loss: 0.1159 - mean_absolute_error: 0.2177
190/296 [==================>...........] - ETA: 0s - loss: 0.1160 - mean_absolute_error: 0.2187
220/296 [=====================>........] - ETA: 0s - loss: 0.1170 - mean_absolute_error: 0.2191
250/296 [========================>.....] - ETA: 0s - loss: 0.1165 - mean_absolute_error: 0.2184
277/296 [===========================>..] - ETA: 0s - loss: 0.1176 - mean_absolute_error: 0.2195
296/296 [==============================] - 1s 3ms/step - loss: 0.1179 - mean_absolute_error: 0.2199 - val_loss: 0.0959 - val_mean_absolute_error: 0.2005
Epoch 11/500

  1/296 [..............................] - ETA: 4s - loss: 0.1651 - mean_absolute_error: 0.2421
 23/296 [=>............................] - ETA: 0s - loss: 0.1112 - mean_absolute_error: 0.2171
 52/296 [====>.........................] - ETA: 0s - loss: 0.1147 - mean_absolute_error: 0.2191
 81/296 [=======>......................] - ETA: 0s - loss: 0.1153 - mean_absolute_error: 0.2199
108/296 [=========>....................] - ETA: 0s - loss: 0.1141 - mean_absolute_error: 0.2182
138/296 [============>.................] - ETA: 0s - loss: 0.1132 - mean_absolute_error: 0.2171
159/296 [===============>..............] - ETA: 0s - loss: 0.1135 - mean_absolute_error: 0.2168
185/296 [=================>............] - ETA: 0s - loss: 0.1129 - mean_absolute_error: 0.2158
205/296 [===================>..........] - ETA: 0s - loss: 0.1131 - mean_absolute_error: 0.2154
223/296 [=====================>........] - ETA: 0s - loss: 0.1125 - mean_absolute_error: 0.2151
245/296 [=======================>......] - ETA: 0s - loss: 0.1113 - mean_absolute_error: 0.2140
262/296 [=========================>....] - ETA: 0s - loss: 0.1116 - mean_absolute_error: 0.2141
291/296 [============================>.] - ETA: 0s - loss: 0.1126 - mean_absolute_error: 0.2152
296/296 [==============================] - 1s 3ms/step - loss: 0.1126 - mean_absolute_error: 0.2152 - val_loss: 0.0861 - val_mean_absolute_error: 0.1848
Epoch 12/500

  1/296 [..............................] - ETA: 0s - loss: 0.0844 - mean_absolute_error: 0.1790
 27/296 [=>............................] - ETA: 0s - loss: 0.1124 - mean_absolute_error: 0.2116
 48/296 [===>..........................] - ETA: 0s - loss: 0.1080 - mean_absolute_error: 0.2089
 74/296 [======>.......................] - ETA: 0s - loss: 0.1090 - mean_absolute_error: 0.2114
100/296 [=========>....................] - ETA: 0s - loss: 0.1068 - mean_absolute_error: 0.2103
118/296 [==========>...................] - ETA: 0s - loss: 0.1063 - mean_absolute_error: 0.2105
142/296 [=============>................] - ETA: 0s - loss: 0.1070 - mean_absolute_error: 0.2115
162/296 [===============>..............] - ETA: 0s - loss: 0.1069 - mean_absolute_error: 0.2109
181/296 [=================>............] - ETA: 0s - loss: 0.1081 - mean_absolute_error: 0.2124
205/296 [===================>..........] - ETA: 0s - loss: 0.1082 - mean_absolute_error: 0.2121
236/296 [======================>.......] - ETA: 0s - loss: 0.1091 - mean_absolute_error: 0.2131
267/296 [==========================>...] - ETA: 0s - loss: 0.1106 - mean_absolute_error: 0.2145
296/296 [==============================] - 1s 3ms/step - loss: 0.1109 - mean_absolute_error: 0.2150 - val_loss: 0.0886 - val_mean_absolute_error: 0.1921
Epoch 13/500

  1/296 [..............................] - ETA: 0s - loss: 0.1040 - mean_absolute_error: 0.1999
 20/296 [=>............................] - ETA: 0s - loss: 0.1222 - mean_absolute_error: 0.2238
 38/296 [==>...........................] - ETA: 0s - loss: 0.1131 - mean_absolute_error: 0.2163
 64/296 [=====>........................] - ETA: 0s - loss: 0.1101 - mean_absolute_error: 0.2147
 83/296 [=======>......................] - ETA: 0s - loss: 0.1110 - mean_absolute_error: 0.2156
102/296 [=========>....................] - ETA: 0s - loss: 0.1096 - mean_absolute_error: 0.2149
130/296 [============>.................] - ETA: 0s - loss: 0.1092 - mean_absolute_error: 0.2147
161/296 [===============>..............] - ETA: 0s - loss: 0.1100 - mean_absolute_error: 0.2158
192/296 [==================>...........] - ETA: 0s - loss: 0.1088 - mean_absolute_error: 0.2143
218/296 [=====================>........] - ETA: 0s - loss: 0.1096 - mean_absolute_error: 0.2145
241/296 [=======================>......] - ETA: 0s - loss: 0.1100 
[2025-10-24 09:37:15] STDERR:
2025-10-24 09:35:44.736417: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:873: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2025-10-24 09:35:50.377876: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.


[2025-10-24 09:44:24] Received /run-train payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:44:24] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 09:44:24] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 09:44:24] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:44:26] Script finished: data\data.py returncode=0
[2025-10-24 09:44:26] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 09:44:26] STDERR:
2025-10-24 09:44:26,195 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 09:44:26,196 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 09:44:26,196 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 09:44:26,219 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 09:44:26,219 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 09:44:26,247 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 09:44:26,304 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 09:44:26,454 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 09:44:26,454 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 09:44:26] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\LightGBM\LightGBM_train.py
[2025-10-24 09:44:26] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:44:31] Script finished: train\LightGBM\LightGBM_train.py returncode=0
[2025-10-24 09:44:31] STDOUT:
=== LightGBM統一最適化設定適用完了 ===
AI_TARGET_YEARS=2022,2023,2024
=== LightGBM学習開始 ===
=== LightGBM学習統合処理 開始 ===
=== LightGBM電力需要予測モデル学習開始 ===
=== 学習データ読み込み 開始 ===
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
メモリ最適化: float32データ型使用、メモリ使用量約50%削減
=== 学習データ読み込み 完了 (実行時間: 0.10秒) ===
=== データ標準化処理 開始 ===
データの標準化を実行中...
データの標準化が完了しました（float32最適化済み）
=== データ標準化処理 完了 (実行時間: 0.00秒) ===
学習率を 0.1 に設定しました
=== LightGBMモデル構築 開始 ===
LightGBMモデルを構築中...
LightGBMモデル構築完了 - パラメータ: {'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': -1, 'num_leaves': 31, 'min_child_samples': 20, 'subsample': 1.0, 'colsample_bytree': 1.0, 'random_state': 42, 'verbose': -1}
=== LightGBMモデル構築 完了 (実行時間: 0.00秒) ===
=== LightGBMモデル学習 開始 ===
LightGBMモデルの学習を開始します...
LightGBMモデルの学習が完了しました
=== LightGBMモデル学習 完了 (実行時間: 0.14秒) ===
=== モデル・スケーラー保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
LightGBMモデルを train/LightGBM/LightGBM_model.sav に保存しました
スケーラーを train/LightGBM/LightGBM_model_scaler.pkl に保存しました
=== モデル・スケーラー保存 完了 (実行時間: 0.03秒) ===
=== モデル性能評価 開始 ===
=== モデル性能評価開始 ===
モデル性能評価を実行中...
テストスコア: 0.9193
テスト損失: 27429.516, テストMAE: 107.717
RMSE: 165.619 kW
R2スコア: 0.9193
MAE: 107.717 kW
=== モデル性能評価完了 ===
=== モデル性能評価 完了 (実行時間: 0.02秒) ===
=== 予測結果CSV保存 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
予測結果を train/LightGBM/LightGBM_Ypred.csv に保存しました（2631行）
=== 予測結果CSV保存 完了 (実行時間: 0.04秒) ===
=== 予測結果可視化 開始 ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
=== ディレクトリ確認・作成 開始 ===
=== ディレクトリ確認・作成 完了 (実行時間: 0.00秒) ===
全期間グラフを train/LightGBM/LightGBM_Ypred.png に保存しました（16:9統一フォーマット）
1週間グラフを train/LightGBM/LightGBM_Ypred_7d.png に保存しました（16:9統一フォーマット）
=== 予測結果可視化 完了 (実行時間: 1.92秒) ===
=== LightGBM電力需要予測モデル学習完了 ===
=== LightGBM学習統合処理 完了 (実行時間: 2.49秒) ===
=== LightGBM学習完了 (実行時間: 2.52秒) ===
最終結果 - RMSE: 165.619 kW, R2スコア: 0.9193, MAE: 107.717 kW

[2025-10-24 09:44:39] Received /run-train payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:44:39] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 09:44:39] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 09:44:39] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:44:41] Script finished: data\data.py returncode=0
[2025-10-24 09:44:41] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 09:44:41] STDERR:
2025-10-24 09:44:41,248 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 09:44:41,249 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 09:44:41,249 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 09:44:41,262 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 09:44:41,262 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 09:44:41,294 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 09:44:41,342 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 09:44:41,501 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 09:44:41,502 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 09:44:41] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Pycaret\Pycaret_train.py
[2025-10-24 09:44:41] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:45:03] Script finished: train\Pycaret\Pycaret_train.py returncode=0
[2025-10-24 09:45:03] STDOUT:
PyCaret: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
PyCaret電力需要予測AIモデル学習システム
統一リファクタリング仕様 - PyCaretConfig対応版
============================================================
PyCaret PyCaret電力需要予測モデル学習 を開始します...
PyCaret データ読み込み を開始します...
学習データを読み込み中...
設定: 読み込んだ特徴量列を config.feature_columns に反映しました (4 列)
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
PyCaret データ読み込み が正常に完了しました
PyCaret PyCaret実験環境セットアップ を開始します...
PyCaretパラメータ {'silent': True} でエラー: setup() got an unexpected keyword argument 'silent'
PyCaretセットアップ成功: {'data':        MONTH  WEEK  HOUR       TEMP      KW
0        1.0   5.0   1.0   0.700000  3062.0
1        1.0   5.0   2.0   0.500000  2929.0
2        1.0   5.0   3.0   0.500000  2828.0
3        1.0   5.0   4.0   0.300000  2786.0
4        1.0   5.0   5.0  -0.200000  2828.0
...      ...   ...   ...        ...     ...
23666    9.0   4.0   3.0  27.400000  2827.0
23667    9.0   4.0   4.0  27.299999  2825.0
23668    9.0   4.0   5.0  26.900000  2908.0
23669    9.0   4.0   6.0  26.799999  3169.0
23670    9.0   4.0   7.0  28.100000  3716.0

[23671 rows x 5 columns], 'target': 'KW', 'session_id': 123, 'verbose': False}
PyCaret PyCaret実験環境セットアップ が正常に完了しました
PyCaret PyCaretモデル作成・学習 を開始します...
PyCaretモデル（lightgbm）を作成・学習中...
           MAE         MSE      RMSE      R2   RMSLE    MAPE
Fold                                                        
0     125.2144  31794.6683  178.3106  0.9405  0.0522  0.0382
1     120.9207  31976.6358  178.8201  0.9391  0.0540  0.0376
2     121.1220  31135.9836  176.4539  0.9391  0.0522  0.0372
3     125.2550  33426.7820  182.8299  0.9372  0.0543  0.0382
4     122.9873  32776.9684  181.0441  0.9338  0.0539  0.0379
5     130.9828  37629.9639  193.9844  0.9291  0.0572  0.0401
6     124.2342  35663.3741  188.8475  0.9321  0.0553  0.0384
7     125.3091  34730.6987  186.3617  0.9314  0.0548  0.0383
8     128.1099  35799.8223  189.2084  0.9314  0.0553  0.0391
9     121.5504  31386.3046  177.1618  0.9404  0.0530  0.0377
Mean  124.5686  33632.1202  183.3023  0.9354  0.0542  0.0383
Std     3.0336   2101.8860    5.6924  0.0041  0.0015  0.0008
メモリ最適化を実行しました
PyCaret PyCaretモデル作成・学習 が正常に完了しました
PyCaret PyCaretモデル保存 を開始します...
Transformation Pipeline and Model Successfully Saved
PyCaretモデルを train/Pycaret/Pycaret_model.pkl に保存しました
PyCaret PyCaretモデル保存 が正常に完了しました
PyCaret PyCaretモデル予測 を開始します...
予測が完了しました。予測値の形状: (2631,)
メモリ最適化を実行しました
PyCaret PyCaretモデル予測 が正常に完了しました
PyCaret モデル性能評価 を開始します...
PyCaretテストスコア: 0.919
最終結果 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
PyCaret モデル性能評価 が正常に完了しました
PyCaret 予測結果CSV保存 を開始します...
予測結果を train/Pycaret/Pycaret_Ypred.csv に保存しました
PyCaret 予測結果CSV保存 が正常に完了しました
PyCaret 予測結果グラフ作成 を開始します...
全期間グラフを train/Pycaret/Pycaret_Ypred.png に保存しました
1週間グラフを train/Pycaret/Pycaret_Ypred_7d.png に保存しました
メモリ最適化を実行しました
PyCaret 予測結果グラフ作成 が正常に完了しました
PyCaret PyCaret電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] PyCaret学習完了 - RMSE: 165.970 kW, R2: 0.9190, MAE: 108.722 kW
============================================================

[2025-10-24 09:45:03] STDERR:

Processing:   0%|          | 0/4 [00:00<?, ?it/s]
Processing:  75%|███████▌  | 3/4 [00:06<00:02,  2.11s/it]
Processing: 100%|██████████| 4/4 [00:06<00:00,  1.47s/it]
                                                         

[2025-10-24 09:45:11] Received /run-train payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:45:11] Running data pipeline before training with AI_TARGET_YEARS=2022,2023,2024
[2025-10-24 09:45:11] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\data.py
[2025-10-24 09:45:11] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:45:13] Script finished: data\data.py returncode=0
[2025-10-24 09:45:13] STDOUT:
対象年に制限を適用します: ['2022', '2023', '2024']
============================================================
電力需要予測AIモデル - データ前処理開始
============================================================
AI_TARGET_YEARS によりファイルを絞り込み: ['2022', '2023', '2024']
電力データファイル: 3件
気温データファイル: 3件
共通年: 3年分 (2022, 2023, 2024)
電力データ読み込み中: data\juyo-2022.csv
電力データ読み込み中: data\juyo-2023.csv
電力データ読み込み中: data\juyo-2024.csv
電力データ読み込み完了: 26304行 (メモリ最適化済み)
気温データ読み込み中: data\temperature-2022.csv
気温データ読み込み中: data\temperature-2023.csv
気温データ読み込み中: data\temperature-2024.csv
気温データ読み込み完了: 26304行 (メモリ最適化済み)
電力データ前処理開始
電力データ前処理完了 (パフォーマンス最適化済み)
気温データ前処理開始
気温データ前処理完了 (パフォーマンス最適化済み)
データマージ開始
データマージ完了: 26302行 (パフォーマンス最適化済み)
特徴量・ターゲットデータ作成開始
特徴量データ作成完了: (26302, 4)
ターゲットデータ作成完了: (26302, 1)
データ保存開始
すべてのデータ保存完了: data/X.csv, data/Y.csv
学習・テストデータ保存完了
学習データ: 23671行, テストデータ: 2631行
============================================================
すべての処理が正常に完了しました
============================================================
すべての処理が正常に完了しました

[2025-10-24 09:45:13] STDERR:
2025-10-24 09:45:13,069 - __main__ - INFO - wrapper:91 - データファイル検索開始
2025-10-24 09:45:13,069 - __main__ - INFO - wrapper:93 - データファイル検索完了
2025-10-24 09:45:13,069 - __main__ - INFO - wrapper:91 - 電力データ読み込み開始
2025-10-24 09:45:13,079 - __main__ - INFO - wrapper:93 - 電力データ読み込み完了
2025-10-24 09:45:13,079 - __main__ - INFO - wrapper:91 - 気温データ読み込み開始
2025-10-24 09:45:13,110 - __main__ - INFO - wrapper:93 - 気温データ読み込み完了
2025-10-24 09:45:13,157 - __main__ - INFO - wrapper:91 - データセット保存開始
2025-10-24 09:45:13,302 - __main__ - INFO - wrapper:93 - データセット保存完了
2025-10-24 09:45:13,302 - __main__ - INFO - main:745 - データ処理正常完了

[2025-10-24 09:45:13] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\RandomForest\RandomForest_train.py
[2025-10-24 09:45:13] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:45:17] Script finished: train\RandomForest\RandomForest_train.py returncode=0
[2025-10-24 09:45:17] STDOUT:
RandomForest: パフォーマンス最適化設定を適用しました
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest電力需要予測AIモデル学習システム
統一リファクタリング仕様 - RandomForestConfig対応版
============================================================
RandomForest RandomForest電力需要予測モデル学習 を開始します...
RandomForest データ読み込み を開始します...
学習データを読み込み中...
学習データ形状: X_train=(23671, 4), y_train=(23671,)
テストデータ形状: X_test=(2631, 4), y_test=(2631,)
データ型: float32 (メモリ最適化)
メモリ最適化を実行しました
RandomForest データ読み込み が正常に完了しました
RandomForest データ標準化 を開始します...
メモリ最適化を実行しました
RandomForest データ標準化 が正常に完了しました
RandomForest RandomForestモデル作成 を開始します...
Random Forestモデルパラメータ: {'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'sqrt', 'n_jobs': -1, 'random_state': 42}
RandomForest RandomForestモデル作成 が正常に完了しました
RandomForest RandomForestモデル学習 を開始します...
メモリ最適化を実行しました
RandomForest RandomForestモデル学習 が正常に完了しました
RandomForest モデル・スケーラー保存 を開始します...
Random Forestモデルを train/RandomForest/RandomForest_model.sav に保存しました
スケーラーを train/RandomForest/RandomForest_model_scaler.pkl に保存しました
RandomForest モデル・スケーラー保存 が正常に完了しました
RandomForest モデル性能評価 を開始します...
テストスコア: 0.908
最終結果 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
メモリ最適化を実行しました
RandomForest モデル性能評価 が正常に完了しました
RandomForest 予測結果CSV保存 を開始します...
予測結果を train/RandomForest/RandomForest_Ypred.csv に保存しました
RandomForest 予測結果CSV保存 が正常に完了しました
RandomForest 予測結果グラフ作成 を開始します...
全期間グラフを train/RandomForest/RandomForest_Ypred.png に保存しました
1週間グラフを train/RandomForest/RandomForest_Ypred_7d.png に保存しました
メモリ最適化を実行しました
RandomForest 予測結果グラフ作成 が正常に完了しました
RandomForest RandomForest電力需要予測モデル学習 が正常に完了しました
============================================================
[SUCCESS] RandomForest学習完了 - RMSE: 176.404 kW, R2: 0.9085, MAE: 116.328 kW
============================================================

[2025-10-24 09:45:30] Running tomorrow data.py and temp.py
[2025-10-24 09:45:30] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\data.py
[2025-10-24 09:45:30] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:45:32] Script finished: tomorrow\data.py returncode=0
[2025-10-24 09:45:32] STDOUT:
=== tomorrow予測データ取得開始 ===
データ更新・重複除去完了: data/juyo-2025.csv
データ更新・重複除去完了: data/juyo-2025.csv
最新日付: 2025-10-24 00:00:00
開始日付: 2025-10-17 00:00:00
予測日数: 7
tomorrow予測データセット作成完了: tomorrow/Ytest.csv (168行)
=== tomorrow予測データ取得完了 (実行時間: 0.54秒) ===

[2025-10-24 09:45:32] STDERR:
2025-10-24 09:45:31,551 - __main__ - INFO - main:697 - tomorrow予測データ取得開始
2025-10-24 09:45:31,551 - __main__ - INFO - data:352 - tomorrow予測データ取得開始
2025-10-24 09:45:31,551 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:45:31,551 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:45:31,551 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:45:31,566 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:45:31,566 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:45:31,566 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:45:31,777 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202510_power_usage.zip
2025-10-24 09:45:31,803 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:45:31,803 - __main__ - INFO - data:379 - 試行対象URL: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:45:31,803 - __main__ - INFO - data:380 - 試行対象ファイル: data/juyo-2025.csv
2025-10-24 09:45:31,803 - __main__ - INFO - wrapper:188 - 既存データ読み込み開始
2025-10-24 09:45:31,820 - __main__ - INFO - load_existing_data:288 - 既存データ読み込み完了: data/juyo-2025.csv (7,104行)
2025-10-24 09:45:31,820 - __main__ - INFO - wrapper:190 - 既存データ読み込み完了
2025-10-24 09:45:31,820 - __main__ - INFO - wrapper:188 - 最新データダウンロード・展開開始
2025-10-24 09:45:32,008 - __main__ - INFO - download_and_extract_latest_data:492 - ZIPファイルダウンロード・処理完了: https://www.tepco.co.jp/forecast/html/images/202509_power_usage.zip
2025-10-24 09:45:32,024 - __main__ - INFO - wrapper:190 - 最新データダウンロード・展開完了
2025-10-24 09:45:32,024 - __main__ - INFO - wrapper:188 - tomorrow予測データセット作成開始
2025-10-24 09:45:32,055 - __main__ - INFO - wrapper:188 - 温度データ処理・データセット作成開始
2025-10-24 09:45:32,055 - __main__ - INFO - wrapper:190 - 温度データ処理・データセット作成完了
2025-10-24 09:45:32,055 - __main__ - INFO - wrapper:190 - tomorrow予測データセット作成完了
2025-10-24 09:45:32,077 - __main__ - INFO - data:421 - tomorrow予測データ取得完了
2025-10-24 09:45:32,088 - __main__ - INFO - main:718 - tomorrow予測データ取得正常完了 (実行時間: 0.54秒)

[2025-10-24 09:45:32] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\temp.py
[2025-10-24 09:45:32] Child env subset: {'AI_TARGET_YEARS': None, 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:45:34] Script finished: tomorrow\temp.py returncode=0
[2025-10-24 09:45:34] STDOUT:
=== tomorrow気温データ取得・処理開始（パフォーマンス最適化版） ===
=== 処理完了 ===
実行時間: 1.058秒
メモリ使用量変化: +4.6MB (開始: 59.7MB → 終了: 64.3MB)
出力ファイル: tomorrow/tomorrow.csv

[2025-10-24 09:45:34] STDERR:
2025-10-24 09:45:32,992 - __main__ - INFO - main:440 - 開始時メモリ使用量: 59.7MB
2025-10-24 09:45:32,992 - __main__ - INFO - temp:405 - 気温データ取得処理開始
2025-10-24 09:45:32,992 - __main__ - INFO - wrapper:179 - 気温データAPI取得開始
2025-10-24 09:45:32,992 - __main__ - INFO - fetch_temperature_data:259 - API Request URL: https://api.open-meteo.com/v1/forecast?latitude=35.6785&longitude=139.6823&hourly=temperature_2m&timezone=Asia%2FTokyo&past_days=7&forecast_days=7
2025-10-24 09:45:34,035 - __main__ - INFO - wrapper:184 - 気温データAPI取得完了 (実行時間: 1.043秒)
2025-10-24 09:45:34,050 - __main__ - INFO - create_temperature_dataframe:323 - 気温データフレーム作成完了: 336行, カラム: ['MONTH', 'WEEK', 'HOUR', 'TEMP']
2025-10-24 09:45:34,050 - __main__ - INFO - wrapper:179 - CSV保存開始
2025-10-24 09:45:34,050 - __main__ - INFO - save_temperature_csv:365 - 気温データCSV保存完了: tomorrow/tomorrow.csv (0.01MB)
2025-10-24 09:45:34,050 - __main__ - INFO - wrapper:184 - CSV保存完了 (実行時間: 0.000秒)
2025-10-24 09:45:34,050 - __main__ - INFO - temp:418 - 気温データ取得処理完了 (実行時間: 1.058秒)

[2025-10-24 09:45:41] Received /run-tomorrow payload: {'model': 'RandomForest', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:45:41] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\RandomForest\RandomForest_tomorrow.py
[2025-10-24 09:45:41] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:45:44] Script finished: tomorrow\RandomForest\RandomForest_tomorrow.py returncode=0
[2025-10-24 09:45:44] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
RandomForest翌日電力需要予測 開始
============================================================
実行開始: RandomForest翌日予測メイン処理
実行開始: 学習・テスト・翌日データ読み込み
データ読み込み完了 - x_train: (23671, 4), y_test: (168,), x_tomorrow: (336, 4)
実行完了: 学習・テスト・翌日データ読み込み
実行時間: 0.064秒
メモリ使用量: 116.1MB → 118.3MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: データ標準化
データ標準化完了 - 学習データ: (23671, 4), 翌日データ: (336, 4)
実行完了: データ標準化
実行時間: 0.025秒
メモリ使用量: 118.3MB → 118.3MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForestモデル読み込み
RandomForestモデル読み込み完了: train/RandomForest/RandomForest_model.sav
実行完了: RandomForestモデル読み込み
実行時間: 0.328秒
メモリ使用量: 118.3MB → 306.1MB (差分: +187.8MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: RandomForest予測実行
テスト精度（R²スコア参考値）: 0.934
予測完了 - 予測結果形状: (336,)
実行完了: RandomForest予測実行
実行時間: 0.064秒
メモリ使用量: 306.1MB → 306.8MB (差分: +0.6MB)
ガベージコレクション: 56個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/RandomForest/RandomForest_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.031秒
メモリ使用量: 306.8MB → 306.8MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 103.417 kW, R2スコア: 0.9338, MAE: 80.473 kW
実行完了: 精度指標計算
実行時間: 0.031秒
メモリ使用量: 306.8MB → 306.8MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/RandomForest/RandomForest_tomorrow.png
実行完了: グラフ生成
実行時間: 0.622秒
メモリ使用量: 306.8MB → 324.4MB (差分: +17.6MB)
ガベージコレクション: 4216個のオブジェクトを回収
実行完了: RandomForest翌日予測メイン処理
実行時間: 1.195秒
メモリ使用量: 116.1MB → 142.8MB (差分: +26.7MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
RandomForest翌日電力需要予測 完了
(簡略表示) RMSE: 103.42 kW, R2スコア: 0.934
総実行時間: 1.195秒
============================================================

[2025-10-24 09:45:52] Received /run-tomorrow payload: {'model': 'PyCaret', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:45:52] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Pycaret\Pycaret_tomorrow.py
[2025-10-24 09:45:52] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:45:58] Script finished: tomorrow\Pycaret\Pycaret_tomorrow.py returncode=0
[2025-10-24 09:45:58] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
Pycaret翌日電力需要予測 開始
============================================================
実行開始: Pycaret翌日予測メイン処理
実行開始: テスト・翌日データ読み込み
データ読み込み完了 - y_test: (168,), x_tomorrow: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.050秒
メモリ使用量: 200.1MB → 200.8MB (差分: +0.7MB)
ガベージコレクション: 36個のオブジェクトを回収
実行開始: Pycaretモデル読み込み
Transformation Pipeline and Model Successfully Loaded
Pycaretモデル読み込み完了: train/Pycaret/Pycaret_model
実行完了: Pycaretモデル読み込み
実行時間: 0.096秒
メモリ使用量: 200.8MB → 202.7MB (差分: +1.9MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: Pycaret予測実行
予測完了 - 予測結果形状: (336,)
実行完了: Pycaret予測実行
実行時間: 0.157秒
メモリ使用量: 202.7MB → 203.2MB (差分: +0.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測結果保存
予測結果保存完了: tomorrow/Pycaret/Pycaret_tomorrow.csv (336行)
実行完了: 予測結果保存
実行時間: 0.063秒
メモリ使用量: 203.2MB → 203.3MB (差分: +0.1MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 精度指標計算
最終結果 - RMSE: 110.743 kW, R2スコア: 0.9240, MAE: 85.873 kW
実行完了: 精度指標計算
実行時間: 0.064秒
メモリ使用量: 203.3MB → 203.3MB (差分: +0.0MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/Pycaret/Pycaret_tomorrow.png
実行完了: グラフ生成
実行時間: 0.600秒
メモリ使用量: 203.3MB → 218.4MB (差分: +15.1MB)
ガベージコレクション: 4148個のオブジェクトを回収
実行完了: Pycaret翌日予測メイン処理
実行時間: 1.141秒
メモリ使用量: 200.1MB → 218.4MB (差分: +18.3MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
Pycaret翌日電力需要予測 完了
(簡略表示) RMSE: 110.74 kW, R2スコア: 0.924
総実行時間: 1.141秒
============================================================

[2025-10-24 09:46:06] Received /run-tomorrow payload: {'model': 'LightGBM', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:46:06] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\LightGBM\LightGBM_tomorrow.py
[2025-10-24 09:46:06] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:46:09] Script finished: tomorrow\LightGBM\LightGBM_tomorrow.py returncode=0
[2025-10-24 09:46:09] STDOUT:
AI_TARGET_YEARS=2022,2023,2024
============================================================
LightGBM翌日電力需要予測 開始
============================================================
実行開始: LightGBM翌日予測メイン処理
実行開始: 学習データ読み込み
学習データ形状: (23671, 4)
実行完了: 学習データ読み込み
実行時間: 0.032秒
メモリ使用量: 115.5MB → 117.9MB (差分: +2.4MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: テスト・翌日データ読み込み
テストデータ形状: (168,)
翌日データ形状: (336, 4)
実行完了: テスト・翌日データ読み込み
実行時間: 0.032秒
メモリ使用量: 117.9MB → 118.2MB (差分: +0.3MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: モデル読み込み
モデル読み込み完了: train/LightGBM/LightGBM_model.sav
実行完了: モデル読み込み
実行時間: 0.080秒
メモリ使用量: 118.2MB → 120.4MB (差分: +2.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: 予測実行
テスト精度: 0.9276
最終結果 - RMSE: 108.124 kW, R2: 0.9276, MAE: 83.510 kW
実行完了: 予測実行
実行時間: 0.032秒
メモリ使用量: 120.4MB → 120.6MB (差分: +0.2MB)
ガベージコレクション: 8個のオブジェクトを回収
実行開始: 翌日予測結果保存
予測結果保存完了: tomorrow/LightGBM/LightGBM_tomorrow.csv (336行)
実行完了: 翌日予測結果保存
実行時間: 0.046秒
メモリ使用量: 120.6MB → 120.8MB (差分: +0.2MB)
ガベージコレクション: 0個のオブジェクトを回収
実行開始: グラフ生成
グラフ保存完了: tomorrow/LightGBM/LightGBM_tomorrow.png
実行完了: グラフ生成
実行時間: 0.632秒
メモリ使用量: 120.8MB → 138.5MB (差分: +17.7MB)
ガベージコレクション: 4329個のオブジェクトを回収
実行完了: LightGBM翌日予測メイン処理
実行時間: 0.884秒
メモリ使用量: 115.5MB → 138.5MB (差分: +23.0MB)
ガベージコレクション: 0個のオブジェクトを回収
============================================================
LightGBM翌日電力需要予測 完了
最終結果 - RMSE: 108.12 kW, スコア: 0.96
総実行時間: 0.884秒
============================================================

[2025-10-24 09:46:17] Received /run-tomorrow payload: {'model': 'Keras', 'years': ['2022', '2023', '2024']}
[2025-10-24 09:46:17] Executing script: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.py
[2025-10-24 09:46:17] Child env subset: {'AI_TARGET_YEARS': '2022,2023,2024', 'PYTHONIOENCODING': 'utf-8'}
[2025-10-24 09:46:27] Script finished: tomorrow\Keras\Keras_tomorrow.py returncode=0
[2025-10-24 09:46:27] STDOUT:
psutil: 利用可能 - メモリ監視機能を有効化
Keras Tomorrow: パフォーマンス最適化設定を適用しました
TensorFlow: 利用可能
AI_TARGET_YEARS=2022,2023,2024
=== Keras Tomorrow プログラム開始 ===
開始時メモリ使用量: 300.6MB
=== Keras Tomorrow 電力需要予測開始（統一アーキテクチャ版） ===
[明日予測処理開始] メモリ使用量: 12.05 GB
[データ読み込み開始] メモリ使用量: 12.05 GB
訓練データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtrain.csv
テストデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Xtest.csv
ラベルデータを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\data\Ytrain.csv
[データ読み込み完了] メモリ使用量: 12.06 GB
学習データの読み込みが完了しました (実行時間: 0.016秒)
[OK] load_training_data 実行時間: 0.095秒
[テスト・明日データ読み込み開始] メモリ使用量: 12.06 GB
テストラベルを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Ytest.csv
明日予測用データを読み込んでいます: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\tomorrow.csv
[テスト・明日データ読み込み完了] メモリ使用量: 12.06 GB
テストデータと明日予測用データの読み込みが完了しました (実行時間: 0.000秒)
[OK] load_test_and_tomorrow_data 実行時間: 0.088秒
訓練済みモデルとスケーラーを読み込んでいます...
[モデル読み込み開始] メモリ使用量: 12.06 GB
モデルディレクトリ: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras
[OK] スケーラー読み込み成功: <class 'sklearn.preprocessing._data.StandardScaler'>
[WARN] H5モデル読み込み失敗（手法1）: 'utf-8' codec can't decode byte 0xe2 in position 33: invalid continuation byte
手法2: SAVファイル試行中...
SAVファイルサイズ: 369,034 bytes
[OK] SAVファイルからモデル読み込み成功（手法2）
[モデル読み込み完了] メモリ使用量: 12.07 GB
モデル読み込み完了 (実行時間: 0.211秒)
モデルタイプ: <class 'keras.src.engine.sequential.Sequential'>
スケーラータイプ: <class 'sklearn.preprocessing._data.StandardScaler'>
[OK] yスケーラー読み込み成功: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\train\Keras\Keras_model_y_scaler.pkl
[モデル読み込み完了] メモリ使用量: 12.07 GB
[予測処理開始] メモリ使用量: 12.07 GB
テストデータ標準化開始: (2631, 4)
翌日データ標準化開始: (336, 4)
[データ標準化完了] メモリ使用量: 12.06 GB
テストデータ予測実行中...
翌日データ予測実行中...
y_scalerが利用可能 - 自動スケール調整をスキップ
y_scalerで逆変換を適用しました
予測値範囲調整完了: テスト予測 2078-5000kW, 翌日予測 2090-3636kW
[予測処理完了] メモリ使用量: 12.08 GB
予測処理完了 (実行時間: 0.569秒)
テスト予測: (2631, 1), 翌日予測: (336, 1)
[OK] predict_with_model 実行時間: 0.576秒
[予測完了] メモリ使用量: 12.08 GB
[INFO] 評価計算: Ytomorrow_pred 336行のうち先頭168行を使用
評価指標を計算しています
ypred形状: (168, 1), ytest形状: (168, 1)
評価指標計算完了 (実行時間: 0.000秒)
最終結果 - RMSE: 99.865 kW, R2スコア: 0.9382, MAE: 74.031 kW
[CSV保存開始] メモリ使用量: 12.08 GB
明日の予測結果を保存しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
[CSV保存完了] メモリ使用量: 12.08 GB
明日の予測結果の保存が完了しました (実行時間: 0.010秒, サイズ: 0.00MB)
[OK] save_tomorrow_predictions 実行時間: 0.120秒
予測結果のグラフを作成しています: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.png
予測結果のグラフ作成が完了しました
[明日予測処理完了] メモリ使用量: 12.05 GB
明日の電力需要予測が完了しました: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
R2 Score: 0.9382
[OK] tomorrow 実行時間: 2.406秒
メモリ使用量変化: +58.4MB (開始: 300.6MB → 終了: 359.0MB)
=== 処理完了 ===
(簡略表示) RMSE: 99.865 kW, R2スコア: 0.9382
実行時間: 2.406秒
出力ファイル: c:\Users\J1921604\Obsidian\AIモデル体感コース\01_実績\05_電力需要予測AIモデル構築_v3\AI\tomorrow\Keras\Keras_tomorrow.csv
=== Keras Tomorrow プログラム正常終了 ===

[2025-10-24 09:46:27] STDERR:
WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

WARNING:tensorflow:From C:\Users\J1921604\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend.py:277: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.


