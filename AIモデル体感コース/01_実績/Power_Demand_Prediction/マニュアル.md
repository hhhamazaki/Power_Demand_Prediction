# Power_Demand_Prediction デプロイ完全マニュアル

**最終更新:** 2025年10月20日
**公開URL:** https://hhhamazaki.github.io/Power_Demand_Prediction/

## ダッシュボードの使い方

1. ページを開く: 公開URLにアクセス
2. モデルを選択: Keras/LightGBM/Pycaret/RandomForest
3. グラフを確認: 左側に明日の予測、右側に学習結果
4. メトリクスを確認: RMSE, R2, MAE
5. グラフを拡大: クリックで全画面表示

### Pyodide機能

- データ処理: 学習年を選択してデータ前処理
- 学習: モデル訓練
- 最新データ取得: 東京電力データ取得
- 予測: 明日24時間の電力需要予測
- 組み合わせ検証: 最適な学習年探索

注意: Pyodide初回起動は50MB以上のダウンロードが必要

## 初回デプロイ手順

### 準備

- docsフォルダ: index.html, data/, train/, tomorrow/

### デプロイ実行

powershell

# 一時ディレクトリ作成

$tmp = "$env:TEMP\deploy_$(Get-Date -Format 'yyyyMMddHHmmss')"
New-Item -ItemType Directory -Path $tmp -Force
Copy-Item ".\docs\*" -Destination $tmp -Recurse -Force
cd $tmp
Get-ChildItem -Recurse -Include *.h5,*.pkl,*.sav | Remove-Item -Force
git init
git add .
git commit -m "初回デプロイ"
git remote add origin https://github.com/`<USER>`/`<REPO>`.git
git branch -M main
git push -f origin main

### GitHub Pages設定

1. Settings  Pages
2. Source: "Deploy from a branch"
3. Branch: "main" / Folder: "/ (root)"
4. Save
5. 5-10分待機後、公開URLにアクセス

## docs更新後のデプロイ

powershell
cd "c:\Users\\Power_Demand_Prediction"
git add docs/; git commit -m "更新"; git push origin main
$tmp = "$env:TEMP\deploy_$(Get-Date -Format 'yyyyMMddHHmmss')"
New-Item -ItemType Directory -Path $tmp -Force
Copy-Item ".\docs\*" -Destination $tmp -Recurse -Force
cd $tmp
Get-ChildItem -Recurse -Include *.h5,*.pkl,*.sav | Remove-Item -Force
git init; git add .; git commit -m "更新"
git remote add origin https://github.com/hhhamazaki/Power_Demand_Prediction.git
git branch -M main; git push -f origin main

## FAQ

**Q1: Pyodideが遅い**  初回50MB以上DL必要
**Q2: グラフ非表示**  パス確認、Ctrl+Shift+Rでキャッシュクリア
**Q3: 指標「-」表示**  CSV存在確認
**Q4: docs/**  可視化(公開)
**Q5: 古いバージョン表示**  Ctrl+Shift+R、最大15分待機
**Q6: モデル追加**  docs内にフォルダ配置、index.htmlにボタン追加
**Q7: 403エラー**  リポジトリPublic設定確認
**Q8: 文字化け**  UTF-8 (BOM無し)で保存

## ファイル構成

デプロイファイル(51個、5.4MB):

- index.html, data/(X.csv等), train/4モデル/, tomorrow/4モデル/

除外ファイル(ローカルのみ):

- train/*.h5, *.pkl, *.sav (GitHub 100MB制限対応)

## トラブルシューティング

- HTTP 408: `git config http.postBuffer 524288000`
- 100MB超過: モデルファイル除外して再プッシュ
- 真っ白: F12でConsole確認、Pyodide CDN確認
- Pyodide動作しない: 10-30秒待機、`pyodideReady`確認

## サポート

- Pyodide: https://pyodide.org/
- GitHub Pages: https://docs.github.com/ja/pages
- Chart.js: https://www.chartjs.org/
