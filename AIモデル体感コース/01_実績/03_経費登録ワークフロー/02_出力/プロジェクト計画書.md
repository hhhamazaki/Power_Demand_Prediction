# 経費登録ワークフロー自動化システム開発 - プロジェクト計画書

※ この資料は教育用のサンプルです。

## 1. 目的・背景

経理部門における月次経費登録業務（500件/月）において、手動入力による40時間/月の工数と10-15件/月の入力ミスが恒常的に発生し、業務効率化とデジタル変革（DX）推進が急務となっている状況の解決を図る。

経理部門における月次経費登録業務の効率化と正確性向上を目的とし、手動入力による工数と入力ミスを削減する。本プロジェクトでは、複数のAIモデル（Claude Sonnet 3.5/4.0, GPT-4.1/5）を搭載したPythonベースの自動化システムを構築し、柔軟かつ高精度な処理を実現する。

### 1.1. 成果物
| 成果物カテゴリ | 成果物名 | 責任者 | 納期 |
|---------------|----------|--------|------|
| システム開発 | 経費登録自動化システム | 開発リーダー | 2025-09-30 |
| 技術仕様書 | システム仕様書・運用手順書 | シニアエンジニア | 2025-09-25 |
| テスト成果物 | テスト仕様書・テスト結果報告書 | QAエンジニア | 2025-09-28 |
| 運用ドキュメント | 運用マニュアル・障害対応手順書 | 運用責任者 | 2025-10-05 |

## 2. ステークホルダー/体制

### 2.1. 関係者・体制
```text
プロジェクトマネージャー（1名）
├── 業務責任者（1名）- 経理部門
├── 開発チーム（3名）
│   ├── 開発リーダー（1名）- Python・Selenium専門
│   ├── シニアエンジニア（1名）- AI統合・アーキテクチャ
│   └── エンジニア（1名）- フロントエンド・UI
├── QAチーム（2名）
│   ├── QAマネージャー（1名）- テスト設計
│   └── QAエンジニア（1名）- テスト実行
└── 運用チーム（2名）
    ├── 運用責任者（1名）- インフラ・運用設計
    └── 運用エンジニア（1名）- 監視・保守
```

### 2.2. RACI責任分担表
| 作業項目 | PM | 業務責任者 | 開発リーダー | QAマネージャー | 運用責任者 |
|----------|----|-----------|---------    |---------------|-----------| 
| 要件定義 | A | R | C | I | I |
| 基本設計 | A | C | R | I | C |
| 詳細設計 | C | I | R | C | I |
| 開発・実装 | A | I | R | I | I |
| テスト設計 | C | I | C | R | I |
| テスト実行 | I | I | C | R | I |
| 運用移行 | A | C | C | I | R |

## 3. スコープ

- 対象: Excelファイル（data.xlsx）をインプットとした、Web経費登録システムへの自動データ入力処理
- 対象外: 経費の承認フロー、およびWebアプリケーション自体の開発

## 4. マイルストーン・スケジュール

### 4.1. 全体スケジュール
| フェーズ | 期間 | 主要成果物 | 承認者 |
|---------|------|-----------|--------|
| Phase1: 要件定義・設計 | 2025-08-29 - 2025-09-06 | 基本設計書・詳細設計書 | プロジェクトマネージャー |
| Phase2: 開発・実装 | 2025-09-07 - 2025-09-20 | 自動化システム | 開発リーダー |
| Phase3: テスト・検証 | 2025-09-21 - 2025-09-30 | テスト完了・品質保証 | QAマネージャー |
| Phase4: 運用移行 | 2025-10-01 - 2025-10-07 | 本番稼働・運用開始 | 業務責任者 |

### 4.2. 技術マイルストーン
- 設定クラス実装：2025-09-10
- robust_automationデコレータ：2025-09-12
- AI統合モジュール：2025-09-18
- Webオートメーション：2025-09-22
- 総合テスト完了：2025-09-30

## 5. リスク/課題管理

### 5.1. 主要リスク分析
| リスクカテゴリ | リスク項目 | 影響度 | 発生確率 | 対策・軽減策 |
|---------------|----------|-------|----------|-------------|
| 技術リスク | AI統合の複雑性 | 高 | 中 | プロトタイプ早期作成・段階的実装 |
| 技術リスク | Selenium安定性 | 中 | 中 | WebDriverManager・自動復旧機能 |
| 業務リスク | 要件変更 | 高 | 中 | アジャイル手法・段階的デリバリー |
| 業務リスク | ユーザー受入 | 中 | 低 | 早期プロトタイプ・ユーザーフィードバック |
| 外部リスク | expenseSystem仕様変更 | 高 | 低 | 設定外部化・アダプターパターン |
| 組織リスク | リソース不足 | 中 | 中 | スキル共有・外部サポート活用 |

### 5.2. 技術的対策
- WebDriver自動管理: Selenium 4内蔵ドライバマネージャの活用
- 要素検索: 複数セレクタによる堅牢な検索ロジック
- エラー処理: リトライ機構付き安全操作の実装
- 設定外部化: @dataclass による統一設定管理

| リスクカテゴリ | リスク項目 | 影響度 | 発生確率 | 対策・軽減策 |
|:-------------|:----------|:------:|:--------:|:------------|
| 技術リスク | WebサイトのUI変更 | 高 | 中 | 複数のセレクタ（ID, XPath, CSS）を併用し、堅牢な要素特定ロジックを実装する |
| 技術リスク | WebDriverの互換性問題 | 中 | 中 | Selenium Managerの標準機能を利用し、WebDriverを自動管理する |
| データリスク | Excelデータのフォーマット不正 | 中 | 低 | データ読み込み時に必須カラムの存在検証や、データ型の事前チェックを行う |

## 6. 品質計画

### 6.1. 品質メトリクス
- 機能品質: 機能要件充足率 99%以上
- 性能品質: 処理速度 80%向上・成功率 99.5%以上
- 保守性: コード品質スコア A評価以上
- 信頼性: 稼働率 99.9%以上

### 6.2. 品質管理プロセス
1. 設計レビュー: アーキテクチャ・詳細設計の品質確認
2. コードレビュー: ペアプログラミング・静的解析
3. テスト段階: 単体→結合→システム→受入テスト
4. 品質ゲート: 各マイルストーンでの品質基準クリア

- 品質目標: 処理成功率99.5%以上、手動操作と比較して90%の作業時間削減
- テスト戦略: 各AIモデルのスクリプトに対して、単体テスト（test_basic_functionality）および手動でのE2Eテストを実施する

## 7. コミュニケーション計画

### 7.1. 定期会議体
| 会議名 | 頻度 | 参加者 | 目的 |
|--------|------|--------|------|
| プロジェクト定例 | 週次 | 全メンバー | 進捗報告・課題共有 |
| 技術レビュー | 隔週 | 開発チーム・QA | 技術課題・品質確認 |
| ステアリング委員会 | 月次 | PM・業務責任者・経営陣 | 方針決定・承認 |

### 7.2. 報告・情報共有
- 日次: 開発チーム内でのスタンドアップミーティング
- 週次: プロジェクト全体の進捗・リスク状況報告
- 月次: 経営陣への成果・ROI報告

## 8. 変更管理・構成管理

### 8.1. 変更管理プロセス
1. 変更要求書（CCR）提出: 影響分析・工数見積
2. 変更制御委員会（CCB）承認: 優先度・承認判定
3. 実装・テスト・デプロイ: 段階的実装・品質確認

### 8.2. 構成管理
- Git: ソースコード管理・ブランチ戦略
- 版数管理: セマンティックバージョニング（v1.x.x）
- 環境管理: 開発・テスト・本番環境分離

- ソースコード管理: Gitを利用（本プロジェクトでは直接示されていない）
- 構成管理: pyフォルダ内にAIモデル別のスクリプトを配置し、機能と責任を明確に分離する

## 9. 依存関係・前提条件・制約

### 9.1. 依存関係管理

- 前提条件: Python 3.10以上、Microsoft Edgeブラウザがインストールされていること
- 依存関係: requirements.txtに記載されたライブラリがpipによってインストールされていること

```txt
requests>=2.28.0
pandas>=1.5.0
openpyxl>=3.0.10
selenium>=4.10.0
webdriver-manager>=4.0.0
urllib3>=1.26.0
```

## 10. 付録

### 10.1. 技術アーキテクチャ設計

#### 統一アーキテクチャ原則
4つのAIモデル統合実装による統一設定管理：

```python
@dataclass
class ExpenseConfig:
    """統一設定管理クラス"""
    excel_file_path: str
    web_url: str
    timeout_seconds: int = 30
    max_retry_count: int = 3
    log_level: str = "INFO"
    
    def __post_init__(self):
        """設定値バリデーション"""
        if not Path(self.excel_file_path).exists():
            raise FileNotFoundError(f"Excelファイルが見つかりません: {self.excel_file_path}")
```

#### 統一エラーハンドリング
```python
def robust_automation(max_retries: int = 3, delay: float = 1.0):
    """統一エラーハンドリングデコレータ"""
    def decorator(func):
        @functools.wraps(func)
        def wrapper(*args, **kwargs):
            for attempt in range(max_retries):
                try:
                    return func(*args, **kwargs)
                except Exception as e:
                    if attempt == max_retries - 1:
                        logger.error(f"最大試行回数に達しました: {e}")
                        raise
                    time.sleep(delay * (2 ** attempt))
            return None
        return wrapper
    return decorator
```

#### AIモデル選択戦略
- Claude Sonnet 3.5: 汎用型・高速処理（7.25秒/3件）
- Claude Sonnet 4.0: 高精度・複雑処理（10.50秒/3件）
- GPT-4.1: バランス型・安定稼働（9.76秒/3件）
- GPT-5: 次世代型・高度AI機能（9.00秒/3件）

### 10.2. ROI・成果予測

#### 定量効果
- 年間コスト削減効果: 238.4万円
- 投資回収期間: 約9ヶ月
- ROI: 32.4%
- 作業時間削減: 40時間/月 → 4時間/月（90%削減）

#### 定性効果
- 業務品質向上（入力ミス削減）
- 従業員満足度向上（単純作業からの解放）
- DX推進による競争力強化
- 内部統制強化（処理ログ・監査証跡）

### 10.3. プロジェクト成功基準

#### 技術的成功基準
- 4つのAIモデル（Claude Sonnet 3.5・4.0、GPT-4.1・5）の安定稼働
- 処理成功率98.5%以上の達成
- エラー発生率1.5%以下の維持
- メモリ使用量37.5%削減の実現

#### ビジネス成功基準
- 月次経費登録業務の90%自動化実現
- 入力ミス率95%削減の達成
- ユーザー満足度80%以上の確保
- 9ヶ月以内の投資回収達成

#### 品質成功基準
- コード品質スコアA評価以上
- システム稼働率99.9%以上
- セキュリティ脆弱性ゼロ件の維持
- 保守性・拡張性の確保

### 10.4. pyフォルダアーキテクチャ解析

#### AIモデル別実装構成
```
py/
├── 経費登録_claude_sonnet_3.5.py（汎用型・高速処理）
├── 経費登録_claude_sonnet_4.py（高精度・複雑処理）
├── 経費登録_gpt-4.1.py（バランス型・安定稼働）
└── 経費登録_gpt-5.py（次世代型・高度AI機能）
```

#### 統一アーキテクチャ特徴
- 設定管理: @dataclass による統一設定クラス
- エラーハンドリング: robust_automation デコレータ
- ログ管理: 統一ログフォーマット・レベル設定
- パフォーマンス: メモリ最適化・処理時間計測
- 拡張性: モジュラー設計・プラグイン対応

#### AIモデル性能比較
| モデル | 処理時間 | 精度 | メモリ使用量 | 適用場面 |
|--------|----------|------|------------|----------|
| Claude Sonnet 3.5 | 7.25秒 | 98%以上 | 標準 | 大量バッチ処理 |
| Claude Sonnet 4.0 | 10.50秒 | 99.5%以上 | 高 | 重要データ処理 |
| GPT-4.1 | 9.76秒 | 99%以上 | 標準 | 日常業務処理 |
| GPT-5 | 9.00秒 | 99.5%以上 | 高 | 先進的処理 |

### 10.5. マルチAIモデルアーキテクチャ

本プロジェクトでは、特性の異なる4つのAIモデルを実装し、用途に応じた選択を可能とするアーキテクチャを採用している。

- 経費登録_claude_sonnet_3.5.py: 速度とコストのバランスを重視したモデル
- 経費登録_claude_sonnet_4.py: 堅牢なエラーハンドリングと最適化されたExcel操作を特徴とする高信頼性モデル
- 経費登録_gpt-4.1.py: 安定性と汎用性を重視した、標準的な実装モデル
- 経費登録_gpt-5.py: dataclassesによる構造化された設定管理など、先進的な機能を取り入れた拡張性の高いモデル

### 10.6. 共通ロジック

全スクリプトで共通して以下の処理フローが実装されている。

1. ファイル準備: data.xlsxの存在を確認し、なければダウンロードする
2. データ読み込み: pandasでExcelファイルを読み込む
3. Web自動化: seleniumでブラウザを操作し、データを一件ずつ登録する
4. 結果書き込み: openpyxlで登録コードをExcelに書き戻す
5. 結果通知: tkinterで処理完了メッセージを表示する
