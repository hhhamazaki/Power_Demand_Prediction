# 電力需要予測AIモデル構築 - 使用手順書 v3.0

※ この資料は教育用のサンプルです。

**バージョン**: v3.0  
**リリース日**: 2025年10月25日  
**主要特性**: CLI + Webダッシュボード + 組み合わせ検証統合版

---

## 1. システム概要

本システムは、Pythonベースの機械学習・深層学習環境で動作する。v3.0では、**従来のCLI操作に加え、Webダッシュボードによるブラウザ操作、および組み合わせ検証機能による最適学習年自動探索**を提供する。

### 1.1. 適用範囲と前提
本手順書は、VS CodeとPythonを使用した開発環境のセットアップ、および電力需要予測AIモデルの実行方法（CLI・WebUI・組み合わせ検証）について記述する。

#### 1.1.1. VS Code
- 推奨バージョン: 最新安定版（定期更新推奨）
- 対象OS: Windows 10/11（PowerShell使用）
- インストール元: [VS Code公式サイト](https://code.visualstudio.com/)

#### 1.1.2. Python
- 推奨バージョン: 3.10.11（全プロジェクト統一、v1.0・v2.0と同一）
- インストール元: [python.org 公式サイト](https://www.python.org/downloads/release/python-31011/)
    Filesの「Windows installer (64-bit)」をクリックしてインストーラー（python-3.10.11-amd64.exeファイル）をダウンロードする。

#### 1.1.3. Webブラウザ（v2.0・v3.0）
- 推奨ブラウザ: Chrome/Firefox/Edge最新版
- Webダッシュボード用（ダークモード対応、HTML5/CSS3標準準拠）

## 2. 動作環境

### 2.1. 環境セットアップ

#### 2.1.1. VS Codeでフォルダを開く

1.  VS Codeを起動する。
2.  `Ctrl + K, Ctrl + O` または「ファイル」→「フォルダーを開く」を選択する。
3.  以下のパスを指定して開く（要注意！）。
    `C:\Users\<UserName>\<project_root>\05_電力需要予測AIモデル構築\AI`

#### 2.1.2. PowerShellターミナルを開く

1. VS Codeで `Ctrl + Shift + P` を押す。
2. 「Terminal: Create New Terminal」を選択する。
3. ターミナルが表示されることを確認する。

#### 2.1.3. Python環境設定

```powershell
# Python バージョン確認（3.10.11必須）
py -3.10 --version
# 結果例: Python 3.10.11

# 仮想環境作成（推奨・Python 3.10.11指定）
py -3.10 -m venv .venv

# 仮想環境を有効化
.\.venv\Scripts\Activate.ps1
# コマンドライン先頭に (.venv) が表示されることを確認

# 仮想環境Python バージョン確認（3.10.11必須）
.\.venv\Scripts\python.exe --version
# 結果例: Python 3.10.11
```

#### 2.1.4. VS Code Pythonインタープリターの選択

1. `Ctrl+Shift+P`でコマンドパレットを開く
2. 「Python: Select Interpreter」と入力して選択する
3. 作成した仮想環境の`.venv\Scripts\python.exe` を選択する

## 3. インストール/セットアップ手順

### 3.1. pip自体の最新化
```powershell
py -3.10 -m pip install --upgrade pip
```

### 3.2. 全モデル対応の完全版インストール（v1.0・v2.0と同一）
```powershell
pip install -r requirements.txt
```

**v3.0での変更**: なし（requirements.txtはv1.0・v2.0と完全同一、追加ライブラリなし、組み合わせ検証はPython標準ライブラリのみで実装）

環境をリセットしたい場合は、`.venv`フォルダを削除する

## 4. 初期設定

- 学習用データ（例: `juyo-YYYY.csv`, `temperature-YYYY.csv`）を`AI/data`フォルダに配置する
- 予測対象のデータ（例: `tomorrow.csv`）を`AI/tomorrow`フォルダに配置する

## 5. 基本操作

### 5.1. v3.0推奨: 組み合わせ検証機能（初心者・技術者共通）

#### 5.1.1. 組み合わせ検証の概要

**目的**: 最適な学習年組み合わせを自動探索し、予測精度を最大化する

**実行内容**:
- ローリング時系列交差検証（2年学習→1年テスト）
- 7組み合わせ自動実行（2016,2017→2018 ～ 2022,2023→2024）
- RMSE/R2/MAE自動記録・比較
- 上位5組み合わせ表示
- 2025年予測推奨組み合わせ自動提示

**処理時間**:
- LightGBM: 約5分
- PyCaret: 約8分
- RandomForest: 約12分
- Keras: 約30分

#### 5.1.2. Webダッシュボード経由での組み合わせ検証

**手順**:
1. HTTPサーバー起動（1回のみ）
```powershell
cd AI
py -3.10 server.py
```

2. ブラウザ自動起動（http://localhost:8002/）

3. Webダッシュボードでモデル選択
   - [LightGBM]ボタンをクリック

4. 組み合わせ検証実行（★v3.0新機能）
   - [組み合わせ検証シミュレーション]ボタンをクリック
   - 実行中: マゼンタ系発光アニメーション
   - 所要時間: 約5分（LightGBM）

5. 結果自動表示
   - テキストファイル自動生成: `2025-10-XX_LightGBM_optimize_years.txt`
   - メモ帳自動オープン
   - アラート表示: 「組み合わせ検証終了」

6. 結果確認
```text
================================================================================
LightGBMモデル - 学習年組み合わせ最適化結果
================================================================================

【上位5組み合わせ（RMSE基準）】

1位: 学習年 2016,2017 → テスト年 2018
   RMSE: 152.582 kW ★最優秀
   R²: 0.9120
   MAE: 100.423 kW

2位: 学習年 2022,2023 → テスト年 2024
   RMSE: 165.619 kW
   R²: 0.9193
   MAE: 107.717 kW

🎯 2025年電力需要予測 - 最適学習年組み合わせ推奨
推奨: 学習年 2022,2023,2024 → テスト年 2025
推定RMSE: 165-175 kW
```

7. 推奨組み合わせで学習実行
   - [2022][2023][2024]ボタンをクリック（推奨年選択）
   - [データ処理]ボタン → 実行完了を待つ
   - [学習]ボタン → 実行完了を待つ（緑ネオン発光）
   - 結果自動表示: RMSE/R2/MAE、グラフ（16:9）

#### 5.1.3. CLI経由での組み合わせ検証

**手順**:
```powershell
# AIフォルダで実行
cd AI

# LightGBM組み合わせ検証（約5分）
py -3.10 train\LightGBM\LightGBM_optimize_years.py

# 実行結果
# - 7組み合わせ自動実行
# - 結果を 2025-10-XX_LightGBM_optimize_years.txt に保存
# - メモ帳自動オープン
# - 上位5組み合わせ表示
# - 2025年予測推奨組み合わせ表示
```

**他モデルの組み合わせ検証**:
```powershell
# Keras（約30分）
py -3.10 train\Keras\Keras_optimize_years.py

# PyCaret（約8分）
py -3.10 train\Pycaret\Pycaret_optimize_years.py

# RandomForest（約12分）
py -3.10 train\RandomForest\RandomForest_optimize_years.py
```

#### 5.1.4. 推奨組み合わせで学習実行（CLI）

組み合わせ検証結果に基づき、推奨組み合わせで学習を実行する。

```powershell
# 環境変数で推奨年を設定（例: 2022,2023,2024）
$env:AI_TARGET_YEARS = "2022,2023,2024"

# データ処理実行
py -3.10 data\data.py

# モデル学習実行
py -3.10 train\LightGBM\LightGBM_train.py

# 結果確認
# - RMSE/R2/MAE表示
# - グラフ生成（LightGBM_Ypred.png）
```

### 5.2. v2.0推奨: Webダッシュボード操作（日常運用）

#### 5.2.1. HTTPサーバー起動

v2.0と同一（詳細はv2.0使用手順書参照）。

#### 5.2.2. Webダッシュボード操作

v2.0と同一（詳細はv2.0使用手順書参照）。

**v3.0追加機能**:
- **組み合わせ検証ボタン**: [組み合わせ検証シミュレーション]
  - 最適学習年を自動探索（5-30分）
  - 結果ファイル自動生成・メモ帳自動オープン
  - 推奨組み合わせ提示

### 5.3. localStorage機能の利用（v3.0新機能）

#### 5.3.1. localStorage機能の概要

**目的**: ユーザーが選択した学習年の組み合わせをブラウザに保存し、ページリロード後も自動復元する。

**主な特徴**:
- **モデル別記憶**: 各AIモデル（LightGBM、Keras、PyCaret、RandomForest）で異なる学習年を個別に記憶
- **即時保存**: 学習年ボタンをクリックした瞬間に即座に保存
- **自動復元**: ページリロード時やモデル切り替え時に自動的に復元
- **視覚的一貫性**: ボタンの光るエフェクト（glow/inverted状態）も完全に保持
- **後方互換性**: localStorage非対応環境でもエラーなく動作

#### 5.3.2. localStorage機能の動作

##### 初回ロード時
- 各モデルで保存データがない場合は全年選択（従来動作）
- localStorageに保存データがある場合は自動的に復元

##### 学習年選択時
1. 学習年ボタン（例: [2022]）をクリック
2. 選択状態がトグル（選択⇔解除）
3. **即座にlocalStorageに保存**（自動、ユーザー操作不要）
4. ボタンの視覚的状態（光るエフェクト）が更新

##### データ処理/学習実行時
1. [データ処理]または[学習]ボタンをクリック
2. **実行前に現在の選択状態を自動保存**
3. データ処理/学習を実行
4. 次回起動時に同じ学習年が選択された状態で復元

##### モデル切り替え時
1. モデル選択ボタン（例: [Keras]）をクリック
2. **新しいモデルの保存データを自動復元**
3. 各モデルで独立した学習年を記憶
   - 例: LightGBMで[2023][2024]を選択 → Kerasに切り替え → Kerasの保存データ（例: [2022][2023][2024]）を復元

##### ページリロード時
1. ブラウザをリロード（F5キー、または再起動）
2. **localStorageから自動的に学習年を復元**
3. 最後に選択していたモデルと学習年が完全に再現
4. ボタンの視覚的状態（光るエフェクト）も完全に復元

#### 5.3.3. localStorage機能の実用例

##### 例1: 作業中断後の再開
**シナリオ**: 組み合わせ検証結果を確認し、推奨年を選択したが、ブラウザを閉じてしまった

**従来（v2.0以前）**:
1. ブラウザ再起動
2. 組み合わせ検証結果ファイルを再確認
3. 推奨年（例: 2022,2023,2024）を手動で再選択（3回クリック）

**v3.0（localStorage）**:
1. ブラウザ再起動
2. **自動的に推奨年（2022,2023,2024）が選択された状態で復元**
3. すぐに[データ処理]→[学習]を実行可能

**メリット**: 操作手順3ステップ → 1ステップ（67%削減）

##### 例2: 複数モデルで異なる学習年を試行
**シナリオ**: LightGBMで2023-2024、Kerasで2022-2024を試したい

**従来（v2.0以前）**:
1. LightGBMで[2023][2024]選択 → 学習実行
2. Kerasに切り替え → 学習年が全年選択にリセット
3. [2022][2023][2024]を手動で再選択（3回クリック）
4. Keras学習実行
5. LightGBMに戻る → 学習年が全年選択にリセット
6. [2023][2024]を手動で再選択（2回クリック）

**v3.0（localStorage）**:
1. LightGBMで[2023][2024]選択 → 学習実行
2. Kerasに切り替え → **自動的に前回のKeras選択状態を復元**
3. （初回のみ）[2022][2023][2024]を選択（3回クリック）
4. Keras学習実行
5. LightGBMに戻る → **自動的に[2023][2024]が選択された状態で復元**

**メリット**: モデル切り替え毎の再選択が不要

##### 例3: 長期間のモデル評価
**シナリオ**: 1週間かけて各モデルで最適な学習年を探索

**従来（v2.0以前）**:
- 毎日ブラウザを開くたびに、前日の選択状態を記憶しておく必要がある
- Excelやメモに記録（手間がかかる）

**v3.0（localStorage）**:
- **ブラウザが自動的に前日の選択状態を記憶**
- モデル別に独立した学習年を保持
- 作業ログが不要（localStorageが自動記録）

**メリット**: 作業ログ記録の手間がゼロ

#### 5.3.4. localStorage機能のデバッグ

localStorageの保存/復元内容を確認したい場合は、ブラウザの開発者ツールで確認できる。

```javascript
// 開発者ツールのコンソールで実行

// 全localStorageキーを表示
Object.keys(localStorage).filter(k => k.startsWith('ai_training_years_'));

// LightGBMの保存データを表示
console.log(localStorage.getItem('ai_training_years_LightGBM'));
// 例: "[2022,2023,2024]"

// 全モデルの保存データを表示
['LightGBM', 'Keras', 'PyCaret', 'RandomForest'].forEach(model => {
    const key = `ai_training_years_${model}`;
    const data = localStorage.getItem(key);
    console.log(`${key}: ${data}`);
});
```

**出力例**:
```
ai_training_years_LightGBM: [2023,2024]
ai_training_years_Keras: [2022,2023,2024]
ai_training_years_PyCaret: null
ai_training_years_RandomForest: [2022,2023,2024]
```

#### 5.3.5. localStorageのクリア

保存データをリセットしたい場合は、以下の方法でクリアできる。

**方法1: ブラウザ開発者ツール**
1. F12キーで開発者ツールを開く
2. 「Application」タブ（Chromeの場合）または「ストレージ」タブ（Firefoxの場合）を選択
3. 「Local Storage」→ `http://localhost:8002` を選択
4. 削除したいキー（例: `ai_training_years_LightGBM`）を右クリック → 「削除」

**方法2: コンソールで実行**
```javascript
// 全モデルのlocalStorageをクリア
['LightGBM', 'Keras', 'PyCaret', 'RandomForest'].forEach(model => {
    localStorage.removeItem(`ai_training_years_${model}`);
});

// または、全localStorageをクリア（警告: 他のデータも削除されます）
localStorage.clear();
```

**方法3: ブラウザのキャッシュクリア**
1. ブラウザの設定を開く
2. 「プライバシーとセキュリティ」→「閲覧履歴データの削除」
3. 「Cookieと他のサイトデータ」を選択
4. 「データを削除」をクリック

### 5.4. v1.0互換: CLI操作（技術者向け）

#### 5.4.1. データ前処理・学習フェーズ

v1.0・v2.0と同一（詳細はv1.0・v2.0使用手順書参照）。

##### 5.4.1.1. データ前処理実行
```powershell
# 電力需要・気温データの統合処理（全年）
py -3.10 .\data\data.py

# 特定年のみ処理（v2.0機能: コマンドライン引数）
py -3.10 .\data\data.py 2022,2023,2024

# 環境変数による年指定（v2.0機能）
$env:AI_TARGET_YEARS = "2022,2023,2024"
py -3.10 .\data\data.py
```

##### 5.4.1.2. 各種AIモデル学習実行
```powershell
# Keras深層学習モデル
py -3.10 .\train\Keras\Keras_train.py 2022,2023,2024

# LightGBM勾配ブースティングモデル
py -3.10 .\train\LightGBM\LightGBM_train.py 2022,2023,2024

# PyCaret自動機械学習モデル
py -3.10 .\train\Pycaret\Pycaret_train.py 2022,2023,2024

# RandomForestアンサンブルモデル
py -3.10 .\train\RandomForest\RandomForest_train.py 2022,2023,2024
```

#### 5.4.2. 翌日予測フェーズ（v1.0・v2.0と同一）

v1.0・v2.0と同一（詳細はv1.0・v2.0使用手順書参照）。

## 6. 高度な操作

### 6.1. 組み合わせ検証結果の分析（v3.0新機能）

#### 6.1.1. 結果ファイルの確認

組み合わせ検証実行後、以下のファイルが自動生成される。

**ファイル名**: `2025-10-XX_{ModelName}_optimize_years.txt`
**保存場所**: `AI/train/{ModelName}/` または `AI/`ルート
**エンコーディング**: UTF-8

**ファイル内容例**:
```text
================================================================================
LightGBMモデル - 学習年組み合わせ最適化結果
実行日時: 2025-10-19 15:23:45
================================================================================

総実行回数: 7
成功回数: 7
失敗回数: 0

【全組み合わせ結果（RMSE昇順）】

1位: 学習年 2016,2017 → テスト年 2018
   RMSE: 152.582 kW (★最優秀)
   R²: 0.9120
   MAE: 100.423 kW
   実行時間: 14.2秒

【統計情報】
RMSE - 平均: 169.1, 標準偏差: 13.2, 最小: 152.6, 最大: 195.4
R² - 平均: 0.9099, 標準偏差: 0.0088
MAE - 平均: 110.1, 標準偏差: 8.9

🎯 2025年電力需要予測 - 最適学習年組み合わせ推奨

推奨組み合わせ: 学習年 2022,2023,2024 → テスト年 2025
推定RMSE: 165-175 kW
根拠: 上位5組の平均RMSE: 169.1 kW
```

#### 6.1.2. 結果の解釈

**上位組み合わせの特徴**:
- **全モデル共通**: 最優秀は2016,2017→2018（RMSE最小）
- **最近年組み合わせ**: 2022,2023→2024が2位（2025年予測に推奨）
- **RMSE範囲**: 152.6～195.4 kW（42.8 kWの差）

**2025年予測の推奨根拠**:
- 最近年データ（2022,2023,2024）を使用
- 上位組み合わせの平均RMSE（約169 kW）を基準
- 標準偏差を考慮した推定範囲（165-175 kW）

#### 6.1.3. 複数モデル比較

全4モデルで組み合わせ検証を実行し、最優秀モデルを選定する。

```powershell
# 全モデル組み合わせ検証実行（順次実行、合計約55分）
py -3.10 train\LightGBM\LightGBM_optimize_years.py      # 約5分
py -3.10 train\Pycaret\Pycaret_optimize_years.py        # 約8分
py -3.10 train\RandomForest\RandomForest_optimize_years.py  # 約12分
py -3.10 train\Keras\Keras_optimize_years.py            # 約30分

# 結果比較（各モデルの結果ファイルを開いて比較）
# LightGBM: RMSE 152.6 kW（最優秀）
# PyCaret: RMSE 157.4 kW
# Keras: RMSE 159.6 kW
# RandomForest: RMSE 171.3 kW
```

### 6.2. 環境変数設定（v2.0機能）

v2.0と同一（詳細はv2.0使用手順書参照）。

#### 6.2.1. AI_TARGET_YEARS（学習年指定）
```powershell
# 単一年指定
$env:AI_TARGET_YEARS = "2024"

# 複数年指定（カンマ区切り）
$env:AI_TARGET_YEARS = "2022,2023,2024"

# 環境変数確認
echo $env:AI_TARGET_YEARS
```

#### 6.2.2. AI_SERVER_PORT（HTTPサーバーポート変更）
```powershell
# デフォルト（8002）から変更
$env:AI_SERVER_PORT = "8003"

# サーバー起動
py -3.10 server.py
# サーバー起動: http://localhost:8003/
```

### 6.3. バッチ実行（複数モデル連続実行）

#### 6.3.1. CLI版バッチ実行（v1.0・v2.0と同一）
```powershell
# 全モデル学習バッチ（2022-2024年）
py -3.10 .\data\data.py 2022,2023,2024
py -3.10 .\train\Keras\Keras_train.py 2022,2023,2024
py -3.10 .\train\LightGBM\LightGBM_train.py 2022,2023,2024
py -3.10 .\train\Pycaret\Pycaret_train.py 2022,2023,2024
py -3.10 .\train\RandomForest\RandomForest_train.py 2022,2023,2024
```

#### 6.3.2. 組み合わせ検証バッチ実行（v3.0新機能）
```powershell
# 全モデル組み合わせ検証バッチ（合計約55分）
py -3.10 .\train\LightGBM\LightGBM_optimize_years.py
py -3.10 .\train\Pycaret\Pycaret_optimize_years.py
py -3.10 .\train\RandomForest\RandomForest_optimize_years.py
py -3.10 .\train\Keras\Keras_optimize_years.py

# 結果ファイル確認
ls *_optimize_years.txt
```

### 6.4. トラブルシューティング

#### 6.4.1. HTTPサーバー起動失敗
v2.0と同一（詳細はv2.0使用手順書参照）。

#### 6.4.2. ブラウザが自動起動しない
v2.0と同一（詳細はv2.0使用手順書参照）。

#### 6.4.3. localStorage保存データが復元されない（v3.0固有）

**症状**: 学習年を選択してページをリロードしても、選択状態が復元されない

**原因1**: ブラウザのプライベートモード（シークレットモード）
- プライベートモードではlocalStorageが無効化される場合がある

**解決策1**: 通常モードでブラウザを開く

**原因2**: ブラウザのlocalStorage設定が無効
- ブラウザの設定でCookieやローカルストレージが無効化されている

**解決策2**: ブラウザ設定を確認
```
Chrome: 設定 → プライバシーとセキュリティ → Cookieと他のサイトデータ
→ 「Cookieをすべて受け入れる」または「シークレットモードでサードパーティのCookieをブロックする」を選択
```

**原因3**: localStorageが満杯
- localStorageの容量制限（通常5-10MB）を超過

**解決策3**: localStorageをクリア
```javascript
// 開発者ツールのコンソールで実行
localStorage.clear();
```

**確認方法**: 開発者ツールでlocalStorageを確認
```javascript
// 開発者ツールのコンソールで実行
console.log(localStorage.getItem('ai_training_years_LightGBM'));
// null の場合は保存されていない
```

#### 6.4.4. 組み合わせ検証タイムアウトエラー（v3.0固有）
**症状**: `subprocess.TimeoutExpired: タイムアウト: 40分経過しました`（Kerasのみ）

**原因**: Keras組み合わせ検証が30分以上かかる

**解決策1**: HTTPサーバーのタイムアウト設定を変更
```python
# server.py の該当行を修正（行142付近）
result = subprocess.run(
    ['python', script],
    timeout=3600  # 40分→60分に変更
)
```

**解決策2**: CLI直接実行（推奨）
```powershell
# WebUIではなくCLI直接実行
py -3.10 train\Keras\Keras_optimize_years.py
```

#### 6.4.5. 組み合わせ検証結果ファイルが生成されない（v3.0固有）
**症状**: 組み合わせ検証実行後、結果ファイルが見つからない

**原因**: 
- スクリプト実行エラー
- ファイルパス問題
- 書き込み権限不足

**解決策**:
```powershell
# logs.logを確認（エラー詳細記録）
Get-Content logs.log

# 手動でファイル検索
Get-ChildItem -Path "AI\" -Filter "*_optimize_years.txt" -Recurse

# 書き込み権限確認
icacls "AI\train\LightGBM\"
```

#### 6.4.6. メモ帳が自動で開かない（v3.0固有）
**症状**: 結果ファイルは生成されるが、メモ帳が開かない

**原因**: os.startfile()がサポートされていないOS、またはnotepad.exeがパスに無い

**解決策**: 手動で結果ファイルを開く
```powershell
# 手動でメモ帳オープン
notepad "2025-10-XX_LightGBM_optimize_years.txt"

# または、VS Codeで開く
code "2025-10-XX_LightGBM_optimize_years.txt"
```

#### 6.4.7. 組み合わせ検証中にCLI実行で競合エラー（v3.0固有）
**症状**: 組み合わせ検証実行中に手動でCLI学習を実行すると、ファイルロックエラー

**原因**: data.py、train.pyの同時実行によるファイルロック競合

**解決策**: 
- 組み合わせ検証完了を待つ
- または、別モデルで実行（例: 組み合わせ検証はLightGBM、手動学習はKeras）

## 7. 付録

### 7.1. ショートカット
- `Ctrl + K, Ctrl + O`: フォルダーを開く
- `Ctrl + Shift + P`: コマンドパレット
- `Ctrl+Shift+P`: Python インタープリター選択

### 7.2. 推奨ワークフロー

#### 7.2.1. 初回セットアップ（1回のみ）
1. Python 3.10.11インストール
2. VS Codeインストール
3. 仮想環境作成（`.venv`）
4. `pip install -r requirements.txt`

#### 7.2.2. 月次最適化ワークフロー（v3.0推奨）
1. `py -3.10 server.py`でサーバー起動
2. ブラウザでダッシュボード操作
3. **組み合わせ検証実行**（全モデル、月1回推奨）
   - [LightGBM]選択 → [組み合わせ検証シミュレーション]
   - [PyCaret]選択 → [組み合わせ検証シミュレーション]
   - [RandomForest]選択 → [組み合わせ検証シミュレーション]
   - [Keras]選択 → [組み合わせ検証シミュレーション]
4. 結果ファイル確認・比較
5. 最優秀モデル・組み合わせ選定
6. 推奨組み合わせで学習実行（**localStorage自動復元により、選択状態が保持される**）

#### 7.2.3. 日常的なモデル学習（v2.0推奨）
1. `py -3.10 server.py`でサーバー起動
2. ブラウザでダッシュボード操作
3. モデル選択→年選択→学習実行（**localStorage自動復元により、前回の選択状態が復元される**）
4. 結果自動表示で確認

#### 7.2.4. 詳細分析・デバッグ（v1.0推奨）
1. 環境変数`AI_TARGET_YEARS`設定
2. CLIで個別スクリプト実行
3. ログ詳細確認
4. 必要に応じてコード修正・再実行

### 7.3. v1.0・v2.0・v3.0機能比較表

| 機能 | v1.0 | v2.0 | v3.0 |
|------|------|------|------|
| **CLI操作** | ✅ | ✅ | ✅ |
| **Webダッシュボード** | ❌ | ✅ | ✅ |
| **HTTPサーバー** | ❌ | ✅ | ✅ |
| **環境変数AI_TARGET_YEARS** | ❌ | ✅ | ✅ |
| **実行履歴ログ（server.log）** | ❌ | ✅ | ✅ |
| **組み合わせ検証スクリプト** | ❌ | ❌ | ✅ |
| **ローリング時系列交差検証** | ❌ | ❌ | ✅ |
| **組み合わせ検証Webボタン** | ❌ | ❌ | ✅ |
| **組み合わせ検証結果ファイル** | ❌ | ❌ | ✅ |
| **メモ帳自動オープン** | ❌ | ❌ | ✅ |
| **2025年予測推奨提示** | ❌ | ❌ | ✅ |
| **localStorage学習年記憶** | ❌ | ❌ | ✅ |

### 7.4. v2.0 → v3.0移行ガイド

#### 7.4.1. 既存v2.0ユーザー向け
- **v2.0のCLI・WebUI操作はそのまま使用可能**（下位互換性100%）
- 組み合わせ検証を試したい場合は、以下のいずれかを実行
  - WebUI: [組み合わせ検証シミュレーション]ボタン
  - CLI: `py -3.10 train\LightGBM\LightGBM_optimize_years.py`
- 月次で組み合わせ検証実行を推奨（最適学習年の再評価）
- **localStorage機能により、学習年選択が自動保存・復元される**（作業再開が即座に可能）

#### 7.4.2. 新規v3.0ユーザー向け
- **初回は組み合わせ検証実行を推奨**（全モデル、約55分）
- 最優秀モデル・組み合わせを特定（例: LightGBM、2016,2017→2018）
- 以降はWebUIで日常的なモデル学習・予測を実行
- 月次で組み合わせ検証実行（最適化の再評価）
- **localStorage機能により、選択状態が自動保持されるため、作業ログ不要**

### 7.5. localStorage機能の実用的な活用法

#### 7.5.1. 複数モデルでの試行錯誤
- LightGBMで最近3年（2022-2024）、Kerasで最近4年（2021-2024）など、モデル別に異なる学習年を試行
- モデル切り替え時に自動復元されるため、毎回選択し直す手間が不要

#### 7.5.2. 長期間のモデル評価
- 1週間かけて各モデルで最適な学習年を探索する際、毎日ブラウザを開くだけで前日の選択状態が復元
- 作業ログ記録が不要

#### 7.5.3. チーム共同作業
- 各メンバーが異なるモデルを担当する際、各自のブラウザで独立した学習年を記憶
- 作業引継ぎ時の選択状態の伝達が不要（各自のブラウザに自動保存）

---
