# 経費登録ワークフロー自動化システム開発 - 使用手順書

※ この資料は教育用のサンプルです。

## 1. システム概要

本システムは、Excelファイル（data.xlsx）に記載された経費情報を、Webブラウザを自動操作して経費登録サイトに一括登録するPythonスクリプト群である。特性の異なる4種類のAIモデルによって生成されたスクリプトが含まれており、要件に応じて使い分けることができる。

### 1.1. 適用範囲と前提
本手順書は、VS CodeとPythonを使用した開発環境のセットアップおよび経費登録ワークフロー自動化システムの実行方法について記述する。

#### 1.1.1. VS Code
- 推奨バージョン: 最新安定版（定期更新推奨）
- 対象OS: Windows 10/11（PowerShell使用）
- インストール元: [VS Code公式サイト](https://code.visualstudio.com/)

#### 1.1.2. Python
- 推奨バージョン: 3.10.11（全プロジェクト統一）
- インストール元: [python.org 公式サイト](https://www.python.org/downloads/release/python-31011/)
    Filesの「Windows installer (64-bit)」をクリックしてインストーラー（python-3.10.11-amd64.exeファイル）をダウンロードする。

## 2. 動作環境

### 2.1. 環境セットアップ

#### 2.1.1. VS Codeでフォルダを開く

1.  VS Codeを起動する。
2.  `Ctrl + K, Ctrl + O` または「ファイル」→「フォルダーを開く」を選択する。
3.  以下のパスを指定して開く（要注意！）。
    `C:\Users\<UserName>\<project_root>\03_経費登録ワークフロー`

#### 2.1.2. PowerShellターミナルを開く

1. VS Codeで `Ctrl + Shift + P` を押す。
2. 「Terminal: Create New Terminal」を選択する。
3. ターミナルが表示されることを確認する。

#### 2.1.3. Python環境設定

```bash
# Python バージョン確認（3.10.11必須）
py -3.10 --version
# 結果例: Python 3.10.11

# 仮想環境作成（推奨・Python 3.10.11指定）
py -3.10 -m venv .venv

# 仮想環境を有効化
.\.venv\Scripts\Activate.ps1
# コマンドライン先頭に (.venv) が表示されることを確認

# 仮想環境Python バージョン確認（3.10.11必須）
.\.venv\Scripts\python.exe --version
# 結果例: Python 3.10.11
```

#### 2.1.4. VS Code Pythonインタープリターの選択

1. `Ctrl+Shift+P`でコマンドパレットを開く
2. 「Python: Select Interpreter」と入力して選択する
3. 作成した仮想環境の`.venv\Scripts\python.exe` を選択する

## 3. インストール/セットアップ手順

### 3.1. pip自体の最新化
```bash
python -m pip install --upgrade pip
```

### 3.2. 全モデル対応の完全版インストール
```bash
pip install -r requirements.txt
```

環境をリセットしたい場合は、`.venv`フォルダを削除する

## 4. 初期設定

- 処理対象のExcelファイル data.xlsx を、スクリプトと同じ py フォルダの親フォルダに配置する
- data.xlsx が存在しない場合、初回実行時にサンプルファイルが自動でダウンロードされる

## 5. 基本操作

実行可能なスクリプトは以下の通りである。

- 経費登録.py（リファクタ前：動作が遅い）
- py/経費登録_claude_sonnet_3.5.py
- py/経費登録_claude_sonnet_4.py
- py/経費登録_gpt-4.1.py
- py/経費登録_gpt-5.py

実行後、自動的にEdgeブラウザが起動し、処理が開始される。処理が完了すると、結果を通知するメッセージボックスが表示される。

### 5.1. 経費登録ワークフローの実行

```bash
python .\経費登録.py
python .\py\経費登録_claude_sonnet_4.py
python .\py\経費登録_gpt-4.1.py
python .\py\経費登録_claude_sonnet_3.5.py
python .\py\経費登録_gpt-5.py
```

## 6. 付録

### 6.1. ショートカット
- `Ctrl + K, Ctrl + O`: フォルダーを開く
- `Ctrl + Shift + P`: コマンドパレット
- `Ctrl+Shift+P`: Python インタープリター選択
