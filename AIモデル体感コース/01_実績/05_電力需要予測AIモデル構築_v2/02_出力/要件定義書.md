# 電力需要予測AIモデル構築 - 要件定義書 v2.0

※ この資料は教育用のサンプルです。

**バージョン**: v2.0  
**リリース日**: 2025年10月15日  
**主要特性**: CLI + Webダッシュボード統合版

---

## 1. ビジネス要件

### 1.1. 目的・背景
電力需要の高精度予測を通じた電力安定供給とエネルギー効率最適化の実現である。機械学習技術を活用した4種類のアルゴリズム（Keras、LightGBM、PyCaret、RandomForest）による包括的予測システムに加え、**Webダッシュボードによる視覚的操作環境**を提供し、電力需要管理の自動化・高度化・効率化を図る。

- **目的**: 過去の電力消費実績データを基に、将来の電力需要を高精度で予測するAIモデルを構築し、**ブラウザベースのWebインターフェース**により技術者・非技術者を問わず直感的な操作を可能にする
- **KPI**: 予測精度（例: 平均絶対パーセント誤差 MAPE）を目標値以下に抑え、**操作時間を50%削減、学習コストを75%削減**する

### 1.2. 適用範囲
- **対象領域**: 東京電力管内の電力需要予測
- **データ範囲**: 2016年～2025年の電力需要実績・気温データ
- **予測精度目標**: RMSE < 200kW、R2スコア > 0.9
- **処理性能目標**: メモリ使用量50%削減、学習時間30%短縮
- **操作性目標（v2.0）**: CLI操作時間97%削減、結果確認時間92%削減、モデル切替時間93%削減

### 1.3. 利用者
| 利用者 | 役割 | 利用目的 | v2.0での利点 |
|-------|------|----------|--------------|
| **電力オペレーター** | 電力供給管理 | 需要予測による発電計画策定 | WebUIで直感的操作 |
| **エネルギー分析者** | データ分析 | 需要パターン分析・レポート作成 | グラフ自動表示 |
| **システム管理者** | 運用管理 | モデル性能監視・保守 | server.logで履歴確認 |
| **開発エンジニア** | システム開発 | モデル改善・機能拡張 | HTTPサーバー拡張容易 |
| **非技術者（v2.0）** | 予測実行 | ワンクリック予測実行 | コマンド不要 |

## 2. 利用者・ステークホルダー

### 2.1. 機能要件

#### 2.1.1. データ処理機能（v1.0からの継承）

##### F001: データ取得機能
- **目的**: 電力需要実績データ・気温データの自動取得
- **入力**: CSVファイル (juyo-YYYY.csv, temperature-YYYY.csv)
- **処理**:
  - SHIFT-JISエンコーディング対応
  - スキップ行設定 (電力需要:3行, 気温:5行)
  - データ型変換 (float32メモリ最適化)
- **出力**: 統合データセット (X.csv, Y.csv)
- **v2.0拡張**: 環境変数AI_TARGET_YEARSによる年フィルタリング対応
- **優先度**: P0 (最重要)

##### F002: 特徴量エンジニアリング機能
- **目的**: 予測精度向上のための特徴量生成
- **入力**: 生データ (電力需要、気温、日時)
- **処理**:
  - 時系列特徴量: MONTH (1-12), WEEK (0-6), HOUR (0-23)
  - 気温特徴量: TEMP (摂氏温度)
  - 目標変数: KW (電力需要量)
- **出力**: 加工済み特徴量データ
- **v2.0拡張**: コマンドライン引数による年指定対応
- **優先度**: P0 (最重要)

##### F003: データ分割機能
- **目的**: 学習・テストデータの適切な分割
- **入力**: 統合データセット
- **処理**:
  - 訓練:テスト = 90:10の分割比率
  - 乱数シード固定 (RANDOM_STATE=42)
  - StandardScaler標準化適用
- **出力**: Xtrain.csv, Ytrain.csv, Xtest.csv, Ytest.csv
- **v2.0での変更**: 実装内容はv1.0と完全同一
- **優先度**: P0 (最重要)

#### 2.1.2. モデル学習機能（v1.0からの継承）

##### F004: Keras深層学習モデル (train/Keras/Keras_train.py)
- **目的**: ニューラルネットワークによる非線形予測
- **アーキテクチャ**: Multi-layer Perceptron (128→64→32→16→1)
- **実装仕様**: v1.0と同一
- **v2.0拡張**: 環境変数AI_TARGET_YEARS、コマンドライン引数対応
- **出力**: Keras_model.h5, Keras_model.sav, Keras_history.png, Keras_Ypred.csv
- **優先度**: P1 (高)

##### F005: LightGBM勾配ブースティングモデル (train/LightGBM/LightGBM_train.py)
- **目的**: 高速・高精度な勾配ブースティング予測
- **アルゴリズム**: Gradient Boosting Decision Tree
- **実装仕様**: v1.0と同一
- **v2.0拡張**: 環境変数AI_TARGET_YEARS、コマンドライン引数対応
- **出力**: LightGBM_model.sav, LightGBM_model_scaler.pkl, LightGBM_Ypred.csv
- **優先度**: P1 (高)

##### F006: PyCaret自動機械学習モデル (train/Pycaret/Pycaret_train.py)
- **目的**: 自動モデル選択・最適化による予測
- **アルゴリズム**: Auto-ML (RandomForestベース)
- **実装仕様**: v1.0と同一
- **v2.0拡張**: 環境変数AI_TARGET_YEARS、コマンドライン引数対応
- **出力**: Pycaret_model.pkl, Pycaret_Ypred.csv
- **優先度**: P1 (高)

##### F007: RandomForestアンサンブルモデル (train/RandomForest/RandomForest_train.py)
- **目的**: アンサンブル学習による安定した予測
- **アルゴリズム**: Random Forest Regressor
- **実装仕様**: v1.0と同一
- **v2.0拡張**: 環境変数AI_TARGET_YEARS、コマンドライン引数対応
- **出力**: RandomForest_model.sav, RandomForest_model_scaler.pkl, RandomForest_Ypred.csv
- **優先度**: P1 (高)

#### 2.1.3. 予測実行機能（v1.0からの継承）

##### F008: tomorrow予測データ取得機能 (tomorrow/data.py, tomorrow/temp.py)
- **目的**: 翌日予測用最新データの自動取得
- **データソース**:
  - TEPCO電力使用実績データ (tomorrow/data.py)
  - Open-Meteo API気温データ (tomorrow/temp.py)
- **実装仕様**: v1.0と同一
- **出力**: tomorrow.csv, Ytest.csv
- **v2.0での変更**: なし（透過的実行）
- **優先度**: P0 (最重要)

##### F009: 各モデル予測実行機能 (tomorrow/*/tomorrow.py)
- **目的**: 学習済みモデルによる翌日電力需要予測
- **対象モデル**: Keras, LightGBM, PyCaret, RandomForest
- **実装仕様**: v1.0と同一
- **出力**: {Model}_tomorrow.csv, {Model}_tomorrow.png
- **v2.0での変更**: なし（透過的実行）
- **優先度**: P1 (高)

#### 2.1.4. 可視化・レポート機能（v1.0からの継承）

##### F010: 統一可視化機能
- **目的**: 予測結果の統一的な可視化・レポート生成
- **実装仕様**: v1.0と同一（16:9統一、日本語対応等）
- **出力**: PNG形式 (16:9, DPI=100)
- **v2.0拡張**: Webダッシュボードでの自動表示対応
- **優先度**: P2 (中)

##### F011: 性能監視・ログ機能
- **目的**: システム性能・品質の自動監視
- **実装仕様**: v1.0と同一（robust_model_operation）
- **v2.0拡張**: server.logへの自動記録機能追加
- **優先度**: P2 (中)

##### F012: 過去期間予測機能
- **目的**: 指定期間の予測・精度検証
- **実装仕様**: v1.0と同一
- **v2.0での変更**: なし
- **優先度**: P2 (中)

#### 2.1.5. Webインターフェース機能（v2.0新規）

##### F013: HTTPサーバー機能 (server.py)
- **目的**: ブラウザベースのWebインターフェース提供
- **実装仕様**:
  ```python
  PORT = int(os.environ.get('AI_SERVER_PORT', '8002'))
  
  # APIエンドポイント
  POST /run-data              # データ処理実行
  POST /run-train             # モデル学習実行
  POST /run-tomorrow-data     # 最新データ取得
  POST /run-tomorrow          # 予測実行
  GET  /available-years       # 利用可能年一覧
  GET  /                      # ダッシュボード表示
  ```
- **機能詳細**:
  - ThreadingTCPServer（並行接続対応）
  - subprocess経由でPythonスクリプト実行
  - 環境変数AI_TARGET_YEARSによる年指定対応
  - 自動ログ記録（server.log）
  - タイムアウト設定（40分）
  - 自動ブラウザ起動（http://localhost:8002/）
- **エラーハンドリング**:
  - プロセス実行エラーのHTTPレスポンス変換
  - タイムアウト検出・通知
  - 詳細エラーログ記録
- **出力**: server.log（全実行履歴）
- **優先度**: P0 (最重要)

##### F014: Webダッシュボード機能 (dashboard/index.html)
- **目的**: 技術者・非技術者向け直感的操作UI
- **UI構成**:
  ```text
  ┌─────────────────────────────────────┐
  │ 電力需要AI予測ダッシュボード           │
  ├───────┬───────┬───────┬──────────────┤
  │モデル │ 予測  │ 学習  │ 学習年       │
  │選択   │カード │カード │カード        │
  ├───────┴───────┴───────┴──────────────┤
  │ 予測グラフエリア  │ 学習グラフエリア│
  └────────────────────┴─────────────────┘
  ```
- **主要機能**:
  - **モデル選択**: 4モデルボタン（Keras/LightGBM/PyCaret/RandomForest）
  - **ワンクリック実行**: データ処理・学習・予測ボタン
  - **リアルタイムグラフ表示**: 16:9アスペクト比
  - **指標表示**: RMSE/R2/MAE自動表示
  - **ツールチップ・モーダル**: 詳細情報表示
  - **ネオン発光エフェクト**: 選択中モデル強調
  - **学習年複数選択**: 2022/2023/2024ボタン
  - **グラフ拡大機能**: モーダル表示
  - **ダウンロード機能**: 予測結果PNG保存
- **デザイン**:
  - ダークモード（グラデーション背景）
  - 予測値: #1f77b4 (青系)
  - 実績値: #ff7f0e (オレンジ系)
  - ボタン: 緑ネオン発光（選択時）
  - レスポンシブ: 1200px以上推奨
- **出力**: なし（純粋UIコンポーネント）
- **優先度**: P0 (最重要)

##### F015: 環境変数連携機能
- **目的**: CLIとWebUIの統一的な年指定メカニズム
- **環境変数**: AI_TARGET_YEARS（例: "2022,2023,2024"）
- **適用範囲**: data.py、全モデルtrain.py
- **処理詳細**:
  ```python
  # 環境変数からの年取得
  target_years_env = os.environ.get('AI_TARGET_YEARS', '')
  if target_years_env:
      target_years = [int(y.strip()) for y in target_years_env.split(',')]
      # 指定年のみフィルタリング
  ```
- **優先度**: P1 (高)

## 3. ユースケース/業務フロー

### 3.1. 非機能要件

#### 3.1.1. 性能要件
| 項目 | 要件 | 測定方法 | 目標値 |
|------|------|----------|--------|
| **予測精度** | RMSE | テストデータ評価 | < 200kW |
| **予測精度** | R2スコア | テストデータ評価 | > 0.9 |
| **メモリ効率** | 使用量削減 | float32最適化 | 50%削減 |
| **処理速度** | 学習時間 | 並列処理効果 | 30%短縮 |
| **レスポンス時間** | 予測実行時間 | 単一予測処理 | < 1秒 |
| **スループット** | バッチ処理性能 | 1000件予測処理 | < 10秒 |
| **操作時間（v2.0）** | CLI→WebUI削減 | モデル選択〜実行 | 97%削減（30秒→1秒） |
| **確認時間（v2.0）** | 結果表示時間 | 結果自動表示 | 92%削減（60秒→5秒） |
| **切替時間（v2.0）** | モデル切替時間 | ボタンクリック | 93%削減（30秒→2秒） |
| **HTTPレスポンス（v2.0）** | WebUI応答時間 | APIエンドポイント | < 200ms |

#### 3.1.2. 可用性要件
- **稼働率**: 99.5%以上
- **障害復旧時間**: RTO < 1時間
- **データ復旧時間**: RPO < 30分
- **エラー率**: < 0.1%
- **サーバー稼働（v2.0）**: HTTPサーバー連続稼働30日以上

#### 3.1.3. 信頼性要件
- **データ整合性**: 100%保証
- **予測結果再現性**: 同一入力で同一出力保証
- **モデル安定性**: 連続稼働30日間エラー無し
- **バックアップ**: 日次自動バックアップ
- **実行履歴（v2.0）**: server.logでの完全トレーサビリティ

#### 3.1.4. セキュリティ要件
- **アクセス制御**: ファイルシステム権限による制御
- **データ暗号化**: 機密データの暗号化保存
- **ログ監査**: 操作ログの記録・保存 (robust_model_operation + server.log)
- **脆弱性対策**: 固定ライブラリバージョンによる安定性確保
- **ポートセキュリティ（v2.0）**: localhost限定アクセス（デフォルト）

#### 3.1.5. 保守性要件
- **コード品質**: PEP 8準拠100% (flake8検証)
- **型安全性**: 型ヒント完全実装 (mypy検証)
- **統一アーキテクチャ**: @dataclass + robust_model_operation統一
- **文書化**: docstring、技術文書完備
- **モジュール分離**: 機能別独立モジュール設計 (13モジュール、v1.0の11から+2)
- **ログ追跡（v2.0）**: server.logでの全操作履歴確認

### 3.2. ユースケースフロー（v2.0版）

#### 3.2.1. Web UI利用フロー
1. **サーバー起動**: `py -3.10 server.py`（1回のみ）
2. **ブラウザ自動起動**: http://localhost:8002/
3. **Webダッシュボード表示**
4. **モデル選択**: [LightGBM]ボタンクリック
5. **学習年選択**: [2022][2023][2024]ボタンクリック
6. **データ処理実行**: [データ処理]ボタン → subprocess: data.py実行
7. **学習実行**: [学習]ボタン → subprocess: LightGBM_train.py実行（緑ネオン発光）
8. **結果表示**: RMSE/R2/MAE自動表示、グラフ表示（16:9）
9. **予測実行**: [最新データ取得]ボタン → subprocess: data.py + temp.py実行
10. **予測実行**: [予測]ボタン → subprocess: LightGBM_tomorrow.py実行
11. **結果表示・ダウンロード**: 予測グラフ表示、拡大機能、ダウンロード機能

#### 3.2.2. CLI利用フロー（v1.0互換）
v1.0と完全同一のコマンドライン操作も継続サポート。

## 4. 機能要件

### 4.1. データ仕様

#### 4.1.1. 入力データ仕様（v1.0と同一）

##### 電力需要実績データ (juyo-YYYY.csv)
| 項目 | 仕様 | 実装詳細 |
|------|------|---------|
| **ファイル形式** | CSV (SHIFT-JIS) | 日本語ヘッダー対応 |
| **スキップ行** | 3行 | `pd.read_csv(skiprows=3)` |
| **データ期間** | 2016-2025年 | 年別ファイル分離 |
| **データ頻度** | 1時間間隔 | 8,760-8,784行/年 |
| **データ型変換** | float32 | メモリ50%最適化 |
| **エンコーディング** | SHIFT-JIS | `encoding='shift_jis'` |

##### 気温データ (temperature-YYYY.csv)
| 項目 | 仕様 | 実装詳細 |
|------|------|---------|
| **ファイル形式** | CSV (SHIFT-JIS) | 気象庁データ形式 |
| **スキップ行** | 5行 | `pd.read_csv(skiprows=5)` |
| **観測地点** | 東京都心部 | 電力需要エリアと対応 |
| **データ頻度** | 1時間間隔 | 電力需要と同期 |
| **欠損値処理** | 前後値補間 | `fillna(method='bfill')` |
| **データ型変換** | float32 | メモリ最適化統一 |

#### 4.1.2. 中間データ仕様（v1.0と同一）

##### 統合特徴量データ (X.csv, Xtrain.csv, Xtest.csv)
| 列名 | データ型 | 範囲 | 実装詳細 |
|------|----------|------|---------|
| **MONTH** | int | 1-12 | `df['datetime'].dt.month` |
| **WEEK** | int | 0-6 | `df['datetime'].dt.dayofweek` |
| **HOUR** | int | 0-23 | `df['datetime'].dt.hour` |
| **TEMP** | float32 | -10.0~40.0 | 気温データ結合 |

##### 目標変数データ (Y.csv, Ytrain.csv, Ytest.csv)
| 列名 | データ型 | 範囲 | 実装詳細 |
|------|----------|------|---------|
| **KW** | float32 | 0~60,000,000 | 電力需要量(kW) |

#### 4.1.3. 出力データ仕様

##### 学習済みモデルファイル（v1.0と同一）
| モデル | ファイル形式 | パス | 実装詳細 |
|--------|------------|------|---------|
| **Keras** | HDF5 (.h5) | `train/Keras/Keras_model.h5` | TensorFlow SavedModel |
| **Keras** | Pickle (.sav) | `train/Keras/Keras_model.sav` | scikit-learn互換 |
| **LightGBM** | Pickle (.sav) | `train/LightGBM/LightGBM_model.sav` | LightGBM Booster |
| **PyCaret** | Pickle (.pkl) | `train/Pycaret/Pycaret_model.pkl` | PyCaret Pipeline |
| **RandomForest** | Pickle (.sav) | `train/RandomForest/RandomForest_model.sav` | RandomForest |

##### ログファイル（v2.0新規）
| 項目 | 仕様 | 実装詳細 |
|------|------|---------|
| **ファイル名** | server.log | HTTPサーバールートディレクトリ |
| **形式** | プレーンテキスト | UTF-8エンコーディング |
| **内容** | リクエスト/レスポンス/エラー | タイムスタンプ付き |
| **ローテーション** | 10MB超過時 | 自動バックアップ |

## 5. 非機能要件

### 5.1. インターフェース要件

#### 5.1.1. ファイルインターフェース（v1.0と同一）

##### 入力ファイル
- **電力需要データ**: `data/juyo-YYYY.csv`
- **気温データ**: `data/temperature-YYYY.csv`
- **予測用データ**: `tomorrow/tomorrow.csv`

##### 出力ファイル
- **学習済みモデル**: `train/{ModelName}/{ModelName}_model.{ext}`
- **予測結果**: `{location}/{ModelName}_Ypred.csv`
- **可視化グラフ**: `{location}/{ModelName}_Ypred.png`

#### 5.1.2. HTTPインターフェース（v2.0新規）

##### APIエンドポイント
| メソッド | パス | 説明 | リクエスト | レスポンス |
|---------|------|------|-----------|-----------|
| **POST** | /run-data | データ処理実行 | `{model, years}` | `{output, error}` |
| **POST** | /run-train | モデル学習実行 | `{model, years}` | `{output, error}` |
| **POST** | /run-tomorrow-data | 最新データ取得 | `{model}` | `{output, error}` |
| **POST** | /run-tomorrow | 予測実行 | `{model}` | `{output, error}` |
| **GET** | /available-years | 利用可能年一覧 | なし | `{years: [...]}` |
| **GET** | / | ダッシュボード表示 | なし | HTML |

##### HTTPステータスコード
- **200 OK**: 正常実行完了
- **500 Internal Server Error**: 実行エラー
- **404 Not Found**: リソース未検出
- **405 Method Not Allowed**: 不正HTTPメソッド

## 6. データ要件

### 6.1. 運用要件

#### 6.1.1. システム運用
- **OS**: Windows 10/11, macOS, Linux (Ubuntu 20.04+)
- **Python**: 3.10.11 (推奨)
- **メモリ**: 最小8GB、推奨16GB
- **ストレージ**: 最小10GB、推奨50GB
- **ブラウザ（v2.0）**: Chrome/Firefox/Edge最新版
- **ポート（v2.0）**: デフォルト8002（環境変数AI_SERVER_PORTで変更可能）

#### 6.1.2. 監視要件
- **性能監視**: CPU使用率、メモリ使用率、実行時間
- **精度監視**: 予測精度の経時変化
- **エラー監視**: 実行エラー、データエラー
- **ログ監視**: アクセスログ、エラーログ
- **サーバー監視（v2.0）**: HTTPサーバー稼働状態、APIレスポンスタイム

#### 6.1.3. バックアップ要件
- **データバックアップ**: 日次フルバックアップ
- **モデルバックアップ**: 学習完了時自動バックアップ
- **設定バックアップ**: 設定変更時即座にバックアップ
- **ログバックアップ（v2.0）**: server.logの定期バックアップ
- **保存期間**: 30日間

## 7. 外部インターフェース要件

### 7.1. 制約事項

#### 7.1.1. 技術制約

##### ライブラリバージョン固定（v1.0と同一）
```python
# 固定バージョン - 互換性・再現性確保（Python 3.10.11環境）
pandas==1.5.3               # データ処理基盤
numpy==1.24.4               # 数値計算
scikit-learn==1.2.2         # 機械学習基盤
matplotlib==3.7.5           # 可視化
tensorflow==2.15.0          # Keras深層学習
lightgbm==3.3.5            # 勾配ブースティング
pycaret==3.0.0              # 自動機械学習
scipy==1.11.4              # 科学計算
# v2.0での追加ライブラリ: なし（Python標準ライブラリのみ使用）
```

##### 実行環境制約
| 項目 | 制約 | 実装対応 | v2.0での追加 |
|------|------|---------|------------|
| **Python バージョン** | 3.10.11 | PyCaret互換性重視 | 変更なし |
| **メモリ制限** | 16GB以下 | float32最適化で50%削減 | +50MB（サーバー） |
| **処理時間制限** | 学習最大2時間 | 並列処理で30%短縮 | 変更なし |
| **ストレージ** | 最小10GB | モデル・データ・ログ | +2MB（server.py, index.html, server.log） |
| **ポート制限（v2.0）** | 1024-65535 | デフォルト8002 | 環境変数で変更可 |

##### Webサーバー制約（v2.0新規）
| 項目 | 制約 | 対応策 |
|------|------|-------|
| **同時接続数** | 最大10接続 | ThreadingTCPServer |
| **タイムアウト** | 40分 | subprocess timeout設定 |
| **ファイルサイズ** | POSTボディ10MB | リクエストサイズ制限 |
| **ブラウザ互換性** | Chrome/Firefox/Edge | HTML5/CSS3標準準拠 |

#### 7.1.2. データ制約（v1.0と同一）

##### ファイル形式制約
| 項目 | 制約 | 理由・対応 |
|------|------|---------|
| **エンコーディング** | SHIFT-JIS固定 | 日本語データ対応 |
| **スキップ行** | 電力:3行、気温:5行 | ヘッダー情報除外 |
| **データ型** | float32統一 | メモリ最適化 |
| **欠損値** | 10%以下 | 補間処理対応 |

#### 7.1.3. 運用制約

##### システム運用制約
| 項目 | 制約 | 実装対応 | v2.0での追加 |
|------|------|---------|------------|
| **同時実行制限** | 最大4プロセス | 並列処理制御 | 変更なし |
| **ファイルロック** | 排他制御必須 | ファイルアクセス制御 | 変更なし |
| **メモリ監視** | psutil監視 | robust_model_operation | 変更なし |
| **ガベージコレクション** | 自動実行 | `gc.collect()` | 変更なし |
| **サーバー起動（v2.0）** | 1インスタンスのみ | ポート排他制御 | NEW |

##### API制約（v1.0と同一）
| 項目 | 制約 | 対応策 |
|------|------|-------|
| **TEPCO API** | レート制限あり | リトライ・待機機能 |
| **Open-Meteo API** | 1日10,000回 | キャッシュ・制限監視 |
| **タイムアウト** | 30秒制限 | 例外処理・フォールバック |

## 8. 運用・保守要件

### 8.1. 品質要件

#### 8.1.1. 機能品質
- **正確性**: 予測精度目標達成率 > 95%
- **完全性**: 全機能要件実装率 100%（v2.0: 15機能、v1.0: 12機能）
- **適合性**: 仕様準拠率 100%

#### 8.1.2. 性能品質
- **時間効率性**: 処理時間目標達成率 > 90%
- **資源効率性**: メモリ使用量目標達成率 > 90%
- **容量**: 最大データ量処理可能
- **操作効率（v2.0）**: WebUI操作時間削減率 > 90%

#### 8.1.3. 互換性品質
- **共存性**: 他システムとの競合なし
- **相互運用性**: 標準形式での入出力
- **置換性**: モデル交換可能性
- **下位互換性（v2.0）**: v1.0 CLI完全サポート

#### 8.1.4. 使用性品質
- **適切度認識性**: 機能理解容易性
- **習得性**: 新規利用者習得時間（CLI: 1日、WebUI: 30分）
- **運用性**: 日常運用の自動化率 > 95%
- **UI/UX品質（v2.0）**: 直感的操作性、視認性、アクセシビリティ

#### 8.1.5. 信頼性品質
- **成熟性**: 既知障害率 < 0.1%
- **可用性**: システム稼働率 > 99.5%
- **障害許容性**: 単一障害での停止なし
- **回復性**: 障害復旧時間 < 1時間
- **サーバー安定性（v2.0）**: 連続稼働30日以上

#### 8.1.6. セキュリティ品質
- **機密性**: 不正アクセス防止
- **完全性**: データ改ざん検知
- **否認防止**: 操作ログ完全記録（robust_model_operation + server.log）
- **責任追跡性**: ユーザー操作追跡
- **ポートセキュリティ（v2.0）**: localhost限定（デフォルト）

#### 8.1.7. 保守性品質
- **モジュール性**: 独立モジュール設計（13モジュール）
- **再利用性**: コンポーネント再利用率 > 80%
- **解析性**: 問題原因特定時間 < 30分（server.logで追跡容易）
- **修正性**: 不具合修正時間 < 4時間
- **試験性**: 自動テスト実行可能

#### 8.1.8. 移植性品質
- **適応性**: 多OS対応（Windows/macOS/Linux）
- **設置性**: 自動インストール対応
- **置換性**: システム移行対応
- **ブラウザ移植性（v2.0）**: 主要ブラウザ対応

## 9. 制約条件・前提条件・依存関係

### 9.1. 受入基準

#### 9.1.1. 機能受入基準
- 全機能要件 (F001-F015) の正常動作確認
- 4種類のモデル学習・予測実行確認
- データ処理パイプライン正常動作確認
- 可視化グラフ品質基準クリア
- **HTTPサーバー稼働確認（v2.0）**
- **Webダッシュボード全機能動作確認（v2.0）**

#### 9.1.2. 性能受入基準
- RMSE < 200kW達成
- R2スコア > 0.9達成
- メモリ使用量50%削減達成
- 処理時間30%短縮達成
- **操作時間97%削減達成（v2.0）**
- **HTTPレスポンス < 200ms達成（v2.0）**

#### 9.1.3. 品質受入基準
- コードカバレッジ90%以上
- PEP 8準拠100%
- セキュリティスキャン合格
- 負荷テスト合格
- **ブラウザ互換性テスト合格（v2.0）**

#### 9.1.4. 運用受入基準
- 30日間連続稼働テスト合格
- 障害復旧テスト合格
- バックアップ・リストアテスト合格
- 運用ドキュメント完備
- **HTTPサーバー連続稼働30日以上（v2.0）**

### 9.2. リスク管理

#### 9.2.1. 技術リスク
| リスク項目 | 影響度 | 発生確率 | 対策・軽減措置 | v2.0での追加対策 |
|-----------|--------|----------|---------------|----------------|
| **ライブラリ互換性問題** | 高 | 中 | バージョン固定、仮想環境分離 | 変更なし |
| **メモリ不足エラー** | 中 | 低 | float32最適化、ガベージコレクション | サーバーメモリ監視 |
| **モデル精度劣化** | 高 | 低 | 4モデル並行、アンサンブル予測 | 変更なし |
| **処理性能不足** | 中 | 中 | 並列処理、最適化アルゴリズム | 変更なし |
| **API制限・障害** | 中 | 中 | リトライ機能、フォールバック | 変更なし |
| **ブラウザ互換性（v2.0）** | 低 | 中 | 主要ブラウザテスト | NEW |
| **ポート競合（v2.0）** | 低 | 低 | 環境変数AI_SERVER_PORTで変更 | NEW |

#### 9.2.2. データリスク（v1.0と同一）
| リスク項目 | 影響度 | 発生確率 | 対策・軽減措置 |
|-----------|--------|----------|---------------|
| **データ品質問題** | 高 | 中 | 異常値検証、データクレンジング |
| **データ取得障害** | 中 | 低 | 複数データソース、バックアップ |
| **エンコーディング問題** | 中 | 低 | SHIFT-JIS統一対応 |

#### 9.2.3. 運用リスク
| リスク項目 | 影響度 | 発生確率 | 対策・軽減措置 | v2.0での追加対策 |
|-----------|--------|----------|---------------|----------------|
| **システム障害** | 高 | 低 | 監視機能、自動復旧 | HTTPサーバー自動再起動 |
| **人的ミス** | 中 | 中 | 自動化推進、エラーチェック | WebUI操作で誤入力防止 |
| **ストレージ不足** | 中 | 低 | 容量監視、自動クリーンアップ | server.logローテーション |
| **セキュリティ問題** | 高 | 低 | アクセス制御、定期監査 | localhost限定アクセス |

## 10. 用語集

| 用語 | 定義・説明 |
|------|-----------|
| **@dataclass** | Python標準ライブラリの設定値統一管理クラス |
| **robust_model_operation** | エラーハンドリング・性能監視を提供する統一デコレータ |
| **RMSE** | Root Mean Square Error：予測誤差の二乗平均平方根 |
| **R2スコア** | 決定係数：予測精度を表す指標（1.0が完全予測） |
| **float32** | 32ビット浮動小数点型：メモリ50%削減データ型 |
| **EarlyStopping** | 過学習防止のための早期学習停止手法 |
| **アンサンブル** | 複数モデルの予測結果を統合する手法 |
| **勾配ブースティング** | 弱学習器を逐次改善するアンサンブル手法 |
| **Auto-ML** | Automated Machine Learning：機械学習プロセス自動化 |
| **StandardScaler** | 標準化処理：平均0、分散1への正規化 |
| **並列処理** | n_jobs=-1：CPU最大活用による処理速度向上 |
| **ガベージコレクション** | gc.collect()：メモリ最適化のための自動実行 |
| **HTTPサーバー（v2.0）** | http.serverベースのWebインターフェース提供サーバー |
| **Webダッシュボード（v2.0）** | ブラウザベースの直感的操作UI |
| **環境変数AI_TARGET_YEARS（v2.0）** | 学習年指定用環境変数（例: "2022,2023,2024"） |
| **環境変数AI_SERVER_PORT（v2.0）** | HTTPサーバーポート番号指定用（デフォルト: 8002） |
| **server.log（v2.0）** | HTTPサーバー実行履歴ログファイル |
| **ThreadingTCPServer（v2.0）** | 並行接続対応のTCPサーバー実装 |
| **subprocess（v2.0）** | Pythonスクリプト実行用標準ライブラリ |

---
