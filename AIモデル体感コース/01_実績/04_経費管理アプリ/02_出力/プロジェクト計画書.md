# 経費管理システムWebアプリケーション開発 - プロジェクト計画書

※ この資料は教育用のサンプルです。

## 1. 目的・背景

### 1.1. 目的・背景
従来のスプレッドシートベースの経費管理から、モダンなWebアプリケーションへの移行により、業務効率化とデータ管理の改善を図る。開発ガイドラインとコーディング規約に準拠した実践的な内容でリファクタリングし、パフォーマンスを最適化した経費管理システムを構築する。

本プロジェクトは、モダンなWeb技術（HTML5, CSS3, JavaScript ES6+）を用いて、高機能かつ高パフォーマンスな「経費管理システム」をシングルページアプリケーション（SPA）として開発することを目的とする。

### 1.2. プロジェクトの特徴
- 実装アーキテクチャ: HTML（ES6モジュール）版（modular）
- フルスタック Web アプリケーション: HTML5、CSS3、JavaScript による SPA (Single Page Application)
- セキュリティファースト: エンタープライズレベルのセキュリティ対策
- パフォーマンス最適化: デバウンス、キャッシュ機能、仮想スクロールによる高速レスポンス
- 堅牢なエラーハンドリング: 統合エラー管理システム
- コーディング規約準拠: コーディング規約に基づく保守性の高い実装

## 2. ステークホルダー/体制

### 2.1. 技術スタック

#### 2.1.1. アーキテクチャ
Frontend (Presentation Layer)
├── HTML5 (セマンティック構造)
├── CSS3 (CSS Variables, レスポンシブデザイン)
└── JavaScript (ES6+, モジュラー設計)

Security Layer
├── CSP (Content Security Policy)
├── XSS/SQLインジェクション対策
├── セッション管理
└── リクエスト制限

Data Layer
├── LocalStorage (主データ)
├── バックアップメカニズム
└── データ整合性チェック

#### 2.1.2. 技術選定
| カテゴリ | 技術 | バージョン | 用途 |
|----------|------|------------|------|
| フロントエンド | HTML5 | - | マークアップ |
| | CSS3 | - | スタイリング |
| | JavaScript | ES6+ | ロジック |
| 外部ライブラリ | Chart.js | 4.x | グラフ表示 |
| | ChartDataLabels | 2.x | グラフラベル |
| 開発ツール | VS Code | - | IDE |
 
## 3. スコープ

-   **対象**: `index.html`をエントリーポイントとするWebアプリケーションのフロントエンド開発。
-   **主要機能**: 経費の登録（単一・一括）、一覧表示、レポート機能。
-   **データ管理**: ブラウザのLocalStorageを利用したクライアントサイドでのデータ永続化。

### 3.1. 主要機能
| 機能名 | 概要 | 対象ユーザー |
|--------|------|-------------|
| ホーム画面 | ダッシュボード・統計表示 | 全ユーザー |
| 経費登録 | 個別・一括登録機能 | 経費申請者 |
| 経費一覧 | 検索・フィルタリング機能 | 全ユーザー |
| レポート | グラフ・統計分析 | 管理者 |

### 3.2. ページ遷移フロー
ホーム画面（index.html）
├── 経費登録画面
│   ├── 1件ずつ登録フォーム
│   └── CSVファイル一括登録
├── 経費一覧画面
│   ├── 検索・フィルタリング
│   └── 編集・削除機能
└── レポート画面
    ├── グラフ表示
    └── データエクスポート

### 3.3. ユーザーインターフェース要件
- レスポンシブデザイン対応
- アクセシビリティ準拠
- 直感的な操作性
- 高速レスポンス（1秒以内）

## 4. マイルストーン・スケジュール

### 4.1. システム構成
プレゼンテーション層
├── index.html (メインページ)
├── src/ExpenseApp.js (アプリケーション制御)
├── src/components/ (UI コンポーネント)
├── src/services/ (ビジネスロジック)
├── src/utils/ (ユーティリティ)
└── src/styles/ (スタイルシート)

データ層
├── LocalStorage (主データストレージ)
├── SessionStorage (一時データ)
└── バックアップ機能

### 4.2. セキュリティアーキテクチャ
SecurityManager: {
  sessionTimeout: 30 * 60 * 1000,    // 30分
  maxInactivity: 15 * 60 * 1000,     // 15分
  maxDataSize: 10 * 1024 * 1024,     // 10MB
  maxRequestsPerMinute: 60           // 60回/分
}

## 5. 予算・リソース計画

### 5.1. UIデザインガイドライン
| 要素 | 仕様 | 実装方法 |
|------|------|----------|
| カラーパレット | プライマリ: #007bff, セカンダリ: #6c757d | CSS Variables |
| フォント | メイン: Orbitron, サブ: Rajdhani | Google Fonts |
| レイアウト | レスポンシブグリッド | CSS Grid + Flexbox |
| アニメーション | 200ms ease-in-out | CSS Transitions |

### 5.2. レスポンシブデザイン
- モバイル: 320px - 768px
- タブレット: 768px - 1024px
- デスクトップ: 1024px以上

### 5.3. アクセシビリティ
- WCAG 2.1 AA準拠
- キーボードナビゲーション対応
- スクリーンリーダー対応

## 6. リスク/課題管理

| リスクカテゴリ | リスク項目 | 影響度 | 発生確率 | 対策・軽減策 |
|:---|:---|:---:|:---:|:---|
| **技術リスク** | ブラウザの互換性問題 | 中 | 中 | モダンブラウザ（Chrome, Firefox, Edge）の最新版をサポート対象とし、ES6モジュール対応を前提とする。 |
| **データリスク** | LocalStorageの容量超過 | 中 | 低 | 定期的なデータバックアップを促す機能を実装し、容量監視のアラートを設ける。 |
| **セキュリティリスク** | XSS脆弱性 | 高 | 低 | `Content-Security-Policy`を厳格に設定し、全てのユーザー入力をサニタイズする処理を徹底する。 |

### 6.1. マイルストーン
| フェーズ | 期間 | 主要成果物 | 完了基準 |
|----------|------|------------|----------|
| 要件定義 | 1日 | 要件定義書 | 達成 |
| 基本設計 | 1日 | 基本設計書 | 達成 |
| 実装フェーズ1 | 2日 | セキュリティ強化版 | 達成 |
| 実装フェーズ2 | 1日 | エラーハンドリング強化 | 達成 |
| 実装フェーズ3 | 1日 | パフォーマンス最適化 | 達成 |
| 実装フェーズ4 | 1日 | コーディング規約準拠 | 達成 |
| テスト・展開 | 1日 | 本稼働版 | 進行中 |

### 6.2. 詳細作業計画
1. **要件定義**: 機能要件・非機能要件の策定
2. **基本設計**: アーキテクチャ・UI設計
3. **実装**: 段階的リファクタリングアプローチ
4. **テスト**: 単体・統合・システムテスト
5. **展開**: 本番環境デプロイ

## 7. 品質計画

### 7.1. 品質基準
| 項目 | 基準 | 測定方法 |
|------|------|----------|
| 機能品質 | 全機能正常動作 | 機能テスト |
| セキュリティ | 脆弱性0件 | セキュリティ監査 |
| パフォーマンス | 応答時間1秒以内 | 負荷テスト |
| コード品質 | ガイドライン100%準拠 | 静的解析 |

### 7.2. 成功指標（KPI）
- 経費登録時間: 10分/件 → 3分/件
- データエラー率: 5% → 1%以下
- システム応答時間: 3秒 → 1秒以内
- セキュリティ脆弱性: 10件 → 0件

### 7.3. テスト戦略
1. 単体テスト (Unit Testing)
   ├── 関数レベルテスト
   ├── 入力検証テスト
   └── エラーハンドリングテスト

2. 統合テスト (Integration Testing)
   ├── ページ遷移テスト
   ├── データ連携テスト
   └── セキュリティ機能テスト

3. システムテスト (System Testing)
   ├── パフォーマンステスト
   ├── セキュリティテスト
   └── ユーザビリティテスト

## 8. コミュニケーション計画

### 8.1. 短期拡張機能（3ヶ月以内）
- ユーザー認証システム
- ワークフロー承認機能
- 多言語対応

### 8.2. 中期拡張機能（6ヶ月以内）
- モバイルアプリ版
- リアルタイム通知
- 外部システム連携

### 8.3. 長期拡張機能（1年以内）
- AI自動仕訳機能
- BI/BIダッシュボード
- マルチテナント対応

## 9. 変更管理・構成管理

-   **構成**: `index.html`がUIの骨格を定義し、`src/ExpenseApp.js`がアプリケーションのメインロジックを制御する。CSSは`src/styles/main.css`で管理される。

### 9.1. 主要リスク
| リスク | 影響度 | 発生確率 | 対策 | 責任者 |
|--------|--------|----------|------|--------|
| セキュリティ脆弱性 | 高 | 中 | セキュリティ監査・ペネトレーションテスト | セキュリティ担当 |
| パフォーマンス劣化 | 中 | 低 | 負荷テスト・最適化 | 開発チーム |
| データ損失 | 高 | 低 | バックアップ機能・復旧テスト | 開発チーム |
| ブラウザ互換性 | 中 | 中 | クロスブラウザテスト | QA担当 |

### 9.2. リスク対応計画
1. **予防策**: 定期的なコードレビュー・セキュリティチェック
2. **検知策**: 自動監視・ログ分析
3. **対応策**: インシデント対応プロセス・ロールバック計画
4. **復旧策**: バックアップ復旧・代替手順

## 10. 依存関係・前提条件・制約

-   **前提条件**: 本アプリケーションは`file://`プロトコルでは動作しない。ローカルでの動作確認にはHTTPサーバーが必要である。
-   **依存関係**: ローカルでのHTTP配信による動作確認には VS Code の Live Server を推奨します（`index.html`を Live Server で開いて動作確認してください）。

### 10.1. 運用体制
| 役割 | 責任範囲 | 担当者 |
|------|----------|--------|
| システム管理者 | 全体監視・障害対応 | IT部門 |
| 運用担当者 | 日常運用・ユーザーサポート | 業務部門 |
| セキュリティ担当者 | セキュリティ監視・対策 | セキュリティ部門 |

### 10.2. 保守計画
- **日次**: システム稼働状況確認
- **週次**: セキュリティログ分析
- **月次**: パフォーマンス分析・最適化
- **四半期**: セキュリティ監査

### 10.3. バックアップ・復旧計画
- **バックアップ頻度**: 日次自動バックアップ
- **保存期間**: 30日間
- **復旧目標時間**: 4時間以内
- **復旧確認**: 月次復旧テスト

## 11. エスカレーション/コンティンジェンシー

### 11.1. ファイル構成
html/
├── index.html                 # メインHTML
├── src/
│   ├── ExpenseApp.js         # メインアプリケーション
│   ├── components/
│   │   └── ChartManager.js   # チャート管理
│   ├── services/
│   │   ├── ExpenseService.js # ビジネスロジック
│   │   ├── StorageService.js # データ管理
│   │   └── ValidationService.js # バリデーション
│   ├── utils/
│   │   ├── Constants.js      # 定数
│   │   ├── ErrorHandler.js   # エラー処理
│   │   └── PerformanceUtils.js # パフォーマンス最適化
│   └── styles/
│       └── main.css         # スタイルシート
└── samples/
    └── 経費データ.csv        # サンプルデータ

### 11.2. モジュラー設計の特徴
- **責任分離**: 各モジュールが明確な役割を持つ
- **疎結合**: モジュール間の依存性を最小化
- **再利用性**: 他のプロジェクトでも使用可能
- **テスト容易性**: 単体テストが容易

### 11.3. セキュリティ機能
- **CSP (Content Security Policy)**: XSS攻撃防止
- **入力検証**: SQLインジェクション対策
- **セッション管理**: タイムアウト・アクティビティ監視
- **リクエスト制限**: DoS攻撃防止

### 11.4. パフォーマンス最適化
- **デバウンス**: 連続入力の最適化
- **キャッシュ機能**: データアクセス高速化
- **仮想スクロール**: 大量データ表示最適化
- **遅延読み込み**: 初期表示時間短縮

## 12. 付録

### 12.1. アーキテクチャ概要

本システムは、外部フレームワークに依存しないVanilla JavaScript（ES6+）によるモジュラー設計を採用している。

-   **エントリーポイント**: `index.html`
-   **メインコントローラー**: `src/ExpenseApp.js`
-   **UI**: `index.html`内の各`div.page`要素として定義され、JavaScriptによって表示が切り替えられる。
-   **データ永続化**: `LocalStorage`
-   **外部ライブラリ**: `Chart.js`（レポート機能で使用）

### 12.2. セキュリティ設計

`index.html`の`<head>`タグ内に`Content-Security-Policy`を`meta`タグで指定し、信頼されたドメイン（`'self'`, `cdn.jsdelivr.net`, `fonts.googleapis.com`など）以外からのリソース読み込みを制限している。

### 12.3. HTML（ES6モジュール）版
**概要**: モジュール化された本格的な実装。`html/` フォルダを配布単位とし、ローカルHTTPサーバ経由で動作を確認する。

### 12.4. ローカルサーバー起動方法

#### 12.4.1. VS Code Live Server拡張機能（推奨）
**前提条件**:
- Visual Studio Code
- Live Server拡張機能

**手順**:
1. VS Codeでプロジェクトフォルダを開く
2. 拡張機能「Live Server」をインストール
3. `index.html`を右クリック → "Open with Live Server"
4. ブラウザで自動的に `http://localhost:5500` が開く

**メリット**:
- ホットリロード対応
- デバッグに最適
- CORS問題の自動解決

### 12.5. 注意事項
- ファイル直接開き（file://）は非対応
- HTTPS環境での動作確認推奨
- 本番環境では適切なWebサーバー使用
