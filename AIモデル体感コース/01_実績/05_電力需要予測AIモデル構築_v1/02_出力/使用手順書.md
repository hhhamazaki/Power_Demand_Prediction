# 電力需要予測AIモデル構築 - 使用手順書

※ この資料は教育用のサンプルです。

## 1. システム概要

本システムは、Pythonベースの機械学習・深層学習環境で動作する。

### 1.1. 適用範囲と前提
本手順書は、VS CodeとPythonを使用した開発環境のセットアップおよび電力需要予測AIモデルの実行方法について記述する。

#### 1.1.1. VS Code
- 推奨バージョン: 最新安定版（定期更新推奨）
- 対象OS: Windows 10/11（PowerShell使用）
- インストール元: [VS Code公式サイト](https://code.visualstudio.com/)

#### 1.1.2. Python
- 推奨バージョン: 3.10.11（全プロジェクト統一）
- インストール元: [python.org 公式サイト](https://www.python.org/downloads/release/python-31011/)
    Filesの「Windows installer (64-bit)」をクリックしてインストーラー（python-3.10.11-amd64.exeファイル）をダウンロードする。

## 2. 動作環境

### 2.1. 環境セットアップ

#### 2.1.1. VS Codeでフォルダを開く

1.  VS Codeを起動する。
2.  `Ctrl + K, Ctrl + O` または「ファイル」→「フォルダーを開く」を選択する。
3.  以下のパスを指定して開く（要注意！）。
    `C:\Users\<UserName>\<project_root>\05_電力需要予測AIモデル構築\AI`

#### 2.1.2. PowerShellターミナルを開く

1. VS Codeで `Ctrl + Shift + P` を押す。
2. 「Terminal: Create New Terminal」を選択する。
3. ターミナルが表示されることを確認する。

#### 2.1.3. Python環境設定

```bash
# Python バージョン確認（3.10.11必須）
py -3.10 --version
# 結果例: Python 3.10.11

# 仮想環境作成（推奨・Python 3.10.11指定）
py -3.10 -m venv .venv

# 仮想環境を有効化
.\.venv\Scripts\Activate.ps1
# コマンドライン先頭に (.venv) が表示されることを確認

# 仮想環境Python バージョン確認（3.10.11必須）
.\.venv\Scripts\python.exe --version
# 結果例: Python 3.10.11
```

#### 2.1.4. VS Code Pythonインタープリターの選択

1. `Ctrl+Shift+P`でコマンドパレットを開く
2. 「Python: Select Interpreter」と入力して選択する
3. 作成した仮想環境の`.venv\Scripts\python.exe` を選択する

## 3. インストール/セットアップ手順

### 3.1. pip自体の最新化
```bash
python -m pip install --upgrade pip
```

### 3.2. 全モデル対応の完全版インストール
```bash
pip install -r requirements.txt
```

環境をリセットしたい場合は、`.venv`フォルダを削除する

## 4. 初期設定

- 学習用データ（例: `train.csv`）を`AI/data`フォルダに配置する
- 予測対象のデータ（例: `test.csv`）を`AI/data`フォルダに配置する

## 5. 基本操作

### 5.1. 電力需要予測AIモデルの実行

#### 5.1.1. データ前処理・学習フェーズ

##### 5.1.1.1. データ前処理実行
```bash
# 電力需要・気温データの統合処理
python .\data\data.py
```

##### 5.1.1.2. 各種AIモデル学習実行
```bash
# Keras深層学習モデル（ニューラルネットワーク）
python .\train\Keras\Keras_train.py

# LightGBM勾配ブースティングモデル
python .\train\LightGBM\LightGBM_train.py

# PyCaret自動機械学習モデル
python .\train\Pycaret\Pycaret_train.py

# RandomForestアンサンブルモデル
python .\train\RandomForest\RandomForest_train.py
```

#### 5.1.2. 翌日予測フェーズ

##### 5.1.2.1. 最新データ取得
```bash
# TEPCO電力需要実績データ取得
python .\tomorrow\data.py

# Open-Meteo API気温データ取得
python .\tomorrow\temp.py
```

##### 5.1.2.2. 各種AIモデル翌日予測実行
```bash
# Keras翌日予測実行
python .\tomorrow\Keras\Keras_tomorrow.py

# LightGBM翌日予測実行
python .\tomorrow\LightGBM\LightGBM_tomorrow.py

# PyCaret翌日予測実行
python .\tomorrow\Pycaret\Pycaret_tomorrow.py

# RandomForest翌日予測実行
python .\tomorrow\RandomForest\RandomForest_tomorrow.py
```

## 6. 付録

### 6.1. ショートカット
- `Ctrl + K, Ctrl + O`: フォルダーを開く
- `Ctrl + Shift + P`: コマンドパレット
- `Ctrl+Shift+P`: Python インタープリター選択
